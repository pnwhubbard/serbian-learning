<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Serbian Flashcards</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: #1a1a2e;
      color: #eee;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    header {
      width: 100%;
      background: #16213e;
      padding: 18px 32px;
      display: flex;
      align-items: center;
      gap: 24px;
      box-shadow: 0 2px 8px #0006;
    }
    header h1 { font-size: 1.4rem; color: #e94560; flex: 1; }

    nav button {
      background: none;
      border: 2px solid #e94560;
      color: #e94560;
      padding: 8px 18px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.95rem;
      transition: background 0.2s, color 0.2s;
    }
    nav button:hover, nav button.active { background: #e94560; color: #fff; }

    main { width: 100%; max-width: 760px; padding: 40px 20px; flex: 1; }

    /* ── SHARED ─────────────────────────────────────────── */
    .btn {
      padding: 10px 26px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: opacity 0.2s;
    }
    .btn:disabled { opacity: 0.3; cursor: default; }
    .btn-primary   { background: #e94560; color: #fff; }
    .btn-secondary { background: #0f3460; color: #fff; }
    .btn-sm {
      padding: 5px 14px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      font-size: 0.82rem;
      font-weight: 600;
    }

    .empty-msg {
      color: #aaa;
      text-align: center;
      margin-top: 60px;
      font-size: 1.1rem;
      line-height: 1.8;
    }

    label { font-size: 0.82rem; color: #aaa; }

    input[type="text"], select {
      background: #16213e;
      border: 1px solid #0f3460;
      color: #eee;
      padding: 10px 14px;
      border-radius: 8px;
      font-size: 1rem;
      width: 100%;
    }
    input[type="text"]:focus, select:focus { outline: none; border-color: #e94560; }
    select option { background: #16213e; }

    /* ── STUDY ──────────────────────────────────────────── */
    #study-view { display: flex; flex-direction: column; align-items: center; gap: 22px; }

    .direction-toggle {
      display: flex; gap: 8px; align-items: center; font-size: 0.85rem; color: #aaa;
    }
    .direction-toggle button {
      background: #0f3460; border: none; color: #eee;
      padding: 6px 14px; border-radius: 6px; cursor: pointer; font-size: 0.8rem;
    }
    .direction-toggle button.active { background: #e94560; }

    /* Group filter bar */
    .group-filter-bar {
      width: 100%;
      background: #16213e;
      border: 1px solid #0f3460;
      border-radius: 12px;
      padding: 14px 18px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .group-filter-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 0.82rem;
      color: #aaa;
    }
    .group-filter-actions { display: flex; gap: 8px; }
    .group-filter-actions button {
      background: none;
      border: 1px solid #0f3460;
      color: #aaa;
      padding: 3px 10px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.75rem;
      transition: border-color 0.2s, color 0.2s;
    }
    .group-filter-actions button:hover { border-color: #e94560; color: #e94560; }

    .group-toggle-row { display: flex; flex-wrap: wrap; gap: 8px; }

    .group-pill {
      padding: 5px 14px;
      border-radius: 20px;
      border: 2px solid var(--gc, #555);
      background: transparent;
      color: var(--gc, #aaa);
      cursor: pointer;
      font-size: 0.82rem;
      font-weight: 600;
      transition: background 0.15s, color 0.15s;
      white-space: nowrap;
    }
    .group-pill.active { background: var(--gc, #555); color: #fff; }
    .group-pill:hover  { opacity: 0.85; }

    .progress { color: #aaa; font-size: 0.9rem; }

    .scene { width: 100%; height: 260px; perspective: 1000px; cursor: pointer; }
    .card-inner {
      position: relative; width: 100%; height: 100%;
      transition: transform 0.5s; transform-style: preserve-3d;
    }
    .scene.flipped .card-inner { transform: rotateY(180deg); }
    .card-face {
      position: absolute; width: 100%; height: 100%;
      backface-visibility: hidden; border-radius: 16px;
      display: flex; flex-direction: column; align-items: center;
      justify-content: center; gap: 12px; padding: 24px; text-align: center;
    }
    .card-front { background: #16213e; border: 2px solid #0f3460; }
    .card-back  { background: #0f3460; border: 2px solid #e94560; transform: rotateY(180deg); }
    .card-label    { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 2px; color: #aaa; }
    .card-word     { font-size: 2.4rem; font-weight: 700; color: #fff; }
    .card-cyrillic { font-size: 1.15rem; color: #74b9ff; font-weight: 400; margin-top: -8px; letter-spacing: 0.3px; min-height: 1.4em; }
    .card-hint     { font-size: 0.85rem; color: #aaa; }
    .noun-card-cyrillic { font-size: 1.4rem; color: #74b9ff; font-weight: 400; margin-top: -6px; }
    .card-note  {
      font-size: 0.72rem; color: #74b9ff; text-align: left;
      line-height: 1.6; white-space: pre-line;
      background: #0a1f3a; border-radius: 8px;
      padding: 8px 14px; width: 88%; margin-top: -4px;
    }

    .study-controls { display: flex; gap: 16px; }

    /* ── GRAMMAR ────────────────────────────────────────── */
    #grammar-view { display: flex; flex-direction: column; gap: 24px; }

    .case-selector {
      background: #16213e; border: 1px solid #0f3460; border-radius: 12px;
      padding: 16px 20px; display: flex; align-items: center; gap: 16px; flex-wrap: wrap;
    }
    .case-sel-label { font-size: 0.85rem; color: #aaa; white-space: nowrap; }
    .case-toggles { display: flex; gap: 8px; flex-wrap: wrap; }

    .case-toggle {
      width: 36px; height: 36px; border-radius: 8px;
      border: 2px solid #0f3460; background: #0f3460;
      color: #aaa; font-weight: 700; font-size: 0.9rem;
      cursor: pointer; transition: all 0.15s; position: relative;
    }
    .case-toggle:hover { border-color: #e94560; color: #e94560; }
    .case-toggle.active { background: #e94560; border-color: #e94560; color: #fff; }
    .case-toggle[data-tip]:hover::after {
      content: attr(data-tip);
      position: absolute; top: calc(100% + 6px); left: 50%;
      transform: translateX(-50%);
      background: #0f3460; color: #eee; font-size: 0.7rem; font-weight: 400;
      white-space: nowrap; padding: 4px 8px; border-radius: 6px;
      border: 1px solid #e94560; z-index: 10; pointer-events: none;
    }

    .g-header-row {
      display: flex; justify-content: space-between; align-items: center;
      font-size: 0.9rem; color: #aaa;
    }
    .g-score-badge { background: #0f3460; border-radius: 20px; padding: 4px 14px; font-size: 0.85rem; }
    .g-score-badge span { color: #27ae60; font-weight: 700; }

    .noun-card {
      background: #16213e; border: 2px solid #0f3460; border-radius: 16px;
      padding: 28px 32px; display: flex; flex-direction: column;
      align-items: center; gap: 10px; text-align: center;
    }
    .noun-card-given { font-size: 0.72rem; text-transform: uppercase; letter-spacing: 2px; color: #555; }
    .noun-card-word  { font-size: 2.6rem; font-weight: 700; color: #fff; }
    .noun-card-sub   { display: flex; gap: 12px; align-items: center; }
    .noun-card-en    { font-size: 1rem; color: #aaa; }

    .gender-badge { font-size: 0.72rem; font-weight: 700; padding: 3px 10px; border-radius: 20px; text-transform: uppercase; letter-spacing: 1px; }
    .gender-m { background: #1a3a6e; color: #74b9ff; }
    .gender-f { background: #5c1a3a; color: #fd79a8; }
    .gender-n { background: #1a4a2e; color: #55efc4; }

    .case-inputs { display: flex; flex-direction: column; }
    .case-row {
      display: flex; flex-direction: column; gap: 7px;
      padding: 12px 0; border-bottom: 1px solid #0f3460;
    }
    .case-row:last-child { border-bottom: none; }
    .case-row.hidden { display: none; }

    .case-row-main {
      display: grid;
      grid-template-columns: 28px 130px 1fr 28px minmax(50px, auto);
      gap: 10px; align-items: center;
    }
    .case-abbr { font-size: 0.78rem; font-weight: 700; color: #e94560; text-align: center; background: #0f3460; border-radius: 4px; padding: 2px 4px; }
    .case-name-col { display: flex; flex-direction: column; gap: 2px; }
    .case-name-main { font-size: 0.9rem; font-weight: 600; }
    .case-name-hint { font-size: 0.7rem; color: #666; font-style: italic; }
    .case-inp {
      background: #16213e; border: 2px solid #0f3460; color: #eee;
      padding: 9px 14px; border-radius: 8px; font-size: 1rem; width: 100%;
      transition: border-color 0.2s;
    }
    .case-inp:focus { outline: none; border-color: #e94560; }
    .case-inp.g-correct   { border-color: #27ae60 !important; background: #0d2b1a; }
    .case-inp.g-incorrect { border-color: #e94560 !important; background: #2b0d1a; }

    .case-info-btn {
      width: 28px; height: 28px; border-radius: 50%;
      border: 1.5px solid #e94560; background: none; color: #e94560;
      cursor: pointer; font-size: 0.8rem; font-weight: 700;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0; transition: background 0.15s, color 0.15s;
    }
    .case-info-btn:hover { background: #e94560; color: #fff; }

    .case-feedback { display: flex; flex-direction: column; align-items: flex-start; gap: 2px; }
    .fb-correct   { color: #27ae60; font-size: 1.1rem; }
    .fb-incorrect { color: #e94560; font-size: 1.1rem; }
    .fb-answer    { font-size: 0.8rem; color: #e94560; font-style: italic; }

    /* Example sentence below each input */
    .case-example {
      /* indent aligns with the input column: 28px abbr + 130px name + 2×10px gap */
      padding-left: calc(28px + 130px + 20px);
      display: flex; align-items: baseline; gap: 6px;
      font-size: 0.82rem; flex-wrap: wrap;
    }
    .case-example .ex-arrow { color: #3a5a4a; }
    .case-example .ex-sr    { color: #7eac92; font-weight: 500; }
    .case-example .ex-sep   { color: #3a5a4a; }
    .case-example .ex-en    { color: #4a6a56; font-style: italic; }

    .grammar-controls { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; }

    /* ── PREFIX INFO BUTTON & MODAL ──────────────────── */
    .ctx-prefix-group { display: inline-flex; align-items: center; }
    .ctx-info-btn {
      background: none; border: none; color: #74b9ff;
      font-size: 0.82rem; cursor: pointer; padding: 1px 4px;
      opacity: 0.55; line-height: 1; transition: opacity 0.15s;
    }
    .ctx-info-btn:hover { opacity: 1; }
    #prefix-modal-overlay {
      display: none; position: fixed; inset: 0;
      background: rgba(0,0,0,0.72); z-index: 200;
      align-items: center; justify-content: center; padding: 20px;
    }
    #prefix-modal-overlay.open { display: flex; }
    #prefix-modal {
      background: #16213e; border: 1px solid #e9456044;
      border-radius: 16px; width: 100%; max-width: 480px;
      max-height: 85vh; overflow-y: auto;
      box-shadow: 0 24px 60px rgba(0,0,0,0.7);
      animation: modal-in 0.18s ease;
    }
    .prefix-example-pair {
      display: flex; flex-wrap: wrap; gap: 6px; align-items: baseline;
      font-size: 0.88rem; padding: 7px 0; border-bottom: 1px solid #0f3460;
    }
    .prefix-example-pair:last-child { border-bottom: none; }
    .pex-imp   { color: #74b9ff; font-style: italic; }
    .pex-arrow { color: #444; }
    .pex-pfv   { color: #55efc4; font-style: italic; }
    .pex-en    { color: #777; font-size: 0.8rem; }

    /* ── CASE INFO MODAL ──────────────────────────────── */
    #case-modal-overlay {
      display: none; position: fixed; inset: 0;
      background: rgba(0,0,0,0.72); z-index: 200;
      align-items: center; justify-content: center; padding: 20px;
    }
    #case-modal-overlay.open { display: flex; }
    #case-modal {
      background: #16213e; border: 1px solid #e9456044;
      border-radius: 16px; width: 100%; max-width: 500px;
      max-height: 85vh; overflow-y: auto;
      box-shadow: 0 24px 60px rgba(0,0,0,0.7);
      animation: modal-in 0.18s ease;
    }
    @keyframes modal-in {
      from { transform: scale(0.93); opacity: 0; }
      to   { transform: scale(1);    opacity: 1; }
    }
    .modal-header {
      display: flex; align-items: flex-start; justify-content: space-between;
      padding: 20px 24px 16px; border-bottom: 1px solid #0f3460; gap: 12px;
    }
    .modal-header-left { display: flex; flex-direction: column; gap: 4px; }
    .modal-case-abbr {
      display: inline-block; background: #e94560; color: #fff;
      font-size: 0.72rem; font-weight: 700; padding: 2px 9px;
      border-radius: 4px; letter-spacing: 1px; margin-bottom: 2px; width: fit-content;
    }
    .modal-case-name { font-size: 1.4rem; font-weight: 700; color: #fff; }
    .modal-case-hint { font-size: 0.85rem; color: #888; font-style: italic; }
    .modal-close {
      background: none; border: none; color: #555;
      font-size: 1.7rem; cursor: pointer; line-height: 1; padding: 0 4px; flex-shrink: 0;
    }
    .modal-close:hover { color: #fff; }
    .modal-body { padding: 20px 24px 28px; display: flex; flex-direction: column; gap: 22px; }
    .modal-section { display: flex; flex-direction: column; gap: 10px; }
    .modal-section-label {
      font-size: 0.68rem; font-weight: 700; letter-spacing: 2.5px;
      color: #e94560; text-transform: uppercase;
    }
    .modal-section > p { font-size: 0.92rem; color: #ccc; line-height: 1.65; }
    .prep-grid { display: flex; flex-wrap: wrap; gap: 8px; }
    .prep-tag {
      background: #0f3460; border: 1px solid #1a4a7a; border-radius: 8px;
      padding: 7px 12px; font-size: 0.82rem; display: flex; flex-direction: column; gap: 2px;
    }
    .prep-tag .pt-prep    { color: #74b9ff; font-weight: 600; font-style: italic; }
    .prep-tag .pt-meaning { color: #aaa; font-size: 0.72rem; }
    .prep-note {
      font-size: 0.82rem; color: #7f8c8d; font-style: italic;
      border-left: 2px solid #1a4a7a; padding-left: 10px; line-height: 1.5;
    }
    .modal-example-box {
      background: #0f3460; border-radius: 10px; padding: 14px 18px;
      display: flex; flex-direction: column; gap: 6px;
    }
    .modal-ex-sr { font-size: 1.15rem; color: #eee; font-weight: 600; }
    .modal-ex-en { font-size: 0.88rem; color: #aaa; }

    /* ── MANAGE ─────────────────────────────────────────── */
    #manage-view { display: flex; flex-direction: column; gap: 24px; }

    .manage-tabs { display: flex; gap: 8px; border-bottom: 2px solid #0f3460; }
    .manage-tab-btn {
      background: none; border: none; color: #aaa;
      padding: 10px 20px; cursor: pointer; font-size: 0.95rem;
      border-bottom: 3px solid transparent; margin-bottom: -2px; transition: color 0.2s;
    }
    .manage-tab-btn:hover { color: #eee; }
    .manage-tab-btn.active { color: #e94560; border-bottom-color: #e94560; }

    .manage-section { display: flex; flex-direction: column; gap: 28px; }

    .section-title {
      font-size: 1.1rem; font-weight: 600; color: #e94560;
      margin-bottom: 12px; border-bottom: 1px solid #0f3460; padding-bottom: 8px;
      display: flex; align-items: center; gap: 12px;
    }
    .section-count { font-size: 0.85rem; font-weight: 400; color: #aaa; }

    .form-row { display: flex; gap: 12px; flex-wrap: wrap; }
    .form-group { display: flex; flex-direction: column; gap: 6px; flex: 1; min-width: 140px; }

    /* Groups list in manage */
    .group-list-manage { display: flex; flex-direction: column; gap: 8px; }
    .group-manage-row {
      background: #16213e; border: 1px solid #0f3460; border-radius: 10px;
      padding: 12px 16px; display: flex; align-items: center; gap: 14px;
    }
    .group-color-dot { width: 12px; height: 12px; border-radius: 50%; flex-shrink: 0; }
    .group-manage-name { font-weight: 600; font-size: 1rem; flex: 1; }
    .group-manage-count { font-size: 0.82rem; color: #aaa; }

    /* Cards list */
    .card-list { display: flex; flex-direction: column; gap: 8px; }
    .card-row {
      background: #16213e; border: 1px solid #0f3460; border-radius: 10px;
      padding: 12px 16px; display: flex; align-items: center; gap: 12px;
      flex-wrap: wrap;
    }
    .card-row .c-serbian { font-weight: 700; font-size: 1.05rem; flex: 1; min-width: 80px; }
    .card-row .c-english { color: #aaa; flex: 1; min-width: 80px; font-size: 0.95rem; }
    .inline-group-select {
      background: #0f3460; border: 1px solid #1a4a7a;
      color: #eee; padding: 4px 8px; border-radius: 6px;
      font-size: 0.8rem; cursor: pointer; width: auto;
    }
    .inline-group-select:focus { outline: none; border-color: #e94560; }

    .del-btn {
      background: none; border: 1px solid #c0392b; color: #c0392b;
      padding: 5px 12px; border-radius: 6px; cursor: pointer; font-size: 0.8rem; white-space: nowrap;
    }
    .del-btn:hover { background: #c0392b; color: #fff; }

    .list-filter-row {
      display: flex; align-items: center; gap: 10px; margin-bottom: 4px;
    }
    .list-filter-row label { font-size: 0.85rem; color: #aaa; white-space: nowrap; }
    .list-filter-row select { width: auto; padding: 7px 12px; font-size: 0.85rem; }

    /* Grammar noun manage */
    .noun-row { background: #16213e; border: 1px solid #0f3460; border-radius: 10px; padding: 14px 18px; }
    .noun-row-top { display: flex; align-items: center; gap: 14px; }
    .noun-row-top .nom { font-weight: 700; font-size: 1.1rem; flex: 1; }
    .noun-row-top .eng { color: #aaa; flex: 1; font-size: 0.95rem; }
    .noun-row-forms {
      display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px;
      margin-top: 10px; padding-top: 10px; border-top: 1px solid #0f3460;
    }
    .noun-form-cell { display: flex; flex-direction: column; gap: 2px; }
    .noun-form-case { font-size: 0.65rem; color: #e94560; font-weight: 700; text-transform: uppercase; }
    .noun-form-val  { font-size: 0.85rem; }
    .declension-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 12px; }

    /* ── VERBS / ADJECTIVES ─────────────────────────── */
    #verbs-view, #adj-view { display: flex; flex-direction: column; gap: 24px; }

    /* ── ADJECTIVE MULTI-GENDER GRID ─────────────────── */
    .adj-row-main {
      display: grid;
      grid-template-columns: 140px repeat(3, 1fr);
      gap: 10px;
      align-items: start;
    }
    .adj-case-info {
      display: flex; flex-direction: column; gap: 3px; padding-top: 6px;
    }
    .adj-case-abbr-btn {
      display: inline-block; width: fit-content;
      background: #0f3460; color: #e94560;
      border: 1.5px solid #e94560; border-radius: 5px;
      padding: 2px 8px; font-size: 0.78rem; font-weight: 700;
      cursor: pointer; transition: background 0.15s, color 0.15s;
    }
    .adj-case-abbr-btn:hover { background: #e94560; color: #fff; }
    .adj-case-name { font-size: 0.88rem; font-weight: 600; color: #ddd; margin-top: 2px; }
    .adj-case-hint-txt { font-size: 0.7rem; color: #666; font-style: italic; }
    .adj-gender-col { display: flex; flex-direction: column; gap: 4px; }
    .adj-col-hdr {
      font-size: 0.72rem; font-weight: 700;
      text-transform: uppercase; letter-spacing: 0.05em;
    }
    .adj-col-hdr.hdr-m { color: #74b9ff; }
    .adj-col-hdr.hdr-f { color: #fd79a8; }
    .adj-col-hdr.hdr-n { color: #55efc4; }

    /* ── MULTIPLE CHOICE ─────────────────────────────── */
    .mc-case-header {
      display: flex; align-items: center; gap: 10px; padding: 2px 0 4px;
    }
    .mc-options {
      display: flex; flex-wrap: wrap; gap: 8px; padding: 2px 0 4px;
    }
    .mc-btn {
      padding: 9px 16px; border-radius: 8px;
      border: 2px solid #0f3460; background: #16213e; color: #eee;
      cursor: pointer; font-size: 0.9rem; flex: 1; min-width: 70px;
      text-align: center; transition: border-color 0.15s, background 0.15s;
    }
    .mc-btn:hover:not(:disabled) { border-color: #74b9ff; }
    .mc-btn:disabled { cursor: default; }
    .mc-btn.mc-correct { border-color: #27ae60 !important; background: #0d2b1a !important; color: #55efc4 !important; }
    .mc-btn.mc-wrong   { border-color: #e94560 !important; background: #2b0d1a !important; color: #e94560 !important; }
    .mc-btn.mc-reveal  { border-color: #27ae60 !important; background: #0d2b1a !important; color: #55efc4 !important; }
    .adj-example { font-size: 0.75rem; margin-top: 4px; line-height: 1.5; }
    .ex-sr-adj { color: #7eac92; }
    .ex-en-adj { color: #4a6a56; font-style: italic; }

    /* ── MISSED CARDS ─────────────────────────────────── */
    #mark-missed-btn.active { background: #5c1a1a; color: #ff7070; }
    #dir-clear-missed { display: none; }

    /* ── ASPECT BADGE ────────────────────────────────── */
    .aspect-badge {
      font-size: 0.7rem; font-weight: 700; text-transform: uppercase;
      letter-spacing: 0.05em; padding: 2px 9px; border-radius: 10px; align-self: center;
    }
    .aspect-imp { background: #1a3a5c; color: #74b9ff; border: 1px solid #2d5a8e; }
    .aspect-pfv { background: #3a1a2e; color: #fd79a8; border: 1px solid #7a2e50; }
    .aspect-bi  { background: #2a2a1a; color: #fdcb6e; border: 1px solid #6a5a1a; }

    /* ── CONTEXT CHOOSER VIEW ────────────────────────── */
    #aspect-view { display: flex; flex-direction: column; gap: 24px; }

    .ctx-card { gap: 14px; }
    .ctx-sentence {
      font-size: 1.25rem; font-weight: 600; color: #f0f0f0;
      text-align: center; line-height: 1.5;
    }
    .ctx-sr-sentence { color: #74b9ff; font-size: 1.1rem; font-style: italic; }
    .ctx-blank { color: #e94560; font-weight: 800; border-bottom: 2px solid #e94560; padding: 0 6px; }
    .ctx-blank-filled-correct { color: #55efc4; font-weight: 800; border-bottom: 2px solid #27ae60; padding: 0 6px; }
    .ctx-blank-filled-wrong   { color: #ff7070; font-weight: 800; border-bottom: 2px solid #e94560; padding: 0 6px; }

    .ctx-choices {
      display: grid; grid-template-columns: 1fr 1fr; gap: 16px;
    }
    .ctx-choice {
      display: flex; flex-direction: column; align-items: center; gap: 8px;
      padding: 18px 12px; border-radius: 14px; cursor: pointer;
      border: 2px solid transparent; transition: transform 0.1s, border-color 0.15s;
      background: #16213e;
    }
    .ctx-choice:hover:not(:disabled) { transform: translateY(-2px); }
    .ctx-choice:disabled { cursor: default; opacity: 0.8; }
    .ctx-choice-imp { border-color: #2d5a8e; }
    .ctx-choice-pfv { border-color: #7a2e50; }
    .ctx-choice-verb { font-size: 1.3rem; font-weight: 800; color: #f0f0f0; }
    .ctx-choice-label { font-size: 0.72rem; text-transform: uppercase; letter-spacing: 0.08em; color: #aaa; }

    .ctx-choice.ctx-correct { background: #0d2b1a; border-color: #27ae60; }
    .ctx-choice.ctx-correct .ctx-choice-verb { color: #55efc4; }
    .ctx-choice.ctx-wrong   { background: #2b0d1a; border-color: #e94560; }
    .ctx-choice.ctx-wrong   .ctx-choice-verb { color: #ff7070; }
    .ctx-choice.ctx-show-correct { background: #0d2b1a; border-color: #27ae60; }
    .ctx-choice.ctx-show-correct .ctx-choice-verb { color: #55efc4; }

    .ctx-feedback {
      background: #16213e; border: 1px solid #0f3460; border-radius: 12px;
      padding: 16px 20px; display: flex; flex-direction: column; gap: 8px;
    }
    .ctx-feedback.ctx-feedback-correct { border-color: #27ae60; }
    .ctx-feedback.ctx-feedback-wrong   { border-color: #e94560; }
    .ctx-feedback-rule {
      font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.08em;
      font-weight: 700; color: #74b9ff;
    }
    .ctx-feedback-note { font-size: 0.95rem; color: #ccc; line-height: 1.5; }

    /* ── SLAGALICA ───────────────────────────────────── */
    #slagalica-view { display: flex; flex-direction: column; gap: 24px; }
    .slag-screen { display: flex; flex-direction: column; gap: 20px; }

    .slag-stats-bar {
      background: #16213e; border: 1px solid #0f3460; border-radius: 12px;
      padding: 16px 20px; display: flex; align-items: center;
      justify-content: space-between; flex-wrap: wrap; gap: 14px;
    }
    .slag-best { display: flex; flex-direction: column; gap: 2px; }
    .slag-best-label { font-size: 0.72rem; text-transform: uppercase; letter-spacing: 0.1em; color: #aaa; }
    .slag-best-val   { font-size: 2.4rem; font-weight: 800; color: #e94560; line-height: 1; }

    .slag-streak-wrap { display: flex; flex-direction: column; gap: 6px; align-items: flex-end; }
    .slag-streak-label { font-size: 0.72rem; text-transform: uppercase; letter-spacing: 0.1em; color: #aaa; }
    .slag-dots { display: flex; gap: 7px; align-items: center; }
    .slag-dot {
      width: 14px; height: 14px; border-radius: 50%;
      background: #2a2a4a; transition: background 0.2s;
    }
    .slag-dot.win  { background: #27ae60; }
    .slag-dot.loss { background: #e94560; }

    .slag-dir-row {
      background: #16213e; border: 1px solid #0f3460; border-radius: 12px;
      padding: 14px 18px; display: flex; align-items: center; gap: 14px; flex-wrap: wrap;
    }

    .slag-chain-row {
      display: flex; align-items: stretch; justify-content: space-between;
      gap: 12px; flex-wrap: wrap;
    }
    .slag-chain-box {
      background: #16213e; border: 1px solid #0f3460; border-radius: 12px;
      padding: 10px 24px; text-align: center; flex: 1;
    }
    .slag-chain-label { font-size: 0.72rem; color: #aaa; text-transform: uppercase; letter-spacing: 0.1em; display: block; }
    .slag-chain-num   { font-size: 2.4rem; font-weight: 800; color: #e94560; line-height: 1.15; display: block; }
    .slag-dir-badge   {
      font-size: 0.78rem; color: #74b9ff; background: #1a3a5c;
      border: 1px solid #2d5a8e; border-radius: 8px; padding: 5px 14px;
      align-self: center;
    }

    .slag-q-card {
      background: #16213e; border: 2px solid #0f3460; border-radius: 16px;
      padding: 32px 28px; text-align: center; display: flex;
      flex-direction: column; align-items: center; gap: 10px;
      animation: slag-fade-in 0.22s ease;
    }
    @keyframes slag-fade-in {
      from { opacity: 0; transform: translateY(-12px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .slag-q-label    { font-size: 0.72rem; text-transform: uppercase; letter-spacing: 2px; color: #555; }
    .slag-q-word     { font-size: 2.4rem; font-weight: 700; color: #fff; }
    .slag-q-cyrillic { font-size: 1.1rem; color: #74b9ff; margin-top: -6px; min-height: 1.4em; }
    .slag-q-cat      { font-size: 0.78rem; color: #555; font-style: italic; }

    .slag-options {
      display: grid; grid-template-columns: 1fr 1fr; gap: 12px;
    }
    .slag-option {
      background: #0f3460; border: 2px solid #1a4a7a;
      color: #eee; border-radius: 12px; padding: 18px 14px;
      font-size: 1rem; font-weight: 600; cursor: pointer;
      transition: all 0.15s; text-align: center; line-height: 1.3;
    }
    .slag-option:hover:not(:disabled) { border-color: #e94560; color: #fff; background: #1a3a6a; }
    .slag-option.correct { background: #0d2b1a !important; border-color: #27ae60 !important; color: #27ae60 !important; }
    .slag-option.wrong   { background: #2b0d1a !important; border-color: #e94560 !important; color: #e94560 !important; }
    .slag-option:disabled { cursor: default; opacity: 0.7; }
    .slag-option.correct:disabled, .slag-option.wrong:disabled { opacity: 1; }

    .slag-over-card {
      background: #16213e; border: 2px solid #e9456044; border-radius: 16px;
      padding: 40px 32px; display: flex; flex-direction: column;
      align-items: center; gap: 18px; text-align: center;
      animation: slag-fade-in 0.3s ease;
    }
    .slag-over-title  { font-size: 1.4rem; font-weight: 700; color: #e94560; }
    .slag-over-score  { font-size: 4.5rem; font-weight: 800; color: #fff; line-height: 1; }
    .slag-over-sub    { font-size: 0.9rem; color: #aaa; margin-top: -12px; }
    .slag-over-record { font-size: 1rem; color: #fdcb6e; font-weight: 700; min-height: 1.4em; }
    .slag-wrong-box {
      background: #1a1a2e; border: 1px solid #3a1a2e; border-radius: 12px;
      padding: 16px 20px; width: 100%; text-align: left;
    }
    .slag-wrong-label { font-size: 0.72rem; color: #e94560; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 10px; }
    .slag-wrong-q     { font-size: 1rem; color: #aaa; margin-bottom: 6px; }
    .slag-wrong-q strong  { color: #fff; }
    .slag-wrong-ans       { font-size: 0.95rem; color: #aaa; }
    .slag-wrong-ans strong { color: #55efc4; }
    .slag-over-btns { display: flex; gap: 12px; flex-wrap: wrap; justify-content: center; }

    @media (max-width: 600px) {
      .slag-options { grid-template-columns: 1fr; }
      .slag-q-word  { font-size: 1.8rem; }
      .slag-over-score { font-size: 3.5rem; }
    }

    .tense-selector {
      background: #16213e; border: 1px solid #0f3460; border-radius: 12px;
      padding: 16px 20px; display: flex; align-items: center; gap: 16px; flex-wrap: wrap;
    }
    .tense-sel-label { font-size: 0.85rem; color: #aaa; white-space: nowrap; }
    .tense-btns { display: flex; gap: 8px; flex-wrap: wrap; }

    .tense-btn {
      padding: 7px 20px; border-radius: 8px; border: 2px solid #0f3460;
      background: #0f3460; color: #aaa; cursor: pointer; font-size: 0.88rem; font-weight: 600;
      transition: all 0.15s;
    }
    .tense-btn:hover  { border-color: #e94560; color: #e94560; }
    .tense-btn.active { background: #e94560; border-color: #e94560; color: #fff; }

    .subj-row-main {
      display: grid;
      grid-template-columns: 110px 1fr minmax(60px, auto);
      gap: 10px; align-items: center;
    }
    .subj-label-col  { display: flex; flex-direction: column; gap: 1px; }
    .subj-label-main { font-size: 0.9rem; font-weight: 700; color: #e94560; }
    .subj-label-hint { font-size: 0.72rem; color: #666; font-style: italic; }

    /* ── SENTENCE FILL-IN DRILL ─────────────────────── */
    #drill-view { display: flex; flex-direction: column; gap: 24px; }

    .drill-tense-bar {
      display: flex; align-items: center; gap: 12px; flex-wrap: wrap;
      background: #16213e; border: 1px solid #0f3460; border-radius: 10px;
      padding: 12px 16px;
    }
    .drill-tense-label { font-size: 0.82rem; color: #aaa; white-space: nowrap; }
    .drill-tense-toggles { display: flex; gap: 8px; flex-wrap: wrap; }
    .drill-tense-btn {
      padding: 6px 16px; border-radius: 20px;
      border: 2px solid #0f3460; background: transparent;
      color: #aaa; cursor: pointer; font-size: 0.82rem; font-weight: 600;
      transition: all 0.15s;
    }
    .drill-tense-btn.active { background: #e94560; border-color: #e94560; color: #fff; }
    .drill-tense-btn:hover:not(.active) { border-color: #e94560; color: #e94560; }

    .drill-sentence {
      font-size: 1.4rem; font-weight: 600; color: #fff;
      text-align: center; line-height: 1.6;
    }
    .drill-blank {
      color: #e94560; font-weight: 800;
      border-bottom: 2px solid #e94560; padding: 0 8px; letter-spacing: 0.04em;
    }
    .drill-blank-fill { font-weight: 800; padding: 0 6px; border-bottom: 2px solid; }
    .drill-blank-fill.correct { color: #55efc4; border-color: #27ae60; }
    .drill-blank-fill.wrong   { color: #ff7070; border-color: #e94560; }

    .drill-options {
      display: grid; grid-template-columns: 1fr 1fr; gap: 12px;
    }
    .drill-option {
      background: #0f3460; border: 2px solid #1a4a7a; color: #eee;
      font-size: 1.25rem; font-weight: 700; padding: 18px 12px;
      border-radius: 12px; cursor: pointer; transition: all 0.15s;
      text-align: center; font-family: inherit;
    }
    .drill-option:hover:not(:disabled) { border-color: #e94560; color: #fff; }
    .drill-option.correct { background: #0d2b1a !important; border-color: #27ae60 !important; color: #55efc4 !important; }
    .drill-option.wrong   { background: #2b0d1a !important; border-color: #e94560 !important; }
    .drill-option:disabled { opacity: 0.7; cursor: default; }
    .drill-option.correct:disabled, .drill-option.wrong:disabled { opacity: 1; }

    .drill-feedback {
      background: #16213e; border: 1px solid #0f3460; border-radius: 12px;
      padding: 14px 18px; font-size: 0.88rem; line-height: 1.7; color: #ccc;
    }
    .drill-feedback.correct { border-color: #27ae60; }
    .drill-feedback.wrong   { border-color: #e94560; }
    .drill-feedback .df-hint { color: #74b9ff; display: block; margin-top: 4px; }

    /* ── MOBILE ──────────────────────────────────────── */
    @media (max-width: 600px) {

      /* 1. Header / Nav */
      header {
        padding: 12px 16px;
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
      nav {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }
      nav button {
        min-height: 44px;
        padding: 10px 14px;
      }

      /* 2. Study Tab */
      .direction-toggle {
        flex-wrap: wrap;
        gap: 6px;
      }
      .direction-toggle button {
        min-height: 44px;
        padding: 10px 16px;
      }
      .study-controls {
        flex-wrap: wrap;
        gap: 10px;
      }
      .study-controls .btn {
        min-height: 44px;
        flex: 1;
      }
      .group-pill {
        min-height: 36px;
        padding: 8px 14px;
      }

      /* 6. Font sizes */
      .card-word       { font-size: 1.8rem; }
      .card-note       { font-size: 0.8rem; }
      .case-name-hint  { font-size: 0.8rem; }
      .modal-section-label { font-size: 0.8rem; }

      /* 3. Grammar Tab — case-row grid → mobile 2-row layout */
      .case-row-main {
        grid-template-columns: auto 1fr 44px auto;
        grid-template-rows: auto auto;
        grid-template-areas:
          "abbr name name name"
          "inp  inp  btn  fb";
        gap: 8px;
      }
      .case-abbr     { grid-area: abbr; align-self: center; }
      .case-name-col { grid-area: name; align-self: center; }
      .case-inp      { grid-area: inp; }
      .case-info-btn {
        grid-area: btn;
        width: 44px; height: 44px;
        border-radius: 8px;
        align-self: center;
      }
      .case-feedback { grid-area: fb; align-self: center; }

      /* Remove deep indent on example sentence */
      .case-example { padding-left: 0; }

      /* 7. Tap targets — case toggles */
      .case-toggle { width: 44px; height: 44px; border-radius: 10px; }

      /* 4. Manage Tab */
      .form-row { flex-direction: column; }
      .form-group { min-width: unset; }
      .manage-tab-btn { padding: 8px 12px; font-size: 0.88rem; }
      .del-btn { min-height: 44px; padding: 10px 14px; }

      /* 5. Modal */
      .modal-header { padding: 16px 18px 12px; }
      .modal-body   { padding: 16px 18px 20px; }
      .modal-close  {
        width: 44px; height: 44px;
        display: flex; align-items: center; justify-content: center;
        font-size: 1.5rem;
      }

      /* 7. Tap targets — grammar controls */
      .grammar-controls .btn { min-height: 44px; }

      /* 8. Verbs tab */
      .tense-btn { min-height: 44px; }
      .subj-row-main { grid-template-columns: 90px 1fr auto; }

      /* 9. Adjective multi-gender grid → stacked on mobile */
      .adj-row-main { grid-template-columns: 1fr; gap: 8px; }
      .adj-case-info {
        flex-direction: row; align-items: center; gap: 8px; flex-wrap: wrap;
        padding-top: 0; padding-bottom: 8px;
        border-bottom: 1px solid #0f3460; margin-bottom: 2px;
      }
      .adj-gender-col {
        display: flex; flex-direction: column; gap: 4px;
      }
      .adj-col-hdr { font-size: 0.75rem; text-align: right; }

      /* 10. Mark missed button on mobile */
      #mark-missed-btn { min-height: 44px; }

      /* 11. Fill-in Drill on mobile */
      .drill-options { grid-template-columns: 1fr; }
      .drill-option  { font-size: 1.1rem; padding: 16px 12px; min-height: 44px; }
    }
  </style>
</head>
<body>

<header>
  <h1>Serbian Flashcards</h1>
  <nav>
    <button class="active" id="nav-study"   onclick="showView('study')">Flashcards</button>
    <button id="nav-grammar" onclick="showView('grammar')">Noun Agreement</button>
    <button id="nav-verbs"   onclick="showView('verbs')">Verbs</button>
    <button id="nav-adj"     onclick="showView('adj')">Adjectives</button>
    <button id="nav-aspect"     onclick="showView('aspect')">Context</button>
    <button id="nav-drill"      onclick="showView('drill')">Fill-in</button>
    <button id="nav-slagalica"  onclick="showView('slagalica')">Slagalica</button>
    <button id="nav-manage"     onclick="showView('manage')">Manage Cards</button>
  </nav>
</header>

<main>

  <!-- ═══════════════ STUDY VIEW ═══════════════ -->
  <div id="study-view">

    <div class="direction-toggle">
      <span>Direction:</span>
      <button id="dir-sr" class="active" onclick="setDirection('sr')">Serbian → English</button>
      <button id="dir-en" onclick="setDirection('en')">English → Serbian</button>
      <button id="dir-missed" onclick="toggleMissedMode()">⚑ Missed (<span id="missed-count">0</span>)</button>
      <button id="dir-clear-missed" onclick="clearMissedCards()" title="Clear missed list">✕ Clear Missed</button>
    </div>

    <!-- Group filter -->
    <div class="group-filter-bar" id="group-filter-bar">
      <div class="group-filter-header">
        <span>Groups</span>
        <div class="group-filter-actions">
          <button onclick="selectAllStudyGroups()">Select all</button>
          <button onclick="clearAllStudyGroups()">Clear all</button>
        </div>
      </div>
      <div class="group-toggle-row" id="study-group-toggles"></div>
    </div>

    <p class="progress" id="progress">Card 0 of 0</p>

    <div class="scene" id="scene" onclick="flipCard()">
      <div class="card-inner">
        <div class="card-face card-front">
          <span class="card-label"    id="front-label">Serbian</span>
          <span class="card-word"     id="front-word">—</span>
          <span class="card-cyrillic" id="front-cyrillic"></span>
          <span class="card-hint">click to reveal</span>
        </div>
        <div class="card-face card-back">
          <span class="card-label"    id="back-label">English</span>
          <span class="card-word"     id="back-word">—</span>
          <span class="card-cyrillic" id="back-cyrillic"></span>
          <div class="card-note"      id="back-note" style="display:none"></div>
          <span class="card-hint"     id="back-category"></span>
        </div>
      </div>
    </div>

    <div class="study-controls">
      <button class="btn btn-secondary" id="prev-btn"       onclick="prevCard()">← Prev</button>
      <button class="btn btn-primary"   id="shuffle-btn"    onclick="shuffle()">Shuffle</button>
      <button class="btn btn-secondary" id="next-btn"       onclick="nextCard()">Next →</button>
      <button class="btn btn-secondary" id="mark-missed-btn" onclick="toggleMissed()" title="Mark as missed">⚑ Mark</button>
    </div>

    <div id="empty-study" class="empty-msg" style="display:none">
      No cards match the selected groups.<br>
      Select more groups above or add cards in <strong>Manage Cards</strong>.
    </div>
  </div>

  <!-- ═══════════════ GRAMMAR VIEW ═══════════════ -->
  <div id="grammar-view" style="display:none">

    <div class="case-selector">
      <span class="case-sel-label">Practice cases:</span>
      <div class="case-toggles" id="case-toggles"></div>
    </div>

    <div class="g-header-row">
      <span id="g-progress">Noun 1 of 1</span>
      <span class="g-score-badge">Score: <span id="g-score-val">0 / 0</span></span>
    </div>

    <div class="noun-card" id="g-noun-card">
      <span class="noun-card-given">Given — Nominativ</span>
      <span class="noun-card-word" id="g-display-nom">—</span>
      <span class="noun-card-cyrillic" id="g-display-cyrillic"></span>
      <div class="noun-card-sub">
        <span class="noun-card-en" id="g-display-en">—</span>
        <span class="gender-badge"  id="g-display-gender">—</span>
      </div>
    </div>

    <div class="case-inputs" id="case-inputs"></div>

    <div class="grammar-controls">
      <button class="btn btn-secondary" id="g-prev-btn" onclick="gPrev()">← Prev</button>
      <button class="btn btn-primary"   onclick="checkGrammar()">Check Answers</button>
      <button class="btn btn-secondary" id="g-next-btn" onclick="gNext()">Next →</button>
      <button class="btn btn-secondary" onclick="shuffleGrammar()" title="Shuffle noun order">⇌ Shuffle</button>
    </div>

    <div id="empty-grammar" class="empty-msg" style="display:none">
      No grammar nouns yet.<br>Go to <strong>Manage Cards → Grammar Nouns</strong> to add some.
    </div>
  </div>

  <!-- ═══════════════ VERBS VIEW ═══════════════ -->
  <div id="verbs-view" style="display:none">

    <!-- Tense selector -->
    <div class="tense-selector">
      <span class="tense-sel-label">Tense:</span>
      <div class="tense-btns" id="tense-btns"></div>
    </div>

    <!-- Subject toggles -->
    <div class="case-selector">
      <span class="case-sel-label">Subjects:</span>
      <div class="case-toggles" id="subject-toggles"></div>
    </div>

    <!-- Progress + score -->
    <div class="g-header-row">
      <span id="v-progress">Verb 1 of 1</span>
      <span class="g-score-badge">Score: <span id="v-score-val">0 / 0</span></span>
    </div>

    <!-- Verb display card -->
    <div class="noun-card" id="v-verb-card">
      <span class="noun-card-given">Infinitive</span>
      <span class="aspect-badge" id="v-display-aspect"></span>
      <span class="noun-card-word"    id="v-display-inf">—</span>
      <span class="noun-card-cyrillic" id="v-display-cyrillic"></span>
      <span class="noun-card-en"      id="v-display-en">—</span>
    </div>

    <!-- Subject input rows (dynamically generated) -->
    <div class="case-inputs" id="verb-inputs"></div>

    <!-- Controls -->
    <div class="grammar-controls">
      <button class="btn btn-secondary" id="v-prev-btn" onclick="vPrev()">← Prev</button>
      <button class="btn btn-primary"   onclick="checkVerbs()">Check Answers</button>
      <button class="btn btn-secondary" id="v-next-btn" onclick="vNext()">Next →</button>
      <button class="btn btn-secondary" onclick="shuffleVerbs()">⇌ Shuffle</button>
    </div>

    <div id="empty-verbs" class="empty-msg" style="display:none">
      No verbs available. Add some in <strong>Manage Cards → Verbs</strong>.
    </div>
  </div>

  <!-- ═══════════════ ADJECTIVES VIEW ═══════════════ -->
  <div id="adj-view" style="display:none">

    <!-- Case toggles -->
    <div class="case-selector">
      <span class="case-sel-label">Practice cases:</span>
      <div class="case-toggles" id="adj-case-toggles"></div>
    </div>

    <!-- Progress + score -->
    <div class="g-header-row">
      <span id="adj-progress">Adj 1 of 1</span>
      <span class="g-score-badge">Score: <span id="adj-score-val">0 / 0</span></span>
    </div>

    <!-- Adjective display card -->
    <div class="noun-card" id="adj-card">
      <span class="noun-card-given">Adjective — base form (nom. sg. masc.)</span>
      <span class="noun-card-word"     id="adj-display-base">—</span>
      <span class="noun-card-cyrillic" id="adj-display-cyrillic"></span>
      <span class="noun-card-en"       id="adj-display-en">—</span>
    </div>

    <!-- Case input rows (dynamically generated) -->
    <div class="case-inputs" id="adj-inputs"></div>

    <!-- Controls -->
    <div class="grammar-controls">
      <button class="btn btn-secondary" id="adj-prev-btn" onclick="adjPrev()">← Prev</button>
      <button class="btn btn-primary"   onclick="checkAdj()">Check Answers</button>
      <button class="btn btn-secondary" id="adj-next-btn" onclick="adjNext()">Next →</button>
      <button class="btn btn-secondary" onclick="shuffleAdj()">⇌ Shuffle</button>
    </div>

    <div id="empty-adj" class="empty-msg" style="display:none">
      No adjectives available. Add some in <strong>Manage Cards → Adjectives</strong>.
    </div>
  </div>

  <!-- ═══════════════ FILL-IN DRILL VIEW ════════════ -->
  <div id="drill-view" style="display:none">

    <div class="drill-tense-bar">
      <span class="drill-tense-label">Tense:</span>
      <div class="drill-tense-toggles">
        <button class="drill-tense-btn active" id="tense-btn-present" onclick="toggleDrillTense('present', this)">Present</button>
        <button class="drill-tense-btn active" id="tense-btn-past"    onclick="toggleDrillTense('past', this)">Past</button>
        <button class="drill-tense-btn active" id="tense-btn-future"  onclick="toggleDrillTense('future', this)">Future</button>
      </div>
    </div>

    <div class="g-header-row">
      <span id="drill-progress">1 of 58</span>
      <span class="g-score-badge">Score: <span id="drill-score-val">0 / 0</span></span>
    </div>

    <div class="noun-card" id="drill-card">
      <span class="noun-card-given" id="drill-hint-label">Complete the sentence</span>
      <div class="drill-sentence" id="drill-sentence-el"></div>
      <span class="noun-card-en"   id="drill-english-el"></span>
    </div>

    <div class="drill-options" id="drill-options"></div>

    <div class="drill-feedback" id="drill-feedback" style="display:none"></div>

    <div class="grammar-controls">
      <button class="btn btn-secondary" id="drill-prev-btn" onclick="drillPrev()">← Prev</button>
      <button class="btn btn-secondary" id="drill-next-btn" onclick="drillNext()">Next →</button>
      <button class="btn btn-secondary" onclick="shuffleDrill()">⇌ Shuffle</button>
    </div>

  </div>

  <!-- ═══════════════ CONTEXT CHOOSER VIEW ═══════════════ -->
  <div id="aspect-view" style="display:none">

    <div class="drill-tense-bar">
      <span class="drill-tense-label">Prefix:</span>
      <div class="drill-tense-toggles">
        <span class="ctx-prefix-group"><button class="drill-tense-btn active" onclick="toggleCtxPrefix('po', this)">po-</button><button class="ctx-info-btn" onclick="showPrefixInfo('po')">ⓘ</button></span>
        <span class="ctx-prefix-group"><button class="drill-tense-btn active" onclick="toggleCtxPrefix('o', this)">o-</button><button class="ctx-info-btn" onclick="showPrefixInfo('o')">ⓘ</button></span>
        <span class="ctx-prefix-group"><button class="drill-tense-btn active" onclick="toggleCtxPrefix('za', this)">za-</button><button class="ctx-info-btn" onclick="showPrefixInfo('za')">ⓘ</button></span>
        <span class="ctx-prefix-group"><button class="drill-tense-btn active" onclick="toggleCtxPrefix('iz', this)">iz-</button><button class="ctx-info-btn" onclick="showPrefixInfo('iz')">ⓘ</button></span>
        <span class="ctx-prefix-group"><button class="drill-tense-btn active" onclick="toggleCtxPrefix('na', this)">na-</button><button class="ctx-info-btn" onclick="showPrefixInfo('na')">ⓘ</button></span>
        <span class="ctx-prefix-group"><button class="drill-tense-btn active" onclick="toggleCtxPrefix('pro', this)">pro-</button><button class="ctx-info-btn" onclick="showPrefixInfo('pro')">ⓘ</button></span>
        <span class="ctx-prefix-group"><button class="drill-tense-btn active" onclick="toggleCtxPrefix('u', this)">u-</button><button class="ctx-info-btn" onclick="showPrefixInfo('u')">ⓘ</button></span>
        <span class="ctx-prefix-group"><button class="drill-tense-btn active" onclick="toggleCtxPrefix('irregular', this)">irregular</button><button class="ctx-info-btn" onclick="showPrefixInfo('irregular')">ⓘ</button></span>
      </div>
    </div>

    <div class="g-header-row">
      <span id="ctx-progress">1 of 1</span>
      <span class="g-score-badge">Score: <span id="ctx-score-val">0 / 0</span></span>
    </div>

    <div class="noun-card ctx-card" id="ctx-card">
      <span class="noun-card-given">Which aspect fits the context?</span>
      <div class="ctx-sentence" id="ctx-en-sentence"></div>
      <div class="ctx-sentence ctx-sr-sentence" id="ctx-sr-sentence"></div>
    </div>

    <div class="ctx-choices" id="ctx-choices">
      <button class="ctx-choice ctx-choice-imp" id="ctx-btn-imp" onclick="ctxAnswer('imp')">
        <span class="aspect-badge aspect-imp">imp</span>
        <span class="ctx-choice-verb" id="ctx-imp-verb">—</span>
        <span class="ctx-choice-label">imperfective</span>
      </button>
      <button class="ctx-choice ctx-choice-pfv" id="ctx-btn-pfv" onclick="ctxAnswer('pfv')">
        <span class="aspect-badge aspect-pfv">pfv</span>
        <span class="ctx-choice-verb" id="ctx-pfv-verb">—</span>
        <span class="ctx-choice-label">perfective</span>
      </button>
    </div>

    <div class="ctx-feedback" id="ctx-feedback" style="display:none">
      <div class="ctx-feedback-rule" id="ctx-feedback-rule"></div>
      <div class="ctx-feedback-note" id="ctx-feedback-note"></div>
    </div>

    <div class="grammar-controls">
      <button class="btn btn-secondary" id="ctx-prev-btn" onclick="ctxPrev()">← Prev</button>
      <button class="btn btn-secondary" id="ctx-next-btn" onclick="ctxNext()">Next →</button>
      <button class="btn btn-secondary" onclick="shuffleCtx()">⇌ Shuffle</button>
    </div>

  </div>

  <!-- ═══════════════ SLAGALICA VIEW ═══════════════ -->
  <div id="slagalica-view" style="display:none">

    <!-- ── LOBBY ── -->
    <div id="slag-lobby" class="slag-screen">

      <!-- Stats: best score + streak dots -->
      <div class="slag-stats-bar">
        <div class="slag-best">
          <span class="slag-best-label">All-time best</span>
          <span class="slag-best-val" id="slag-best-display">0</span>
        </div>
        <div class="slag-streak-wrap">
          <span class="slag-streak-label">Last 5 rounds</span>
          <div class="slag-dots" id="slag-dots"></div>
        </div>
      </div>

      <!-- Direction selector -->
      <div class="slag-dir-row">
        <span class="tense-sel-label">Direction:</span>
        <div class="tense-btns" id="slag-dir-btns"></div>
      </div>

      <!-- Group filter -->
      <div class="group-filter-bar" id="slag-group-bar">
        <div class="group-filter-header">
          <span>Filter by group</span>
          <div class="group-filter-actions">
            <button onclick="slagSelectAllGroups()">All</button>
            <button onclick="slagClearGroups()">None</button>
          </div>
        </div>
        <div class="group-toggle-row" id="slag-group-toggles"></div>
      </div>

      <div id="slag-too-few" class="empty-msg" style="display:none">
        Not enough cards — need at least <strong>8</strong> in the selected groups.
        Add more in <strong>Manage Cards</strong>.
      </div>

      <div style="display:flex; justify-content:center">
        <button class="btn btn-primary" id="slag-start-btn" onclick="startSlagGame()"
          style="font-size:1.1rem; padding:14px 52px; border-radius:10px">
          ▶ Start Chain
        </button>
      </div>

    </div><!-- /slag-lobby -->

    <!-- ── GAME ── -->
    <div id="slag-game" class="slag-screen" style="display:none">

      <div class="slag-chain-row">
        <div class="slag-chain-box">
          <span class="slag-chain-label">Chain</span>
          <span class="slag-chain-num" id="slag-chain-num">0</span>
        </div>
        <span class="slag-dir-badge" id="slag-dir-badge">Serbian → English</span>
        <div class="slag-chain-box">
          <span class="slag-chain-label">Best</span>
          <span class="slag-chain-num" id="slag-game-best">0</span>
        </div>
      </div>

      <div class="slag-q-card" id="slag-q-card">
        <span class="slag-q-label"    id="slag-q-label">Translate to English</span>
        <span class="slag-q-word"     id="slag-q-word">—</span>
        <span class="slag-q-cyrillic" id="slag-q-cyrillic"></span>
        <span class="slag-q-cat"      id="slag-q-cat"></span>
      </div>

      <div class="slag-options" id="slag-options"></div>

      <div style="text-align:center">
        <button class="btn btn-secondary" onclick="slagQuit()"
          style="font-size:0.85rem; padding:7px 22px">Quit</button>
      </div>

    </div><!-- /slag-game -->

    <!-- ── GAME OVER ── -->
    <div id="slag-over" class="slag-screen" style="display:none">
      <div class="slag-over-card">

        <div class="slag-over-title">Chain Broken!</div>
        <div class="slag-over-score"  id="slag-final-score">0</div>
        <div class="slag-over-sub">words in a row</div>
        <div class="slag-over-record" id="slag-record-msg"></div>

        <div class="slag-wrong-box" id="slag-wrong-box">
          <div class="slag-wrong-label">You got this one wrong</div>
          <div class="slag-wrong-q"   id="slag-wrong-q"></div>
          <div class="slag-wrong-ans" id="slag-wrong-ans"></div>
        </div>

        <div class="slag-dots" id="slag-over-dots"></div>

        <div class="slag-over-btns">
          <button class="btn btn-primary"   onclick="startSlagGame()">↩ Try Again</button>
          <button class="btn btn-secondary" id="slag-replay-missed-btn" onclick="startSlagMissedGame()" style="display:none">⚑ Replay Missed (0)</button>
          <button class="btn btn-secondary" id="slag-clear-missed-btn" onclick="clearSlagMissed()" style="display:none">✕ Clear Missed</button>
          <button class="btn btn-secondary" onclick="slagToLobby()">← Back</button>
        </div>

      </div>
    </div><!-- /slag-over -->

  </div><!-- /slagalica-view -->

  <!-- ═══════════════ MANAGE VIEW ═══════════════ -->
  <div id="manage-view" style="display:none">

    <div class="manage-tabs">
      <button class="manage-tab-btn active" id="mtab-cards"   onclick="showManageTab('cards')">Flashcards</button>
      <button class="manage-tab-btn"        id="mtab-grammar" onclick="showManageTab('grammar')">Nouns</button>
      <button class="manage-tab-btn"        id="mtab-verbs"   onclick="showManageTab('verbs')">Verbs</button>
      <button class="manage-tab-btn"        id="mtab-adj"     onclick="showManageTab('adj')">Adjectives</button>
    </div>

    <!-- ── Flashcards tab ── -->
    <div id="manage-cards" class="manage-section">

      <!-- Groups manager -->
      <div>
        <p class="section-title">
          Groups <span class="section-count" id="groups-count"></span>
        </p>
        <div class="form-row" style="margin-bottom:14px">
          <div class="form-group">
            <label for="inp-group-name">New group name</label>
            <input type="text" id="inp-group-name" placeholder="e.g. Verbs, Travel, Numbers…" />
          </div>
          <div class="form-group" style="justify-content:flex-end; max-width:160px">
            <label>&nbsp;</label>
            <button class="btn btn-primary" onclick="addGroup()">Create Group</button>
          </div>
        </div>
        <div class="group-list-manage" id="group-list-manage"></div>
      </div>

      <!-- Add card -->
      <div>
        <p class="section-title">Add a Card</p>
        <div class="form-row">
          <div class="form-group">
            <label for="inp-serbian">Serbian word</label>
            <input type="text" id="inp-serbian" placeholder="e.g. hvala" inputmode="text" />
          </div>
          <div class="form-group">
            <label for="inp-english">English translation</label>
            <input type="text" id="inp-english" placeholder="e.g. thank you" inputmode="text" />
          </div>
          <div class="form-group">
            <label for="inp-group">Group</label>
            <select id="inp-group"></select>
          </div>
        </div>
        <div style="margin-top:14px">
          <button class="btn btn-primary" onclick="addCard()">Add Card</button>
        </div>
      </div>

      <!-- Card list -->
      <div>
        <p class="section-title">
          Cards <span class="section-count" id="card-count"></span>
        </p>
        <div class="list-filter-row">
          <label for="filter-group">Show group:</label>
          <select id="filter-group" onchange="renderCardList()">
            <option value="">All groups</option>
          </select>
        </div>
        <div class="card-list" id="card-list"></div>
      </div>
    </div>

    <!-- ── Grammar Nouns tab ── -->
    <div id="manage-grammar" class="manage-section" style="display:none">
      <div>
        <p class="section-title">Add a Noun</p>
        <div class="form-row" style="margin-bottom:12px">
          <div class="form-group">
            <label for="gn-english">English meaning</label>
            <input type="text" id="gn-english" placeholder="e.g. brother" />
          </div>
          <div class="form-group">
            <label for="gn-gender">Gender</label>
            <select id="gn-gender">
              <option value="masculine">Masculine</option>
              <option value="feminine">Feminine</option>
              <option value="neuter">Neuter</option>
            </select>
          </div>
        </div>
        <p style="font-size:0.82rem; color:#aaa; margin-bottom:10px">Declension forms:</p>
        <div class="declension-grid">
          <div class="form-group"><label>N — Nominativ</label>    <input type="text" id="gn-nominativ"    placeholder="e.g. brat"   /></div>
          <div class="form-group"><label>G — Genitiv</label>      <input type="text" id="gn-genitiv"      placeholder="e.g. brata"  /></div>
          <div class="form-group"><label>D — Dativ</label>        <input type="text" id="gn-dativ"        placeholder="e.g. bratu"  /></div>
          <div class="form-group"><label>A — Akuzativ</label>     <input type="text" id="gn-akuzativ"     placeholder="e.g. brata"  /></div>
          <div class="form-group"><label>V — Vokativ</label>      <input type="text" id="gn-vokativ"      placeholder="e.g. brate"  /></div>
          <div class="form-group"><label>I — Instrumental</label> <input type="text" id="gn-instrumental" placeholder="e.g. bratom" /></div>
          <div class="form-group"><label>L — Lokativ</label>      <input type="text" id="gn-lokativ"      placeholder="e.g. bratu"  /></div>
        </div>
        <div style="margin-top:16px">
          <button class="btn btn-primary" onclick="addGrammarNoun()">Add Noun</button>
        </div>
      </div>
      <div>
        <p class="section-title">All Grammar Nouns <span class="section-count" id="gn-count"></span></p>
        <div class="card-list" id="gn-list"></div>
      </div>
    </div>

    <!-- ── Verbs tab ── -->
    <div id="manage-verbs" class="manage-section" style="display:none">
      <div>
        <p class="section-title">Add a Verb</p>
        <div class="form-row" style="margin-bottom:12px">
          <div class="form-group">
            <label for="vn-infinitive">Infinitive (Serbian)</label>
            <input type="text" id="vn-infinitive" placeholder="e.g. raditi" />
          </div>
          <div class="form-group">
            <label for="vn-english">English meaning</label>
            <input type="text" id="vn-english" placeholder="e.g. to work / to do" />
          </div>
        </div>

        <div style="margin-bottom:12px; display:flex; align-items:center; gap:12px; flex-wrap:wrap">
          <span style="font-size:0.85rem; color:#aaa">Aspect:</span>
          <button type="button" class="tense-btn active" id="vn-asp-imp" onclick="setVerbAspect('imp')">Imperfective</button>
          <button type="button" class="tense-btn"        id="vn-asp-pfv" onclick="setVerbAspect('pfv')">Perfective</button>
          <button type="button" class="tense-btn"        id="vn-asp-bi"  onclick="setVerbAspect('bi')">Biaspectual</button>
        </div>

        <p style="font-size:0.82rem; color:#e94560; font-weight:600; margin-bottom:6px">Present (Sadašnje)</p>
        <div class="declension-grid" style="margin-bottom:14px">
          <div class="form-group"><label>ja</label>      <input type="text" id="vn-pres-ja"  placeholder="e.g. radim"   /></div>
          <div class="form-group"><label>ti</label>      <input type="text" id="vn-pres-ti"  placeholder="e.g. radiš"   /></div>
          <div class="form-group"><label>on/ona</label>  <input type="text" id="vn-pres-on"  placeholder="e.g. radi"    /></div>
          <div class="form-group"><label>mi</label>      <input type="text" id="vn-pres-mi"  placeholder="e.g. radimo"  /></div>
          <div class="form-group"><label>vi</label>      <input type="text" id="vn-pres-vi"  placeholder="e.g. radite"  /></div>
          <div class="form-group"><label>oni/one</label> <input type="text" id="vn-pres-oni" placeholder="e.g. rade"    /></div>
        </div>

        <p style="font-size:0.82rem; color:#e94560; font-weight:600; margin-bottom:6px">Past — masc. form (Perfekat)</p>
        <div class="declension-grid" style="margin-bottom:14px">
          <div class="form-group"><label>ja</label>      <input type="text" id="vn-past-ja"  placeholder="e.g. radio sam"   /></div>
          <div class="form-group"><label>ti</label>      <input type="text" id="vn-past-ti"  placeholder="e.g. radio si"    /></div>
          <div class="form-group"><label>on/ona</label>  <input type="text" id="vn-past-on"  placeholder="e.g. radio je"    /></div>
          <div class="form-group"><label>mi</label>      <input type="text" id="vn-past-mi"  placeholder="e.g. radili smo"  /></div>
          <div class="form-group"><label>vi</label>      <input type="text" id="vn-past-vi"  placeholder="e.g. radili ste"  /></div>
          <div class="form-group"><label>oni/one</label> <input type="text" id="vn-past-oni" placeholder="e.g. radili su"   /></div>
        </div>

        <p style="font-size:0.82rem; color:#e94560; font-weight:600; margin-bottom:6px">Future (Futur I)</p>
        <div class="declension-grid" style="margin-bottom:16px">
          <div class="form-group"><label>ja</label>      <input type="text" id="vn-fut-ja"   placeholder="e.g. radiću"    /></div>
          <div class="form-group"><label>ti</label>      <input type="text" id="vn-fut-ti"   placeholder="e.g. radićeš"   /></div>
          <div class="form-group"><label>on/ona</label>  <input type="text" id="vn-fut-on"   placeholder="e.g. radiće"    /></div>
          <div class="form-group"><label>mi</label>      <input type="text" id="vn-fut-mi"   placeholder="e.g. radićemo"  /></div>
          <div class="form-group"><label>vi</label>      <input type="text" id="vn-fut-vi"   placeholder="e.g. radićete"  /></div>
          <div class="form-group"><label>oni/one</label> <input type="text" id="vn-fut-oni"  placeholder="e.g. radiće"    /></div>
        </div>

        <button class="btn btn-primary" onclick="addUserVerb()">Add Verb</button>
      </div>
      <div>
        <p class="section-title">User Verbs <span class="section-count" id="vn-count"></span></p>
        <div class="card-list" id="vn-list"></div>
      </div>
    </div>

    <!-- ── Adjectives tab ── -->
    <div id="manage-adj" class="manage-section" style="display:none">
      <div>
        <p class="section-title">Add an Adjective</p>
        <div class="form-row" style="margin-bottom:12px">
          <div class="form-group">
            <label for="an-base">Masc. nom. sg. form</label>
            <input type="text" id="an-base" placeholder="e.g. dobar" />
          </div>
          <div class="form-group">
            <label for="an-english">English meaning</label>
            <input type="text" id="an-english" placeholder="e.g. good" />
          </div>
        </div>

        <p style="font-size:0.82rem;color:#e94560;font-weight:600;margin-bottom:6px">Masculine</p>
        <div class="declension-grid" style="margin-bottom:14px">
          <div class="form-group"><label>N</label><input type="text" id="an-m-nominativ"    placeholder="e.g. dobar"  /></div>
          <div class="form-group"><label>G</label><input type="text" id="an-m-genitiv"      placeholder="e.g. dobrog" /></div>
          <div class="form-group"><label>D</label><input type="text" id="an-m-dativ"        placeholder="e.g. dobrom" /></div>
          <div class="form-group"><label>A</label><input type="text" id="an-m-akuzativ"     placeholder="e.g. dobrog" /></div>
          <div class="form-group"><label>V</label><input type="text" id="an-m-vokativ"      placeholder="e.g. dobri"  /></div>
          <div class="form-group"><label>I</label><input type="text" id="an-m-instrumental" placeholder="e.g. dobrim" /></div>
          <div class="form-group"><label>L</label><input type="text" id="an-m-lokativ"      placeholder="e.g. dobrom" /></div>
        </div>

        <p style="font-size:0.82rem;color:#e94560;font-weight:600;margin-bottom:6px">Feminine</p>
        <div class="declension-grid" style="margin-bottom:14px">
          <div class="form-group"><label>N</label><input type="text" id="an-f-nominativ"    placeholder="e.g. dobra"  /></div>
          <div class="form-group"><label>G</label><input type="text" id="an-f-genitiv"      placeholder="e.g. dobre"  /></div>
          <div class="form-group"><label>D</label><input type="text" id="an-f-dativ"        placeholder="e.g. dobroj" /></div>
          <div class="form-group"><label>A</label><input type="text" id="an-f-akuzativ"     placeholder="e.g. dobru"  /></div>
          <div class="form-group"><label>V</label><input type="text" id="an-f-vokativ"      placeholder="e.g. dobra"  /></div>
          <div class="form-group"><label>I</label><input type="text" id="an-f-instrumental" placeholder="e.g. dobrom" /></div>
          <div class="form-group"><label>L</label><input type="text" id="an-f-lokativ"      placeholder="e.g. dobroj" /></div>
        </div>

        <p style="font-size:0.82rem;color:#e94560;font-weight:600;margin-bottom:6px">Neuter</p>
        <div class="declension-grid" style="margin-bottom:16px">
          <div class="form-group"><label>N</label><input type="text" id="an-n-nominativ"    placeholder="e.g. dobro"  /></div>
          <div class="form-group"><label>G</label><input type="text" id="an-n-genitiv"      placeholder="e.g. dobrog" /></div>
          <div class="form-group"><label>D</label><input type="text" id="an-n-dativ"        placeholder="e.g. dobrom" /></div>
          <div class="form-group"><label>A</label><input type="text" id="an-n-akuzativ"     placeholder="e.g. dobro"  /></div>
          <div class="form-group"><label>V</label><input type="text" id="an-n-vokativ"      placeholder="e.g. dobro"  /></div>
          <div class="form-group"><label>I</label><input type="text" id="an-n-instrumental" placeholder="e.g. dobrim" /></div>
          <div class="form-group"><label>L</label><input type="text" id="an-n-lokativ"      placeholder="e.g. dobrom" /></div>
        </div>

        <button class="btn btn-primary" onclick="addUserAdj()">Add Adjective</button>
      </div>
      <div>
        <p class="section-title">User Adjectives <span class="section-count" id="an-count"></span></p>
        <div class="card-list" id="an-list"></div>
      </div>
    </div>

    <!-- ── Aspect Pairs tab ── -->
  </div><!-- /manage-view -->

</main>

<script>
  // ═══════════════════════════════════════════════════
  //  CONSTANTS
  // ═══════════════════════════════════════════════════
  const PALETTE = [
    '#e94560','#0077b6','#27ae60','#f39c12',
    '#8e44ad','#16a085','#d35400','#2980b9',
    '#c0392b','#1abc9c','#e67e22','#6c5ce7',
  ];

  const CASES = [
    {
      key: 'nominativ', label: 'Nominativ', abbr: 'N', hint: 'ko? šta?',
      description: 'The subject of the sentence — who or what performs the action. This is the base (dictionary) form of the word.',
      prepositions: [],
      prepNote: 'No preposition needed. The nominative always stands alone as the sentence subject.',
      example: (form, english) => ({ sr: `Gde je ${form}?`, en: `Where is the ${english}?` }),
    },
    {
      key: 'genitiv', label: 'Genitiv', abbr: 'G', hint: 'koga? čega?',
      description: 'Expresses possession, absence, origin, or quantity. Also required after many of the most common Serbian prepositions.',
      prepositions: [
        { prep: 'od',     meaning: 'from / of' },
        { prep: 'do',     meaning: 'to / until' },
        { prep: 'iz',     meaning: 'from / out of' },
        { prep: 'kod',    meaning: 'at the place of' },
        { prep: 'bez',    meaning: 'without' },
        { prep: 'zbog',   meaning: 'because of' },
        { prep: 'posle',  meaning: 'after' },
        { prep: 'pre',    meaning: 'before' },
        { prep: 'oko',    meaning: 'around / about' },
        { prep: 'između', meaning: 'between' },
        { prep: 'pored',  meaning: 'next to' },
        { prep: 'tokom',  meaning: 'during' },
      ],
      prepNote: '',
      example: (form, english) => ({ sr: `Nema ${form}.`, en: `There is no ${english}.` }),
    },
    {
      key: 'dativ', label: 'Dativ', abbr: 'D', hint: 'kome? čemu?',
      description: 'The indirect object — the recipient of an action. Answers "to whom" or "for whom" something is done.',
      prepositions: [
        { prep: 'ka / prema', meaning: 'toward' },
        { prep: 'nasuprot',   meaning: 'opposite to' },
      ],
      prepNote: 'Most dative use is preposition-free — the case ending alone marks the indirect object.',
      example: (form, english) => ({ sr: `Dajem to ${form}.`, en: `I give it to the ${english}.` }),
    },
    {
      key: 'akuzativ', label: 'Akuzativ', abbr: 'A', hint: 'koga? šta?',
      description: 'The direct object — the thing directly acted upon. Also used after prepositions to indicate motion or direction toward something.',
      prepositions: [
        { prep: 'u',    meaning: 'into' },
        { prep: 'na',   meaning: 'onto' },
        { prep: 'za',   meaning: 'for' },
        { prep: 'kroz', meaning: 'through' },
        { prep: 'po',   meaning: 'after / per' },
        { prep: 'pred', meaning: 'in front of (motion)' },
        { prep: 'nad',  meaning: 'above (motion)' },
        { prep: 'pod',  meaning: 'under (motion)' },
      ],
      prepNote: 'With motion prepositions (u, na, pod…), accusative signals movement toward a place. Compare: "u kući" (locative = inside) vs "u kuću" (accusative = into).',
      example: (form, english) => ({ sr: `Vidim ${form}.`, en: `I see the ${english}.` }),
    },
    {
      key: 'vokativ', label: 'Vokativ', abbr: 'V', hint: 'direct address',
      description: 'Used when directly calling out to or addressing someone. It stands apart from the main sentence, typically separated by a comma.',
      prepositions: [],
      prepNote: 'Never used with a preposition. It is always an isolated call or address, often at the start of a sentence.',
      example: (form, english) => ({ sr: `Hej, ${form}!`, en: `Hey, ${english}!` }),
    },
    {
      key: 'instrumental', label: 'Instrumental', abbr: 'I', hint: 'kim? čim?',
      description: 'Expresses the means or instrument ("by means of"), or companionship ("together with"). Also marks static position after certain prepositions.',
      prepositions: [
        { prep: 'sa / s',  meaning: 'with (together with)' },
        { prep: 'pred',    meaning: 'in front of (static)' },
        { prep: 'nad',     meaning: 'above (static)' },
        { prep: 'pod',     meaning: 'under (static)' },
        { prep: 'za',      meaning: 'behind (static)' },
        { prep: 'između',  meaning: 'between (static)' },
      ],
      prepNote: 'With "sa/s" it means togetherness. Without a preposition, it expresses the tool, means, or manner of an action.',
      example: (form, english) => ({ sr: `Idem sa ${form}.`, en: `I'm going with the ${english}.` }),
    },
    {
      key: 'lokativ', label: 'Lokativ', abbr: 'L', hint: 'o kome? gde?',
      description: 'Expresses location ("where something is") or topic ("what something is about"). The only Serbian case that can never appear without a preposition.',
      prepositions: [
        { prep: 'u',   meaning: 'in / inside' },
        { prep: 'na',  meaning: 'on / at' },
        { prep: 'o',   meaning: 'about / concerning' },
        { prep: 'po',  meaning: 'around / throughout' },
        { prep: 'pri', meaning: 'at / near / upon' },
      ],
      prepNote: 'Always requires a preposition — never appears alone. Key contrast: "u + accusative" = motion into; "u + locative" = static location inside.',
      example: (form, english) => ({ sr: `Pričam o ${form}.`, en: `I'm talking about the ${english}.` }),
    },
  ];

  const SUBJECTS = [
    { key: 'ja',  label: 'ja',         pronoun: 'I' },
    { key: 'ti',  label: 'ti',         pronoun: 'you (sg.)' },
    { key: 'on',  label: 'on/ona/ono', pronoun: 'he/she/it' },
    { key: 'mi',  label: 'mi',         pronoun: 'we' },
    { key: 'vi',  label: 'vi',         pronoun: 'you (pl.)' },
    { key: 'oni', label: 'oni/one',    pronoun: 'they' },
  ];

  const TENSES = [
    { key: 'present', label: 'Present', note: 'Sadašnje' },
    { key: 'past',    label: 'Past',    note: 'Perfekat' },
    { key: 'future',  label: 'Future',  note: 'Futur I' },
  ];

  const GENDERS = [
    { key: 'masculine', label: 'Masculine', abbr: 'M' },
    { key: 'feminine',  label: 'Feminine',  abbr: 'F' },
    { key: 'neuter',    label: 'Neuter',    abbr: 'N' },
  ];

  // ═══════════════════════════════════════════════════
  //  BUILT-IN ADJECTIVES
  // ═══════════════════════════════════════════════════
  const ADJECTIVES = [
    // ── Group 1: Regular hard adjectives ─────────────────────────────────
    {
      base: 'dobar', english: 'good',
      forms: {
        masculine: { nominativ:'dobar',  genitiv:'dobrog',  dativ:'dobrom',  akuzativ:'dobrog',  vokativ:'dobri',   instrumental:'dobrim',  lokativ:'dobrom'  },
        feminine:  { nominativ:'dobra',  genitiv:'dobre',   dativ:'dobroj',  akuzativ:'dobru',   vokativ:'dobra',   instrumental:'dobrom',  lokativ:'dobroj'  },
        neuter:    { nominativ:'dobro',  genitiv:'dobrog',  dativ:'dobrom',  akuzativ:'dobro',   vokativ:'dobro',   instrumental:'dobrim',  lokativ:'dobrom'  },
      }
    },
    {
      base: 'nov', english: 'new',
      forms: {
        masculine: { nominativ:'nov',    genitiv:'novog',   dativ:'novom',   akuzativ:'novog',   vokativ:'novi',    instrumental:'novim',   lokativ:'novom'   },
        feminine:  { nominativ:'nova',   genitiv:'nove',    dativ:'novoj',   akuzativ:'novu',    vokativ:'nova',    instrumental:'novom',   lokativ:'novoj'   },
        neuter:    { nominativ:'novo',   genitiv:'novog',   dativ:'novom',   akuzativ:'novo',    vokativ:'novo',    instrumental:'novim',   lokativ:'novom'   },
      }
    },
    {
      base: 'star', english: 'old',
      forms: {
        masculine: { nominativ:'star',   genitiv:'starog',  dativ:'starom',  akuzativ:'starog',  vokativ:'stari',   instrumental:'starim',  lokativ:'starom'  },
        feminine:  { nominativ:'stara',  genitiv:'stare',   dativ:'staroj',  akuzativ:'staru',   vokativ:'stara',   instrumental:'starom',  lokativ:'staroj'  },
        neuter:    { nominativ:'staro',  genitiv:'starog',  dativ:'starom',  akuzativ:'staro',   vokativ:'staro',   instrumental:'starim',  lokativ:'starom'  },
      }
    },
    {
      base: 'lep', english: 'beautiful / nice',
      forms: {
        masculine: { nominativ:'lep',    genitiv:'lepog',   dativ:'lepom',   akuzativ:'lepog',   vokativ:'lepi',    instrumental:'lepim',   lokativ:'lepom'   },
        feminine:  { nominativ:'lepa',   genitiv:'lepe',    dativ:'lepoj',   akuzativ:'lepu',    vokativ:'lepa',    instrumental:'lepom',   lokativ:'lepoj'   },
        neuter:    { nominativ:'lepo',   genitiv:'lepog',   dativ:'lepom',   akuzativ:'lepo',    vokativ:'lepo',    instrumental:'lepim',   lokativ:'lepom'   },
      }
    },
    {
      base: 'mali', english: 'small / little',
      forms: {
        masculine: { nominativ:'mali',   genitiv:'malog',   dativ:'malom',   akuzativ:'malog',   vokativ:'mali',    instrumental:'malim',   lokativ:'malom'   },
        feminine:  { nominativ:'mala',   genitiv:'male',    dativ:'maloj',   akuzativ:'malu',    vokativ:'mala',    instrumental:'malom',   lokativ:'maloj'   },
        neuter:    { nominativ:'malo',   genitiv:'malog',   dativ:'malom',   akuzativ:'malo',    vokativ:'malo',    instrumental:'malim',   lokativ:'malom'   },
      }
    },
    {
      base: 'velik', english: 'big / large',
      forms: {
        masculine: { nominativ:'velik',  genitiv:'velikog', dativ:'velikom', akuzativ:'velikog', vokativ:'veliki',  instrumental:'velikim', lokativ:'velikom' },
        feminine:  { nominativ:'velika', genitiv:'velike',  dativ:'velikoj', akuzativ:'veliku',  vokativ:'velika',  instrumental:'velikom', lokativ:'velikoj' },
        neuter:    { nominativ:'veliko', genitiv:'velikog', dativ:'velikom', akuzativ:'veliko',  vokativ:'veliko',  instrumental:'velikim', lokativ:'velikom' },
      }
    },
    {
      base: 'mlad', english: 'young',
      forms: {
        masculine: { nominativ:'mlad',   genitiv:'mladog',  dativ:'mladom',  akuzativ:'mladog',  vokativ:'mladi',   instrumental:'mladim',  lokativ:'mladom'  },
        feminine:  { nominativ:'mlada',  genitiv:'mlade',   dativ:'mladoj',  akuzativ:'mladu',   vokativ:'mlada',   instrumental:'mladom',  lokativ:'mladoj'  },
        neuter:    { nominativ:'mlado',  genitiv:'mladog',  dativ:'mladom',  akuzativ:'mlado',   vokativ:'mlado',   instrumental:'mladim',  lokativ:'mladom'  },
      }
    },
    {
      base: 'brz', english: 'fast / quick',
      forms: {
        masculine: { nominativ:'brz',    genitiv:'brzog',   dativ:'brzom',   akuzativ:'brzog',   vokativ:'brzi',    instrumental:'brzim',   lokativ:'brzom'   },
        feminine:  { nominativ:'brza',   genitiv:'brze',    dativ:'brzoj',   akuzativ:'brzu',    vokativ:'brza',    instrumental:'brzom',   lokativ:'brzoj'   },
        neuter:    { nominativ:'brzo',   genitiv:'brzog',   dativ:'brzom',   akuzativ:'brzo',    vokativ:'brzo',    instrumental:'brzim',   lokativ:'brzom'   },
      }
    },
    {
      base: 'spor', english: 'slow',
      forms: {
        masculine: { nominativ:'spor',   genitiv:'sporog',  dativ:'sporom',  akuzativ:'sporog',  vokativ:'spori',   instrumental:'sporim',  lokativ:'sporom'  },
        feminine:  { nominativ:'spora',  genitiv:'spore',   dativ:'sporoj',  akuzativ:'sporu',   vokativ:'spora',   instrumental:'sporom',  lokativ:'sporoj'  },
        neuter:    { nominativ:'sporo',  genitiv:'sporog',  dativ:'sporom',  akuzativ:'sporo',   vokativ:'sporo',   instrumental:'sporim',  lokativ:'sporom'  },
      }
    },
    {
      base: 'jak', english: 'strong',
      forms: {
        masculine: { nominativ:'jak',    genitiv:'jakog',   dativ:'jakom',   akuzativ:'jakog',   vokativ:'jaki',    instrumental:'jakim',   lokativ:'jakom'   },
        feminine:  { nominativ:'jaka',   genitiv:'jake',    dativ:'jakoj',   akuzativ:'jaku',    vokativ:'jaka',    instrumental:'jakom',   lokativ:'jakoj'   },
        neuter:    { nominativ:'jako',   genitiv:'jakog',   dativ:'jakom',   akuzativ:'jako',    vokativ:'jako',    instrumental:'jakim',   lokativ:'jakom'   },
      }
    },
    {
      base: 'slab', english: 'weak',
      forms: {
        masculine: { nominativ:'slab',   genitiv:'slabog',  dativ:'slabom',  akuzativ:'slabog',  vokativ:'slabi',   instrumental:'slabim',  lokativ:'slabom'  },
        feminine:  { nominativ:'slaba',  genitiv:'slabe',   dativ:'slaboj',  akuzativ:'slabu',   vokativ:'slaba',   instrumental:'slabom',  lokativ:'slaboj'  },
        neuter:    { nominativ:'slabo',  genitiv:'slabog',  dativ:'slabom',  akuzativ:'slabo',   vokativ:'slabo',   instrumental:'slabim',  lokativ:'slabom'  },
      }
    },
    {
      base: 'pun', english: 'full',
      forms: {
        masculine: { nominativ:'pun',    genitiv:'punog',   dativ:'punom',   akuzativ:'punog',   vokativ:'puni',    instrumental:'punim',   lokativ:'punom'   },
        feminine:  { nominativ:'puna',   genitiv:'pune',    dativ:'punoj',   akuzativ:'punu',    vokativ:'puna',    instrumental:'punom',   lokativ:'punoj'   },
        neuter:    { nominativ:'puno',   genitiv:'punog',   dativ:'punom',   akuzativ:'puno',    vokativ:'puno',    instrumental:'punim',   lokativ:'punom'   },
      }
    },
    {
      base: 'crn', english: 'black',
      forms: {
        masculine: { nominativ:'crn',    genitiv:'crnog',   dativ:'crnom',   akuzativ:'crnog',   vokativ:'crni',    instrumental:'crnim',   lokativ:'crnom'   },
        feminine:  { nominativ:'crna',   genitiv:'crne',    dativ:'crnoj',   akuzativ:'crnu',    vokativ:'crna',    instrumental:'crnom',   lokativ:'crnoj'   },
        neuter:    { nominativ:'crno',   genitiv:'crnog',   dativ:'crnom',   akuzativ:'crno',    vokativ:'crno',    instrumental:'crnim',   lokativ:'crnom'   },
      }
    },
    {
      base: 'plav', english: 'blue',
      forms: {
        masculine: { nominativ:'plav',   genitiv:'plavog',  dativ:'plavom',  akuzativ:'plavog',  vokativ:'plavi',   instrumental:'plavim',  lokativ:'plavom'  },
        feminine:  { nominativ:'plava',  genitiv:'plave',   dativ:'plavoj',  akuzativ:'plavu',   vokativ:'plava',   instrumental:'plavom',  lokativ:'plavoj'  },
        neuter:    { nominativ:'plavo',  genitiv:'plavog',  dativ:'plavom',  akuzativ:'plavo',   vokativ:'plavo',   instrumental:'plavim',  lokativ:'plavom'  },
      }
    },
    {
      base: 'crven', english: 'red',
      forms: {
        masculine: { nominativ:'crven',  genitiv:'crvenog', dativ:'crvenom', akuzativ:'crvenog', vokativ:'crveni',  instrumental:'crvenim', lokativ:'crvenom' },
        feminine:  { nominativ:'crvena', genitiv:'crvene',  dativ:'crvenoj', akuzativ:'crvenu',  vokativ:'crvena',  instrumental:'crvenom', lokativ:'crvenoj' },
        neuter:    { nominativ:'crveno', genitiv:'crvenog', dativ:'crvenom', akuzativ:'crveno',  vokativ:'crveno',  instrumental:'crvenim', lokativ:'crvenom' },
      }
    },
    {
      base: 'zelen', english: 'green',
      forms: {
        masculine: { nominativ:'zelen',  genitiv:'zelenog', dativ:'zelenom', akuzativ:'zelenog', vokativ:'zeleni',  instrumental:'zelenim', lokativ:'zelenom' },
        feminine:  { nominativ:'zelena', genitiv:'zelene',  dativ:'zelenoj', akuzativ:'zelenu',  vokativ:'zelena',  instrumental:'zelenom', lokativ:'zelenoj' },
        neuter:    { nominativ:'zeleno', genitiv:'zelenog', dativ:'zelenom', akuzativ:'zeleno',  vokativ:'zeleno',  instrumental:'zelenim', lokativ:'zelenom' },
      }
    },
    {
      base: 'žut', english: 'yellow',
      forms: {
        masculine: { nominativ:'žut',    genitiv:'žutog',   dativ:'žutom',   akuzativ:'žutog',   vokativ:'žuti',    instrumental:'žutim',   lokativ:'žutom'   },
        feminine:  { nominativ:'žuta',   genitiv:'žute',    dativ:'žutoj',   akuzativ:'žutu',    vokativ:'žuta',    instrumental:'žutom',   lokativ:'žutoj'   },
        neuter:    { nominativ:'žuto',   genitiv:'žutog',   dativ:'žutom',   akuzativ:'žuto',    vokativ:'žuto',    instrumental:'žutim',   lokativ:'žutom'   },
      }
    },
    {
      base: 'siv', english: 'gray',
      forms: {
        masculine: { nominativ:'siv',    genitiv:'sivog',   dativ:'sivom',   akuzativ:'sivog',   vokativ:'sivi',    instrumental:'sivim',   lokativ:'sivom'   },
        feminine:  { nominativ:'siva',   genitiv:'sive',    dativ:'sivoj',   akuzativ:'sivu',    vokativ:'siva',    instrumental:'sivom',   lokativ:'sivoj'   },
        neuter:    { nominativ:'sivo',   genitiv:'sivog',   dativ:'sivom',   akuzativ:'sivo',    vokativ:'sivo',    instrumental:'sivim',   lokativ:'sivom'   },
      }
    },
    {
      base: 'zdrav', english: 'healthy',
      forms: {
        masculine: { nominativ:'zdrav',  genitiv:'zdravog', dativ:'zdravom', akuzativ:'zdravog', vokativ:'zdravi',  instrumental:'zdravim', lokativ:'zdravom' },
        feminine:  { nominativ:'zdrava', genitiv:'zdrave',  dativ:'zdravoj', akuzativ:'zdravu',  vokativ:'zdrava',  instrumental:'zdravom', lokativ:'zdravoj' },
        neuter:    { nominativ:'zdravo', genitiv:'zdravog', dativ:'zdravom', akuzativ:'zdravo',  vokativ:'zdravo',  instrumental:'zdravim', lokativ:'zdravom' },
      }
    },
    {
      base: 'lak', english: 'light / easy',
      forms: {
        masculine: { nominativ:'lak',    genitiv:'lakog',   dativ:'lakom',   akuzativ:'lakog',   vokativ:'laki',    instrumental:'lakim',   lokativ:'lakom'   },
        feminine:  { nominativ:'laka',   genitiv:'lake',    dativ:'lakoj',   akuzativ:'laku',    vokativ:'laka',    instrumental:'lakom',   lokativ:'lakoj'   },
        neuter:    { nominativ:'lako',   genitiv:'lakog',   dativ:'lakom',   akuzativ:'lako',    vokativ:'lako',    instrumental:'lakim',   lokativ:'lakom'   },
      }
    },
    {
      base: 'skup', english: 'expensive',
      forms: {
        masculine: { nominativ:'skup',   genitiv:'skupog',  dativ:'skupom',  akuzativ:'skupog',  vokativ:'skupi',   instrumental:'skupim',  lokativ:'skupom'  },
        feminine:  { nominativ:'skupa',  genitiv:'skupe',   dativ:'skupoj',  akuzativ:'skupu',   vokativ:'skupa',   instrumental:'skupom',  lokativ:'skupoj'  },
        neuter:    { nominativ:'skupo',  genitiv:'skupog',  dativ:'skupom',  akuzativ:'skupo',   vokativ:'skupo',   instrumental:'skupim',  lokativ:'skupom'  },
      }
    },
    {
      base: 'jeftin', english: 'cheap',
      forms: {
        masculine: { nominativ:'jeftin',  genitiv:'jeftinog', dativ:'jeftinom', akuzativ:'jeftinog', vokativ:'jeftini',  instrumental:'jeftinim', lokativ:'jeftinom' },
        feminine:  { nominativ:'jeftina', genitiv:'jeftine',  dativ:'jeftinoj', akuzativ:'jeftinu',  vokativ:'jeftina',  instrumental:'jeftinom', lokativ:'jeftinoj' },
        neuter:    { nominativ:'jeftino', genitiv:'jeftinog', dativ:'jeftinom', akuzativ:'jeftino',  vokativ:'jeftino',  instrumental:'jeftinim', lokativ:'jeftinom' },
      }
    },
    {
      base: 'visok', english: 'tall / high',
      forms: {
        masculine: { nominativ:'visok',  genitiv:'visokog', dativ:'visokom', akuzativ:'visokog', vokativ:'visoki',  instrumental:'visokim', lokativ:'visokom' },
        feminine:  { nominativ:'visoka', genitiv:'visoke',  dativ:'visokoj', akuzativ:'visoku',  vokativ:'visoka',  instrumental:'visokom', lokativ:'visokoj' },
        neuter:    { nominativ:'visoko', genitiv:'visokog', dativ:'visokom', akuzativ:'visoko',  vokativ:'visoko',  instrumental:'visokim', lokativ:'visokom' },
      }
    },
    {
      base: 'nizak', english: 'short / low',
      forms: {
        masculine: { nominativ:'nizak',  genitiv:'niskog',  dativ:'niskom',  akuzativ:'niskog',  vokativ:'niski',   instrumental:'niskim',  lokativ:'niskom'  },
        feminine:  { nominativ:'niska',  genitiv:'niske',   dativ:'niskoj',  akuzativ:'nisku',   vokativ:'niska',   instrumental:'niskom',  lokativ:'niskoj'  },
        neuter:    { nominativ:'nisko',  genitiv:'niskog',  dativ:'niskom',  akuzativ:'nisko',   vokativ:'nisko',   instrumental:'niskim',  lokativ:'niskom'  },
      }
    },
    {
      base: 'dalek', english: 'far / distant',
      forms: {
        masculine: { nominativ:'dalek',  genitiv:'dalekog', dativ:'dalekom', akuzativ:'dalekog', vokativ:'daleki',  instrumental:'dalekim', lokativ:'dalekom' },
        feminine:  { nominativ:'daleka', genitiv:'daleke',  dativ:'dalekoj', akuzativ:'daleku',  vokativ:'daleka',  instrumental:'dalekom', lokativ:'dalekoj' },
        neuter:    { nominativ:'daleko', genitiv:'dalekog', dativ:'dalekom', akuzativ:'daleko',  vokativ:'daleko',  instrumental:'dalekim', lokativ:'dalekom' },
      }
    },
    {
      base: 'blizak', english: 'near / close',
      forms: {
        masculine: { nominativ:'blizak', genitiv:'bliskog', dativ:'bliskom', akuzativ:'bliskog', vokativ:'bliski',  instrumental:'bliskim', lokativ:'bliskom' },
        feminine:  { nominativ:'bliska', genitiv:'bliske',  dativ:'bliskoj', akuzativ:'blisku',  vokativ:'bliska',  instrumental:'bliskom', lokativ:'bliskoj' },
        neuter:    { nominativ:'blisko', genitiv:'bliskog', dativ:'bliskom', akuzativ:'blisko',  vokativ:'blisko',  instrumental:'bliskim', lokativ:'bliskom' },
      }
    },
    {
      base: 'poznat', english: 'known / famous',
      forms: {
        masculine: { nominativ:'poznat',  genitiv:'poznatog', dativ:'poznatom', akuzativ:'poznatog', vokativ:'poznati',  instrumental:'poznatim', lokativ:'poznatom' },
        feminine:  { nominativ:'poznata', genitiv:'poznate',  dativ:'poznatoj', akuzativ:'poznatu',  vokativ:'poznata',  instrumental:'poznatom', lokativ:'poznatoj' },
        neuter:    { nominativ:'poznato', genitiv:'poznatog', dativ:'poznatom', akuzativ:'poznato',  vokativ:'poznato',  instrumental:'poznatim', lokativ:'poznatom' },
      }
    },
    {
      base: 'otvoren', english: 'open',
      forms: {
        masculine: { nominativ:'otvoren',  genitiv:'otvorenog', dativ:'otvorenom', akuzativ:'otvorenog', vokativ:'otvoreni',  instrumental:'otvorenim', lokativ:'otvorenom' },
        feminine:  { nominativ:'otvorena', genitiv:'otvorene',  dativ:'otvorenoj', akuzativ:'otvorenu',  vokativ:'otvorena',  instrumental:'otvorenom', lokativ:'otvorenoj' },
        neuter:    { nominativ:'otvoreno', genitiv:'otvorenog', dativ:'otvorenom', akuzativ:'otvoreno',  vokativ:'otvoreno',  instrumental:'otvorenim', lokativ:'otvorenom' },
      }
    },
    {
      base: 'zatvoren', english: 'closed',
      forms: {
        masculine: { nominativ:'zatvoren',  genitiv:'zatvorenog', dativ:'zatvorenom', akuzativ:'zatvorenog', vokativ:'zatvoreni',  instrumental:'zatvorenim', lokativ:'zatvorenom' },
        feminine:  { nominativ:'zatvorena', genitiv:'zatvorene',  dativ:'zatvorenoj', akuzativ:'zatvorenu',  vokativ:'zatvorena',  instrumental:'zatvorenom', lokativ:'zatvorenoj' },
        neuter:    { nominativ:'zatvoreno', genitiv:'zatvorenog', dativ:'zatvorenom', akuzativ:'zatvoreno',  vokativ:'zatvoreno',  instrumental:'zatvorenim', lokativ:'zatvorenom' },
      }
    },
    {
      base: 'zanimljiv', english: 'interesting',
      forms: {
        masculine: { nominativ:'zanimljiv',  genitiv:'zanimljivog', dativ:'zanimljivom', akuzativ:'zanimljivog', vokativ:'zanimljivi',  instrumental:'zanimljivim', lokativ:'zanimljivom' },
        feminine:  { nominativ:'zanimljiva', genitiv:'zanimljive',  dativ:'zanimljivoj', akuzativ:'zanimljivu',  vokativ:'zanimljiva',  instrumental:'zanimljivom', lokativ:'zanimljivoj' },
        neuter:    { nominativ:'zanimljivo', genitiv:'zanimljivog', dativ:'zanimljivom', akuzativ:'zanimljivo',  vokativ:'zanimljivo',  instrumental:'zanimljivim', lokativ:'zanimljivom' },
      }
    },
    {
      base: 'važan', english: 'important',
      forms: {
        masculine: { nominativ:'važan',  genitiv:'važnog',  dativ:'važnom',  akuzativ:'važnog',  vokativ:'važni',   instrumental:'važnim',  lokativ:'važnom'  },
        feminine:  { nominativ:'važna',  genitiv:'važne',   dativ:'važnoj',  akuzativ:'važnu',   vokativ:'važna',   instrumental:'važnom',  lokativ:'važnoj'  },
        neuter:    { nominativ:'važno',  genitiv:'važnog',  dativ:'važnom',  akuzativ:'važno',   vokativ:'važno',   instrumental:'važnim',  lokativ:'važnom'  },
      }
    },
    {
      base: 'čist', english: 'clean',
      forms: {
        masculine: { nominativ:'čist',   genitiv:'čistog',  dativ:'čistom',  akuzativ:'čistog',  vokativ:'čisti',   instrumental:'čistim',  lokativ:'čistom'  },
        feminine:  { nominativ:'čista',  genitiv:'čiste',   dativ:'čistoj',  akuzativ:'čistu',   vokativ:'čista',   instrumental:'čistom',  lokativ:'čistoj'  },
        neuter:    { nominativ:'čisto',  genitiv:'čistog',  dativ:'čistom',  akuzativ:'čisto',   vokativ:'čisto',   instrumental:'čistim',  lokativ:'čistom'  },
      }
    },
    {
      base: 'prav', english: 'right / correct / straight',
      forms: {
        masculine: { nominativ:'prav',   genitiv:'pravog',  dativ:'pravom',  akuzativ:'pravog',  vokativ:'pravi',   instrumental:'pravim',  lokativ:'pravom'  },
        feminine:  { nominativ:'prava',  genitiv:'prave',   dativ:'pravoj',  akuzativ:'pravu',   vokativ:'prava',   instrumental:'pravom',  lokativ:'pravoj'  },
        neuter:    { nominativ:'pravo',  genitiv:'pravog',  dativ:'pravom',  akuzativ:'pravo',   vokativ:'pravo',   instrumental:'pravim',  lokativ:'pravom'  },
      }
    },
    // ── Group 2: Adjectives with stem alternation ─────────────────────────
    {
      base: 'loš', english: 'bad',
      forms: {
        masculine: { nominativ:'loš',    genitiv:'lošeg',   dativ:'lošem',   akuzativ:'lošeg',   vokativ:'loše',    instrumental:'lošim',   lokativ:'lošem'   },
        feminine:  { nominativ:'loša',   genitiv:'loše',    dativ:'lošoj',   akuzativ:'lošu',    vokativ:'loša',    instrumental:'lošom',   lokativ:'lošoj'   },
        neuter:    { nominativ:'loše',   genitiv:'lošeg',   dativ:'lošem',   akuzativ:'loše',    vokativ:'loše',    instrumental:'lošim',   lokativ:'lošem'   },
      }
    },
    {
      base: 'hladan', english: 'cold',
      forms: {
        masculine: { nominativ:'hladan', genitiv:'hladnog', dativ:'hladnom', akuzativ:'hladnog', vokativ:'hladni',  instrumental:'hladnim', lokativ:'hladnom' },
        feminine:  { nominativ:'hladna', genitiv:'hladne',  dativ:'hladnoj', akuzativ:'hladnu',  vokativ:'hladna',  instrumental:'hladnom', lokativ:'hladnoj' },
        neuter:    { nominativ:'hladno', genitiv:'hladnog', dativ:'hladnom', akuzativ:'hladno',  vokativ:'hladno',  instrumental:'hladnim', lokativ:'hladnom' },
      }
    },
    {
      base: 'topao', english: 'warm',
      forms: {
        masculine: { nominativ:'topao',  genitiv:'toplog',  dativ:'toplom',  akuzativ:'toplog',  vokativ:'topli',   instrumental:'toplim',  lokativ:'toplom'  },
        feminine:  { nominativ:'topla',  genitiv:'tople',   dativ:'toploj',  akuzativ:'toplu',   vokativ:'topla',   instrumental:'toplom',  lokativ:'toploj'  },
        neuter:    { nominativ:'toplo',  genitiv:'toplog',  dativ:'toplom',  akuzativ:'toplo',   vokativ:'toplo',   instrumental:'toplim',  lokativ:'toplom'  },
      }
    },
    {
      base: 'beo', english: 'white',
      forms: {
        masculine: { nominativ:'beo',    genitiv:'belog',   dativ:'belom',   akuzativ:'belog',   vokativ:'beli',    instrumental:'belim',   lokativ:'belom'   },
        feminine:  { nominativ:'bela',   genitiv:'bele',    dativ:'beloj',   akuzativ:'belu',    vokativ:'bela',    instrumental:'belom',   lokativ:'beloj'   },
        neuter:    { nominativ:'belo',   genitiv:'belog',   dativ:'belom',   akuzativ:'belo',    vokativ:'belo',    instrumental:'belim',   lokativ:'belom'   },
      }
    },
    {
      base: 'vruć', english: 'hot',
      forms: {
        masculine: { nominativ:'vruć',   genitiv:'vrućeg',  dativ:'vrućem',  akuzativ:'vrućeg',  vokativ:'vruće',   instrumental:'vrućim',  lokativ:'vrućem'  },
        feminine:  { nominativ:'vruća',  genitiv:'vruće',   dativ:'vrućoj',  akuzativ:'vruću',   vokativ:'vruća',   instrumental:'vrućom',  lokativ:'vrućoj'  },
        neuter:    { nominativ:'vruće',  genitiv:'vrućeg',  dativ:'vrućem',  akuzativ:'vruće',   vokativ:'vruće',   instrumental:'vrućim',  lokativ:'vrućem'  },
      }
    },
    {
      base: 'srećan', english: 'happy',
      forms: {
        masculine: { nominativ:'srećan', genitiv:'srećnog', dativ:'srećnom', akuzativ:'srećnog', vokativ:'srećni',  instrumental:'srećnim', lokativ:'srećnom' },
        feminine:  { nominativ:'srećna', genitiv:'srećne',  dativ:'srećnoj', akuzativ:'srećnu',  vokativ:'srećna',  instrumental:'srećnom', lokativ:'srećnoj' },
        neuter:    { nominativ:'srećno', genitiv:'srećnog', dativ:'srećnom', akuzativ:'srećno',  vokativ:'srećno',  instrumental:'srećnim', lokativ:'srećnom' },
      }
    },
    {
      base: 'tužan', english: 'sad',
      forms: {
        masculine: { nominativ:'tužan',  genitiv:'tužnog',  dativ:'tužnom',  akuzativ:'tužnog',  vokativ:'tužni',   instrumental:'tužnim',  lokativ:'tužnom'  },
        feminine:  { nominativ:'tužna',  genitiv:'tužne',   dativ:'tužnoj',  akuzativ:'tužnu',   vokativ:'tužna',   instrumental:'tužnom',  lokativ:'tužnoj'  },
        neuter:    { nominativ:'tužno',  genitiv:'tužnog',  dativ:'tužnom',  akuzativ:'tužno',   vokativ:'tužno',   instrumental:'tužnim',  lokativ:'tužnom'  },
      }
    },
    {
      base: 'gladan', english: 'hungry',
      forms: {
        masculine: { nominativ:'gladan', genitiv:'gladnog', dativ:'gladnom', akuzativ:'gladnog', vokativ:'gladni',  instrumental:'gladnim', lokativ:'gladnom' },
        feminine:  { nominativ:'gladna', genitiv:'gladne',  dativ:'gladnoj', akuzativ:'gladnu',  vokativ:'gladna',  instrumental:'gladnom', lokativ:'gladnoj' },
        neuter:    { nominativ:'gladno', genitiv:'gladnog', dativ:'gladnom', akuzativ:'gladno',  vokativ:'gladno',  instrumental:'gladnim', lokativ:'gladnom' },
      }
    },
    {
      base: 'žedan', english: 'thirsty',
      forms: {
        masculine: { nominativ:'žedan',  genitiv:'žednog',  dativ:'žednom',  akuzativ:'žednog',  vokativ:'žedni',   instrumental:'žednim',  lokativ:'žednom'  },
        feminine:  { nominativ:'žedna',  genitiv:'žedne',   dativ:'žednoj',  akuzativ:'žednu',   vokativ:'žedna',   instrumental:'žednom',  lokativ:'žednoj'  },
        neuter:    { nominativ:'žedno',  genitiv:'žednog',  dativ:'žednom',  akuzativ:'žedno',   vokativ:'žedno',   instrumental:'žednim',  lokativ:'žednom'  },
      }
    },
    {
      base: 'težak', english: 'heavy / difficult',
      forms: {
        masculine: { nominativ:'težak',  genitiv:'teškog',  dativ:'teškom',  akuzativ:'teškog',  vokativ:'teški',   instrumental:'teškim',  lokativ:'teškom'  },
        feminine:  { nominativ:'teška',  genitiv:'teške',   dativ:'teškoj',  akuzativ:'tešku',   vokativ:'teška',   instrumental:'teškom',  lokativ:'teškoj'  },
        neuter:    { nominativ:'teško',  genitiv:'teškog',  dativ:'teškom',  akuzativ:'teško',   vokativ:'teško',   instrumental:'teškim',  lokativ:'teškom'  },
      }
    },
    {
      base: 'bolestan', english: 'sick / ill',
      forms: {
        masculine: { nominativ:'bolestan', genitiv:'bolesnog', dativ:'bolesnom', akuzativ:'bolesnog', vokativ:'bolesni',  instrumental:'bolesnim', lokativ:'bolesnom' },
        feminine:  { nominativ:'bolesna',  genitiv:'bolesne',  dativ:'bolesnoj', akuzativ:'bolesnu',  vokativ:'bolesna',  instrumental:'bolesnom', lokativ:'bolesnoj' },
        neuter:    { nominativ:'bolesno',  genitiv:'bolesnog', dativ:'bolesnom', akuzativ:'bolesno',  vokativ:'bolesno',  instrumental:'bolesnim', lokativ:'bolesnom' },
      }
    },
    {
      base: 'dosadan', english: 'boring',
      forms: {
        masculine: { nominativ:'dosadan', genitiv:'dosadnog', dativ:'dosadnom', akuzativ:'dosadnog', vokativ:'dosadni',  instrumental:'dosadnim', lokativ:'dosadnom' },
        feminine:  { nominativ:'dosadna', genitiv:'dosadne',  dativ:'dosadnoj', akuzativ:'dosadnu',  vokativ:'dosadna',  instrumental:'dosadnom', lokativ:'dosadnoj' },
        neuter:    { nominativ:'dosadno', genitiv:'dosadnog', dativ:'dosadnom', akuzativ:'dosadno',  vokativ:'dosadno',  instrumental:'dosadnim', lokativ:'dosadnom' },
      }
    },
    {
      base: 'prazan', english: 'empty',
      forms: {
        masculine: { nominativ:'prazan',  genitiv:'praznog', dativ:'praznom', akuzativ:'praznog', vokativ:'prazni',  instrumental:'praznim', lokativ:'praznom' },
        feminine:  { nominativ:'prazna',  genitiv:'prazne',  dativ:'praznoj', akuzativ:'praznu',  vokativ:'prazna',  instrumental:'praznom', lokativ:'praznoj' },
        neuter:    { nominativ:'prazno',  genitiv:'praznog', dativ:'praznom', akuzativ:'prazno',  vokativ:'prazno',  instrumental:'praznim', lokativ:'praznom' },
      }
    },
  ];

  // ═══════════════════════════════════════════════════
  //  CONTEXT CHOOSER
  // ═══════════════════════════════════════════════════
  // Each entry: english sentence, serbian sentence with ___, imp/pfv infinitives,
  //   answer ('imp'|'pfv'), fill (conjugated form that goes in the blank),
  //   rule (short label), note (explanation).
  const CONTEXT_DRILLS = [
    // ── piti / popiti ──────────────────────────────────────────────
    { english: 'Every morning I drink coffee.',
      serbian: 'Svako jutro ___ kafu.',
      imp: 'piti', pfv: 'popiti', answer: 'imp', fill: 'pijem', distractor: 'popijem',
      rule: 'Habitual action',
      note: 'A routine that repeats every morning → imperfective.' },
    { english: 'She drank the whole cup.',
      serbian: 'Ona je ___ celu šolju.',
      imp: 'piti', pfv: 'popiti', answer: 'pfv', fill: 'popila', distractor: 'pila',
      rule: 'Completed action',
      note: 'The cup is empty — action reached its endpoint → perfective.' },
    { english: 'He was drinking tea when the phone rang.',
      serbian: 'On je ___ čaj kada je zazvonio telefon.',
      imp: 'piti', pfv: 'popiti', answer: 'imp', fill: 'pio', distractor: 'popio',
      rule: 'Ongoing action interrupted',
      note: 'The activity was in progress when something else happened → imperfective.' },

    // ── čitati / pročitati ─────────────────────────────────────────
    { english: 'I usually read before bed.',
      serbian: 'Obično ___ pre spavanja.',
      imp: 'čitati', pfv: 'pročitati', answer: 'imp', fill: 'čitam', distractor: 'pročitam',
      rule: 'Habitual action',
      note: 'A regular nightly habit → imperfective.' },
    { english: 'She read the whole book in one day.',
      serbian: 'Ona je ___ celu knjigu za jedan dan.',
      imp: 'čitati', pfv: 'pročitati', answer: 'pfv', fill: 'pročitala', distractor: 'čitala',
      rule: 'Completed action',
      note: 'The entire book finished — clear endpoint → perfective.' },
    { english: 'He was reading for hours.',
      serbian: 'On je ___ satima.',
      imp: 'čitati', pfv: 'pročitati', answer: 'imp', fill: 'čitao', distractor: 'pročitao',
      rule: 'Duration without stated end',
      note: 'Extended activity with no stated endpoint → imperfective.' },

    // ── pisati / napisati ──────────────────────────────────────────
    { english: 'She writes in her diary every evening.',
      serbian: 'Ona ___ u dnevnik svako veče.',
      imp: 'pisati', pfv: 'napisati', answer: 'imp', fill: 'piše', distractor: 'napiše',
      rule: 'Habitual action',
      note: 'Recurring evening habit → imperfective.' },
    { english: 'He finally wrote the email.',
      serbian: 'On je konačno ___ mejl.',
      imp: 'pisati', pfv: 'napisati', answer: 'pfv', fill: 'napisao', distractor: 'pisao',
      rule: 'Completed result',
      note: '"Finally" signals a completed, bounded action → perfective.' },
    { english: 'I was writing a letter all afternoon.',
      serbian: '___ pismo celo popodne.',
      imp: 'pisati', pfv: 'napisati', answer: 'imp', fill: 'Pisao sam', distractor: 'Napisao sam',
      rule: 'Activity over a duration',
      note: 'Focus on the activity itself over time, not on finishing it → imperfective.' },

    // ── učiti / naučiti ────────────────────────────────────────────
    { english: 'I study Serbian every day.',
      serbian: '___ srpski svaki dan.',
      imp: 'učiti', pfv: 'naučiti', answer: 'imp', fill: 'Učim', distractor: 'Naučim',
      rule: 'Habitual action',
      note: 'Daily ongoing study → imperfective.' },
    { english: 'I finally learned the alphabet.',
      serbian: 'Konačno sam ___ azbuku.',
      imp: 'učiti', pfv: 'naučiti', answer: 'pfv', fill: 'naučio', distractor: 'učio',
      rule: 'Achieved result',
      note: 'Mastery reached — a clear endpoint → perfective.' },

    // ── jesti / pojesti ────────────────────────────────────────────
    { english: 'We eat lunch at noon every day.',
      serbian: '___ ručak u podne svakog dana.',
      imp: 'jesti', pfv: 'pojesti', answer: 'imp', fill: 'Jedemo', distractor: 'Pojedemo',
      rule: 'Habitual action',
      note: 'A regular lunchtime routine → imperfective.' },
    { english: 'She ate the whole pizza.',
      serbian: 'Ona je ___ celu picu.',
      imp: 'jesti', pfv: 'pojesti', answer: 'pfv', fill: 'pojela', distractor: 'jela',
      rule: 'Completed action',
      note: 'The pizza is gone — action complete → perfective.' },

    // ── gledati / pogledati ────────────────────────────────────────
    { english: 'We watch TV every night.',
      serbian: '___ televiziju svako veče.',
      imp: 'gledati', pfv: 'pogledati', answer: 'imp', fill: 'Gledamo', distractor: 'Pogledamo',
      rule: 'Habitual action',
      note: 'Nightly routine → imperfective.' },
    { english: 'He glanced at the clock.',
      serbian: 'On je ___ na sat.',
      imp: 'gledati', pfv: 'pogledati', answer: 'pfv', fill: 'pogledao', distractor: 'gledao',
      rule: 'Single brief action',
      note: 'One quick look — a bounded, momentary action → perfective.' },
    { english: 'She was watching the rain.',
      serbian: 'Ona je ___ kišu.',
      imp: 'gledati', pfv: 'pogledati', answer: 'imp', fill: 'gledala', distractor: 'pogledala',
      rule: 'Ongoing / progressive',
      note: 'Sustained watching with no defined endpoint → imperfective.' },

    // ── kuvati / skuvati ───────────────────────────────────────────
    { english: 'Mom cooks dinner every day.',
      serbian: 'Mama ___ večeru svaki dan.',
      imp: 'kuvati', pfv: 'skuvati', answer: 'imp', fill: 'kuva', distractor: 'skuva',
      rule: 'Habitual action',
      note: 'Daily cooking routine → imperfective.' },
    { english: 'I cooked the soup.',
      serbian: 'Ja sam ___ supu.',
      imp: 'kuvati', pfv: 'skuvati', answer: 'pfv', fill: 'skuvao', distractor: 'kuvao',
      rule: 'Completed result',
      note: 'The soup is ready — task done → perfective.' },

    // ── čistiti / očistiti ─────────────────────────────────────────
    { english: 'She cleans the apartment every week.',
      serbian: 'Ona ___ stan svake nedelje.',
      imp: 'čistiti', pfv: 'očistiti', answer: 'imp', fill: 'čisti', distractor: 'očisti',
      rule: 'Habitual action',
      note: 'Weekly cleaning routine → imperfective.' },
    { english: 'He cleaned the whole apartment.',
      serbian: 'On je ___ ceo stan.',
      imp: 'čistiti', pfv: 'očistiti', answer: 'pfv', fill: 'očistio', distractor: 'čistio',
      rule: 'Completed action',
      note: 'Entire apartment done — action complete → perfective.' },

    // ── zvati / pozvati ────────────────────────────────────────────
    { english: 'She calls her mom every Sunday.',
      serbian: 'Ona ___ mamu svake nedelje.',
      imp: 'zvati', pfv: 'pozvati', answer: 'imp', fill: 'zove', distractor: 'pozove',
      rule: 'Habitual action',
      note: 'Regular weekly call → imperfective.' },
    { english: 'He invited me to the party.',
      serbian: 'On me je ___ na žurku.',
      imp: 'zvati', pfv: 'pozvati', answer: 'pfv', fill: 'pozvao', distractor: 'zvao',
      rule: 'Completed action',
      note: 'The invitation happened and is done → perfective.' },

    // ── dolaziti / doći ────────────────────────────────────────────
    { english: 'She comes to work by train.',
      serbian: 'Ona ___ na posao vozom.',
      imp: 'dolaziti', pfv: 'doći', answer: 'imp', fill: 'dolazi', distractor: 'dođe',
      rule: 'Habitual action',
      note: 'Regular commute method → imperfective.' },
    { english: 'She finally arrived!',
      serbian: 'Ona je konačno ___!',
      imp: 'dolaziti', pfv: 'doći', answer: 'pfv', fill: 'došla', distractor: 'dolazila',
      rule: 'Completed arrival',
      note: 'She is here now — the arrival is complete → perfective.' },

    // ── odlaziti / otići ───────────────────────────────────────────
    { english: 'He leaves work at five every day.',
      serbian: 'On ___ s posla u pet svakog dana.',
      imp: 'odlaziti', pfv: 'otići', answer: 'imp', fill: 'odlazi', distractor: 'otiđe',
      rule: 'Habitual action',
      note: 'Regular departure time → imperfective.' },
    { english: 'She left without saying goodbye.',
      serbian: 'Ona je ___ bez pozdrava.',
      imp: 'odlaziti', pfv: 'otići', answer: 'pfv', fill: 'otišla', distractor: 'odlazila',
      rule: 'Completed departure',
      note: 'She is gone — the action is complete → perfective.' },

    // ── kupovati / kupiti ──────────────────────────────────────────
    { english: 'I buy groceries on Saturdays.',
      serbian: '___ namirnice subotom.',
      imp: 'kupovati', pfv: 'kupiti', answer: 'imp', fill: 'Kupujem', distractor: 'Kupim',
      rule: 'Habitual action',
      note: 'Weekly shopping routine → imperfective.' },
    { english: 'I bought a new phone.',
      serbian: 'Ja sam ___ novi telefon.',
      imp: 'kupovati', pfv: 'kupiti', answer: 'pfv', fill: 'kupio', distractor: 'kupovao',
      rule: 'Completed purchase',
      note: 'The transaction is done → perfective.' },

    // ── vraćati se / vratiti se ────────────────────────────────────
    { english: 'He returns home every evening.',
      serbian: 'On se ___ kući svako veče.',
      imp: 'vraćati se', pfv: 'vratiti se', answer: 'imp', fill: 'vraća', distractor: 'vrati',
      rule: 'Habitual action',
      note: 'Daily evening return → imperfective.' },
    { english: 'She returned from vacation.',
      serbian: 'Ona se ___ s odmora.',
      imp: 'vraćati se', pfv: 'vratiti se', answer: 'pfv', fill: 'vratila', distractor: 'vraćala',
      rule: 'Completed return',
      note: 'The trip is over and she is back → perfective.' },

    // ── otvarati / otvoriti ────────────────────────────────────────
    { english: 'The store opens at nine every day.',
      serbian: 'Prodavnica se ___ u devet svakog dana.',
      imp: 'otvarati', pfv: 'otvoriti', answer: 'imp', fill: 'otvara', distractor: 'otvori',
      rule: 'Habitual action',
      note: 'Regular daily opening → imperfective.' },
    { english: 'He opened the window.',
      serbian: 'On je ___ prozor.',
      imp: 'otvarati', pfv: 'otvoriti', answer: 'pfv', fill: 'otvorio', distractor: 'otvarao',
      rule: 'Single completed action',
      note: 'The window is open now — action done → perfective.' },

    // ── plaćati / platiti ──────────────────────────────────────────
    { english: 'She always pays with a card.',
      serbian: 'Ona uvek ___ karticom.',
      imp: 'plaćati', pfv: 'platiti', answer: 'imp', fill: 'plaća', distractor: 'plati',
      rule: 'Habitual action',
      note: 'Consistent payment habit → imperfective.' },
    { english: 'He paid the bill.',
      serbian: 'On je ___ račun.',
      imp: 'plaćati', pfv: 'platiti', answer: 'pfv', fill: 'platio', distractor: 'plaćao',
      rule: 'Completed action',
      note: 'Bill settled — action complete → perfective.' },

    // ── raditi / uraditi ───────────────────────────────────────────
    { english: 'I work from home on Fridays.',
      serbian: '___ od kuće petkom.',
      imp: 'raditi', pfv: 'uraditi', answer: 'imp', fill: 'Radim', distractor: 'Uradim',
      rule: 'Habitual action',
      note: 'Regular Friday arrangement → imperfective.' },
    { english: 'She did her homework.',
      serbian: 'Ona je ___ domaći zadatak.',
      imp: 'raditi', pfv: 'uraditi', answer: 'pfv', fill: 'uradila', distractor: 'radila',
      rule: 'Completed task',
      note: 'Homework finished → perfective.' },

    // ── govoriti / reći ────────────────────────────────────────────
    { english: 'He speaks slowly and clearly.',
      serbian: 'On ___ polako i jasno.',
      imp: 'govoriti', pfv: 'reći', answer: 'imp', fill: 'govori', distractor: 'kaže',
      rule: 'Ongoing manner / state',
      note: 'Describes how someone communicates — a habitual style → imperfective.' },
    { english: 'She said something important.',
      serbian: 'Ona je ___ nešto važno.',
      imp: 'govoriti', pfv: 'reći', answer: 'pfv', fill: 'rekla', distractor: 'govorila',
      rule: 'Single completed utterance',
      note: 'A specific statement made at a point in time → perfective.' },

    // ── čekati / pričekati ─────────────────────────────────────────
    { english: 'I wait for the bus every morning.',
      serbian: '___ bus svako jutro.',
      imp: 'čekati', pfv: 'pričekati', answer: 'imp', fill: 'Čekam', distractor: 'Pričekam',
      rule: 'Habitual action',
      note: 'Regular morning wait → imperfective.' },
    { english: 'Wait for me just a moment!',
      serbian: '___ me trenutak!',
      imp: 'čekati', pfv: 'pričekati', answer: 'pfv', fill: 'Pričekaj', distractor: 'Čekaj',
      rule: 'Brief bounded action',
      note: 'A short, defined wait (just a moment) → perfective.' },

    // ── slušati / poslušati ────────────────────────────────────────
    { english: 'He listens to music while cooking.',
      serbian: 'On ___ muziku dok kuva.',
      imp: 'slušati', pfv: 'poslušati', answer: 'imp', fill: 'sluša', distractor: 'posluša',
      rule: 'Ongoing background activity',
      note: 'Continuous listening alongside another action → imperfective.' },
    { english: 'She listened to the whole album.',
      serbian: 'Ona je ___ ceo album.',
      imp: 'slušati', pfv: 'poslušati', answer: 'pfv', fill: 'poslušala', distractor: 'slušala',
      rule: 'Completed listening',
      note: 'The whole album done from start to finish → perfective.' },

    // ── tražiti / naći ─────────────────────────────────────────────
    { english: 'I look for my keys every morning.',
      serbian: '___ ključeve svako jutro.',
      imp: 'tražiti', pfv: 'naći', answer: 'imp', fill: 'Tražim', distractor: 'Nađem',
      rule: 'Ongoing / habitual search',
      note: 'Recurring frustrated search — process only → imperfective.' },
    { english: 'I found my keys!',
      serbian: '___ ključeve!',
      imp: 'tražiti', pfv: 'naći', answer: 'pfv', fill: 'Našao sam', distractor: 'Tražio sam',
      rule: 'Achieved result',
      note: 'The search is over — success achieved → perfective.' },

    // ── završavati / završiti ──────────────────────────────────────
    { english: 'She finishes work at six.',
      serbian: 'Ona ___ s posla u šest.',
      imp: 'završavati', pfv: 'završiti', answer: 'imp', fill: 'završava', distractor: 'završi',
      rule: 'Habitual action',
      note: 'Regular end-of-day time → imperfective.' },
    { english: 'He finished the project.',
      serbian: 'On je ___ projekat.',
      imp: 'završavati', pfv: 'završiti', answer: 'pfv', fill: 'završio', distractor: 'završavao',
      rule: 'Completed achievement',
      note: 'Project done — clear endpoint reached → perfective.' },

    // ── pevati / otpevati ──────────────────────────────────────────────
    { english: 'She sings in a choir every week.',
      serbian: 'Ona ___ u horu svake nedelje.',
      imp: 'pevati', pfv: 'otpevati', answer: 'imp', fill: 'peva', distractor: 'otpeva',
      rule: 'Habitual action',
      note: 'Regular weekly choir practice → imperfective.' },
    { english: 'She performed the whole song.',
      serbian: 'Ona je ___ celu pesmu.',
      imp: 'pevati', pfv: 'otpevati', answer: 'pfv', fill: 'otpevala', distractor: 'pevala',
      rule: 'Completed performance',
      note: 'The song was sung all the way through to the end → perfective.' },

    // ── padati / pasti ─────────────────────────────────────────────────
    { english: 'Snow falls every winter.',
      serbian: 'Sneg ___ svake zime.',
      imp: 'padati', pfv: 'pasti', answer: 'imp', fill: 'pada', distractor: 'padne',
      rule: 'Habitual / recurring event',
      note: 'A seasonal pattern that repeats every year → imperfective.' },
    { english: 'He fell off his bicycle.',
      serbian: 'On je ___ s bicikla.',
      imp: 'padati', pfv: 'pasti', answer: 'pfv', fill: 'pao', distractor: 'padao',
      rule: 'Single completed event',
      note: 'A specific, bounded fall that happened at a moment → perfective.' },

    // ── zatvarati / zatvoriti ──────────────────────────────────────────
    { english: 'The store closes at eight every evening.',
      serbian: 'Prodavnica se ___ u osam svako veče.',
      imp: 'zatvarati', pfv: 'zatvoriti', answer: 'imp', fill: 'zatvara', distractor: 'zatvori',
      rule: 'Habitual action',
      note: 'Regular daily closing routine → imperfective.' },
    { english: 'She closed the door.',
      serbian: 'Ona je ___ vrata.',
      imp: 'zatvarati', pfv: 'zatvoriti', answer: 'pfv', fill: 'zatvorila', distractor: 'zatvarala',
      rule: 'Single completed action',
      note: 'The door is now closed — action done → perfective.' },

    // ── zaboravljati / zaboraviti ──────────────────────────────────────
    { english: 'He always forgets things.',
      serbian: 'On uvek ___ stvari.',
      imp: 'zaboravljati', pfv: 'zaboraviti', answer: 'imp', fill: 'zaboravlja', distractor: 'zaboravi',
      rule: 'Habitual tendency',
      note: '"Always" with a repeated pattern → imperfective.' },
    { english: 'She forgot her keys.',
      serbian: 'Ona je ___ ključeve.',
      imp: 'zaboravljati', pfv: 'zaboraviti', answer: 'pfv', fill: 'zaboravila', distractor: 'zaboravljala',
      rule: 'Specific completed instance',
      note: 'A single specific act of forgetting → perfective.' },

    // ── sećati se / setiti se ──────────────────────────────────────────
    { english: 'I often think back to my childhood.',
      serbian: 'Često se ___ detinjstva.',
      imp: 'sećati se', pfv: 'setiti se', answer: 'imp', fill: 'sećam', distractor: 'setim',
      rule: 'Habitual / ongoing',
      note: 'Recurring memory that comes up frequently → imperfective.' },
    { english: 'I suddenly remembered his name.',
      serbian: 'Odjednom sam se ___ njegovog imena.',
      imp: 'sećati se', pfv: 'setiti se', answer: 'pfv', fill: 'setio', distractor: 'sećao',
      rule: 'Sudden recollection',
      note: 'A single, instantaneous moment of recall → perfective.' },

    // ── gledati / ogledati  [o-: once through / survey] ──────────
    { english: 'She carefully looked over the contract before signing.',
      serbian: 'Ona je pažljivo ___ ugovor pre potpisivanja.',
      imp: 'gledati', pfv: 'ogledati', answer: 'pfv', fill: 'ogledala', distractor: 'gledala',
      rule: 'Thorough once-through action',
      note: 'o- marks doing something all the way through — examining carefully from start to finish → perfective.' },
    { english: 'He kept looking at the map.',
      serbian: 'On je stalno ___ mapu.',
      imp: 'gledati', pfv: 'ogledati', answer: 'imp', fill: 'gledao', distractor: 'ogledao',
      rule: 'Ongoing / repeated activity',
      note: 'Repeated looking without a defined endpoint → imperfective.' },

    // ── pevati / zapevati  [za-: onset of action] ─────────────────
    { english: 'She suddenly burst into song.',
      serbian: 'Ona je odjednom ___.',
      imp: 'pevati', pfv: 'zapevati', answer: 'pfv', fill: 'zapevala', distractor: 'pevala',
      rule: 'Onset of action',
      note: 'za- marks the beginning of an activity — she started singing at that moment → perfective.' },
    { english: 'She sings at every family gathering.',
      serbian: 'Ona ___ na svakom porodičnom skupu.',
      imp: 'pevati', pfv: 'zapevati', answer: 'imp', fill: 'peva', distractor: 'zapeva',
      rule: 'Habitual action',
      note: 'A repeated occasion — no single start moment → imperfective.' },

    // ── plakati / zaplakati  [za-: onset of action] ───────────────
    { english: 'She burst into tears when she heard the news.',
      serbian: 'Ona je ___ kad je čula vesti.',
      imp: 'plakati', pfv: 'zaplakati', answer: 'pfv', fill: 'zaplakala', distractor: 'plakala',
      rule: 'Onset of action',
      note: 'za- marks the moment crying begins — she suddenly started crying → perfective.' },
    { english: 'The baby cries every night.',
      serbian: 'Beba ___ svake noći.',
      imp: 'plakati', pfv: 'zaplakati', answer: 'imp', fill: 'plače', distractor: 'zaplače',
      rule: 'Habitual action',
      note: 'A repeated nightly occurrence → imperfective.' },

    // ── graditi / izgraditi  [iz-: do something completely] ───────
    { english: 'They are building a new school.',
      serbian: 'Oni ___ novu školu.',
      imp: 'graditi', pfv: 'izgraditi', answer: 'imp', fill: 'grade', distractor: 'izgrade',
      rule: 'Ongoing process',
      note: 'Construction still in progress — no endpoint reached yet → imperfective.' },
    { english: 'They built the whole bridge in one year.',
      serbian: 'Oni su ___ ceo most za godinu dana.',
      imp: 'graditi', pfv: 'izgraditi', answer: 'pfv', fill: 'izgradili', distractor: 'gradili',
      rule: 'Completed construction',
      note: 'iz- implies carrying something through to full completion — the bridge is done → perfective.' },

    // ── govoriti / izgovoriti  [iz-: outward / to completion] ─────
    { english: 'He speaks every sentence slowly.',
      serbian: 'On ___ svaku rečenicu polako.',
      imp: 'govoriti', pfv: 'izgovoriti', answer: 'imp', fill: 'govori', distractor: 'izgovori',
      rule: 'Habitual manner',
      note: 'Describes a consistent speaking style, not a single utterance → imperfective.' },
    { english: 'She pronounced every word clearly.',
      serbian: 'Ona je jasno ___ svaku reč.',
      imp: 'govoriti', pfv: 'izgovoriti', answer: 'pfv', fill: 'izgovorila', distractor: 'govorila',
      rule: 'Completed utterance',
      note: 'iz- marks something spoken outward to completion — every word fully articulated → perfective.' },

    // ── praviti / napraviti  [na-: accumulation / finished result] ─
    { english: 'She makes a cake for every birthday.',
      serbian: 'Ona ___ tortu za svaki rođendan.',
      imp: 'praviti', pfv: 'napraviti', answer: 'imp', fill: 'pravi', distractor: 'napravi',
      rule: 'Habitual action',
      note: 'Regular occasion-based making → imperfective.' },
    { english: 'He made a model airplane.',
      serbian: 'On je ___ maketu aviona.',
      imp: 'praviti', pfv: 'napraviti', answer: 'pfv', fill: 'napravio', distractor: 'pravio',
      rule: 'Completed creation',
      note: 'na- marks effort accumulated to a finished result — the model is complete → perfective.' },

    // ── hodati / prohodati  [pro-: through / entering new state] ──
    { english: 'She walks to work every day.',
      serbian: 'Ona ___ na posao svaki dan.',
      imp: 'hodati', pfv: 'prohodati', answer: 'imp', fill: 'hoda', distractor: 'prohoda',
      rule: 'Habitual action',
      note: 'A regular daily commute → imperfective.' },
    { english: 'The baby finally started walking!',
      serbian: 'Beba je konačno ___!',
      imp: 'hodati', pfv: 'prohodati', answer: 'pfv', fill: 'prohodala', distractor: 'hodala',
      rule: 'Crossing into a new state',
      note: 'pro- can mark achieving something for the first time — entering a new ability → perfective.' },

    // ── leteti / uleteti  [u-: motion into / entering] ───────────
    { english: 'Eagles fly above the mountains.',
      serbian: 'Orlovi ___ iznad planina.',
      imp: 'leteti', pfv: 'uleteti', answer: 'imp', fill: 'lete', distractor: 'ulete',
      rule: 'Ongoing activity',
      note: 'General flight with no specific destination or endpoint → imperfective.' },
    { english: 'A bird flew into the room.',
      serbian: 'Ptica je ___ u sobu.',
      imp: 'leteti', pfv: 'uleteti', answer: 'pfv', fill: 'uletela', distractor: 'letela',
      rule: 'Bounded motion into a space',
      note: 'u- marks entering a defined space — the bird is now inside → perfective.' },

    // ── davati / dati  [irregular: suppletive pair] ───────────────
    { english: 'She gives her children an allowance every week.',
      serbian: 'Ona ___ deci džeparac svake nedelje.',
      imp: 'davati', pfv: 'dati', answer: 'imp', fill: 'daje', distractor: 'da',
      rule: 'Habitual action',
      note: 'Regular weekly giving — davati/dati is a suppletive pair with completely different stems → imperfective.' },
    { english: 'He gave her a book for her birthday.',
      serbian: 'On joj je ___ knjigu za rođendan.',
      imp: 'davati', pfv: 'dati', answer: 'pfv', fill: 'dao', distractor: 'davao',
      rule: 'Completed gift',
      note: 'davati/dati is suppletive (unrelated stems). A single completed act of giving → perfective.' },

    // ── uzimati / uzeti  [irregular: suppletive pair] ─────────────
    { english: 'He takes the bus to work every day.',
      serbian: 'On svaki dan ___ bus za posao.',
      imp: 'uzimati', pfv: 'uzeti', answer: 'imp', fill: 'uzima', distractor: 'uzme',
      rule: 'Habitual action',
      note: 'Daily commuting habit — uzimati/uzeti is suppletive → imperfective.' },
    { english: 'She took the last piece of cake.',
      serbian: 'Ona je ___ poslednji komad torte.',
      imp: 'uzimati', pfv: 'uzeti', answer: 'pfv', fill: 'uzela', distractor: 'uzimala',
      rule: 'Completed action',
      note: 'uzimati/uzeti are suppletive — unrelated stems. Taking one specific piece → perfective.' },

    // ── ustajati / ustati  [u-: entering a new state] ─────────────
    { english: 'He gets up at seven every morning.',
      serbian: 'On ___ u sedam svako jutro.',
      imp: 'ustajati', pfv: 'ustati', answer: 'imp', fill: 'ustaje', distractor: 'ustane',
      rule: 'Habitual action',
      note: 'A regular morning routine → imperfective.' },
    { english: 'She got up and left the room.',
      serbian: 'Ona je ___ i izašla iz sobe.',
      imp: 'ustajati', pfv: 'ustati', answer: 'pfv', fill: 'ustala', distractor: 'ustajala',
      rule: 'Single completed action',
      note: 'u- marks entering a new state — she rose from sitting to standing at that moment → perfective.' },

    // ── hvatati / uhvatiti  [u-: catching / grasping into] ────────
    { english: 'He always tries to catch the ball.',
      serbian: 'On uvek ___ loptu.',
      imp: 'hvatati', pfv: 'uhvatiti', answer: 'imp', fill: 'hvata', distractor: 'uhvati',
      rule: 'Habitual / ongoing attempt',
      note: 'Repeated attempts without guaranteed success → imperfective.' },
    { english: 'She caught the ball perfectly.',
      serbian: 'Ona je savršeno ___ loptu.',
      imp: 'hvatati', pfv: 'uhvatiti', answer: 'pfv', fill: 'uhvatila', distractor: 'hvatala',
      rule: 'Completed successful action',
      note: 'u- marks catching something into one\'s grasp — success achieved → perfective.' },

    // ── sedati / sesti  [irregular: root alternation sed-/ses-] ───
    { english: 'She always sits by the window.',
      serbian: 'Ona uvek ___ pored prozora.',
      imp: 'sedati', pfv: 'sesti', answer: 'imp', fill: 'seda', distractor: 'sedne',
      rule: 'Habitual preference',
      note: 'A repeated seating choice — sedati/sesti have different roots (sed-/ses-) → imperfective.' },
    { english: 'He sat down and opened his laptop.',
      serbian: 'On je ___ i otvorio laptop.',
      imp: 'sedati', pfv: 'sesti', answer: 'pfv', fill: 'seo', distractor: 'sedao',
      rule: 'Single completed action',
      note: 'The act of sitting down at one specific moment — root alternation pair → perfective.' },

    // ── legati / leći  [irregular: root alternation leg-/leć-] ────
    { english: 'He lies down for a nap every afternoon.',
      serbian: 'On ___ da odspava svako popodne.',
      imp: 'legati', pfv: 'leći', answer: 'imp', fill: 'leže', distractor: 'legne',
      rule: 'Habitual routine',
      note: 'Regular afternoon nap habit — legati/leći have different roots (leg-/leć-) → imperfective.' },
    { english: 'She lay down and fell asleep immediately.',
      serbian: 'Ona je ___ i odmah zaspala.',
      imp: 'legati', pfv: 'leći', answer: 'pfv', fill: 'legla', distractor: 'legala',
      rule: 'Single completed action',
      note: 'Lying down at one specific moment — root alternation pair → perfective.' },

    // ── skakati / skočiti  [irregular: suppletive skak-/skoč-] ────
    { english: 'The children jump rope at every recess.',
      serbian: 'Deca ___ konopac na svakom odmoru.',
      imp: 'skakati', pfv: 'skočiti', answer: 'imp', fill: 'skaču', distractor: 'skoče',
      rule: 'Habitual / repeated action',
      note: 'Ongoing jumping activity with no single endpoint — skakati/skočiti have different roots → imperfective.' },
    { english: 'He jumped over the puddle.',
      serbian: 'On je ___ preko lokve.',
      imp: 'skakati', pfv: 'skočiti', answer: 'pfv', fill: 'skočio', distractor: 'skakao',
      rule: 'Single bounded action',
      note: 'One specific jump with a clear start and landing — suppletive pair → perfective.' },

    // ── oblačiti se / obući se  [irregular: suppletive oblač-/obuć-]
    { english: 'She gets dressed quickly every morning.',
      serbian: 'Ona se brzo ___ svako jutro.',
      imp: 'oblačiti se', pfv: 'obući se', answer: 'imp', fill: 'oblači', distractor: 'obuče',
      rule: 'Habitual action',
      note: 'A daily morning routine — oblačiti se/obući se are suppletive (different roots) → imperfective.' },
    { english: 'He got dressed and left the house.',
      serbian: 'On se ___ i izašao iz kuće.',
      imp: 'oblačiti se', pfv: 'obući se', answer: 'pfv', fill: 'obukao', distractor: 'oblačio',
      rule: 'Completed action',
      note: 'Fully dressed at one moment — suppletive pair → perfective.' },

    // ── vikati / viknuti  [irregular: -nu- perfective suffix] ─────
    { english: 'He shouts at his team all the time.',
      serbian: 'On stalno ___ na svoju ekipu.',
      imp: 'vikati', pfv: 'viknuti', answer: 'imp', fill: 'viče', distractor: 'vikne',
      rule: 'Habitual / repeated action',
      note: 'Ongoing shouting pattern — vikati/viknuti use the rare -nu- suffix → imperfective.' },
    { english: 'She shouted his name across the street.',
      serbian: 'Ona je ___ njegovo ime preko ulice.',
      imp: 'vikati', pfv: 'viknuti', answer: 'pfv', fill: 'viknula', distractor: 'vikala',
      rule: 'Single brief shout',
      note: 'One specific shout at one moment — -nu- marks a single perfective event → perfective.' },

    // ── javljati se / javiti se  [irregular: uncommon ja- formation]
    { english: 'She calls home every week.',
      serbian: 'Ona se ___ kući svake nedelje.',
      imp: 'javljati se', pfv: 'javiti se', answer: 'imp', fill: 'javlja', distractor: 'javi',
      rule: 'Habitual action',
      note: 'Regular weekly contact — javljati se/javiti se use an uncommon formation → imperfective.' },
    { english: 'She called to say she had arrived safely.',
      serbian: 'Ona se ___ da je stigla bezbedno.',
      imp: 'javljati se', pfv: 'javiti se', answer: 'pfv', fill: 'javila', distractor: 'javljala',
      rule: 'Single completed call',
      note: 'One specific call at one moment → perfective.' },
  ];

  // ═══════════════════════════════════════════════════
  //  BUILT-IN VERBS
  // ═══════════════════════════════════════════════════
  const VERBS = [
    // ── Group 1: Essential irregulars ─────────────────────────────────────
    {
      infinitive: 'biti', aspect: 'bi', english: 'to be',
      conjugations: {
        present: { ja:'sam',    ti:'si',    on:'je',    mi:'smo',      vi:'ste',      oni:'su'       },
        past:    { ja:'bio sam',ti:'bio si',on:'bio je',mi:'bili smo', vi:'bili ste', oni:'bili su'  },
        future:  { ja:'biću',   ti:'bićeš', on:'biće',  mi:'bićemo',   vi:'bićete',   oni:'biće'     },
      }
    },
    {
      infinitive: 'imati', aspect: 'imp', english: 'to have',
      conjugations: {
        present: { ja:'imam',    ti:'imaš',    on:'ima',    mi:'imamo',    vi:'imate',    oni:'imaju'    },
        past:    { ja:'imao sam',ti:'imao si', on:'imao je',mi:'imali smo',vi:'imali ste',oni:'imali su' },
        future:  { ja:'imaću',   ti:'imaćeš',  on:'imaće',  mi:'imaćemo',  vi:'imaćete',  oni:'imaće'    },
      }
    },
    {
      infinitive: 'ići', aspect: 'imp', english: 'to go',
      conjugations: {
        present: { ja:'idem',     ti:'ideš',     on:'ide',     mi:'idemo',     vi:'idete',     oni:'idu'       },
        past:    { ja:'išao sam', ti:'išao si',  on:'išao je', mi:'išli smo',  vi:'išli ste',  oni:'išli su'   },
        future:  { ja:'ići ću',   ti:'ići ćeš',  on:'ići će',  mi:'ići ćemo',  vi:'ići ćete',  oni:'ići će'    },
      }
    },
    {
      infinitive: 'doći', aspect: 'pfv', english: 'to come',
      conjugations: {
        present: { ja:'dođem',     ti:'dođeš',     on:'dođe',     mi:'dođemo',     vi:'dođete',     oni:'dođu'       },
        past:    { ja:'došao sam', ti:'došao si',  on:'došao je', mi:'došli smo',  vi:'došli ste',  oni:'došli su'   },
        future:  { ja:'doći ću',   ti:'doći ćeš',  on:'doći će',  mi:'doći ćemo',  vi:'doći ćete',  oni:'doći će'    },
      }
    },
    {
      infinitive: 'hteti', aspect: 'imp', english: 'to want',
      conjugations: {
        present: { ja:'hoću',    ti:'hoćeš',   on:'hoće',   mi:'hoćemo',   vi:'hoćete',   oni:'hoće'     },
        past:    { ja:'hteo sam',ti:'hteo si', on:'hteo je',mi:'hteli smo',vi:'hteli ste',oni:'hteli su' },
        future:  { ja:'hteću',   ti:'htećeš',  on:'hteće',  mi:'htećemo',  vi:'htećete',  oni:'hteće'    },
      }
    },
    {
      infinitive: 'moći', aspect: 'imp', english: 'to be able to / can',
      conjugations: {
        present: { ja:'mogu',     ti:'možeš',    on:'može',    mi:'možemo',    vi:'možete',    oni:'mogu'      },
        past:    { ja:'mogao sam',ti:'mogao si', on:'mogao je',mi:'mogli smo', vi:'mogli ste', oni:'mogli su'  },
        future:  { ja:'moći ću',  ti:'moći ćeš', on:'moći će', mi:'moći ćemo', vi:'moći ćete', oni:'moći će'   },
      }
    },
    {
      infinitive: 'znati', aspect: 'imp', english: 'to know',
      conjugations: {
        present: { ja:'znam',    ti:'znaš',    on:'zna',    mi:'znamo',    vi:'znate',    oni:'znaju'    },
        past:    { ja:'znao sam',ti:'znao si', on:'znao je',mi:'znali smo',vi:'znali ste',oni:'znali su' },
        future:  { ja:'znaću',   ti:'znaćeš',  on:'znaće',  mi:'znaćemo',  vi:'znaćete',  oni:'znaće'    },
      }
    },
    {
      infinitive: 'videti', aspect: 'bi', english: 'to see',
      conjugations: {
        present: { ja:'vidim',    ti:'vidiš',    on:'vidi',    mi:'vidimo',    vi:'vidite',    oni:'vide'      },
        past:    { ja:'video sam',ti:'video si', on:'video je',mi:'videli smo',vi:'videli ste',oni:'videli su' },
        future:  { ja:'videću',   ti:'videćeš',  on:'videće',  mi:'videćemo',  vi:'videćete',  oni:'videće'    },
      }
    },
    {
      infinitive: 'jesti', aspect: 'imp', english: 'to eat',
      conjugations: {
        present: { ja:'jedem',   ti:'jedeš',   on:'jede',   mi:'jedemo',   vi:'jedete',   oni:'jedu'     },
        past:    { ja:'jeo sam', ti:'jeo si',  on:'jeo je', mi:'jeli smo', vi:'jeli ste', oni:'jeli su'  },
        future:  { ja:'jesti ću',ti:'jesti ćeš',on:'jesti će',mi:'jesti ćemo',vi:'jesti ćete',oni:'jesti će' },
      }
    },
    {
      infinitive: 'piti', aspect: 'imp', english: 'to drink',
      conjugations: {
        present: { ja:'pijem',   ti:'piješ',   on:'pije',   mi:'pijemo',   vi:'pijete',   oni:'piju'     },
        past:    { ja:'pio sam', ti:'pio si',  on:'pio je', mi:'pili smo', vi:'pili ste', oni:'pili su'  },
        future:  { ja:'piću',    ti:'pićeš',   on:'piće',   mi:'pićemo',   vi:'pićete',   oni:'piće'     },
      }
    },
    {
      infinitive: 'dati', aspect: 'pfv', english: 'to give',
      conjugations: {
        present: { ja:'dam',    ti:'daš',    on:'da',    mi:'damo',    vi:'date',    oni:'daju'    },
        past:    { ja:'dao sam',ti:'dao si', on:'dao je',mi:'dali smo',vi:'dali ste',oni:'dali su' },
        future:  { ja:'daću',   ti:'daćeš',  on:'daće',  mi:'daćemo',  vi:'daćete',  oni:'daće'    },
      }
    },
    {
      infinitive: 'uzeti', aspect: 'pfv', english: 'to take',
      conjugations: {
        present: { ja:'uzmem',    ti:'uzmeš',    on:'uzme',    mi:'uzmemo',    vi:'uzmete',    oni:'uzmu'      },
        past:    { ja:'uzeo sam', ti:'uzeo si',  on:'uzeo je', mi:'uzeli smo', vi:'uzeli ste', oni:'uzeli su'  },
        future:  { ja:'uzeću',    ti:'uzećeš',   on:'uzeće',   mi:'uzećemo',   vi:'uzećete',   oni:'uzeće'     },
      }
    },
    {
      infinitive: 'reći', aspect: 'pfv', english: 'to say / to tell',
      conjugations: {
        present: { ja:'kažem',    ti:'kažeš',    on:'kaže',    mi:'kažemo',    vi:'kažete',    oni:'kažu'      },
        past:    { ja:'rekao sam',ti:'rekao si', on:'rekao je',mi:'rekli smo', vi:'rekli ste', oni:'rekli su'  },
        future:  { ja:'reći ću',  ti:'reći ćeš', on:'reći će', mi:'reći ćemo', vi:'reći ćete', oni:'reći će'   },
      }
    },
    {
      infinitive: 'misliti', aspect: 'imp', english: 'to think',
      conjugations: {
        present: { ja:'mislim',    ti:'misliš',    on:'misli',    mi:'mislimo',    vi:'mislite',    oni:'misle'      },
        past:    { ja:'mislio sam',ti:'mislio si', on:'mislio je',mi:'mislili smo',vi:'mislili ste',oni:'mislili su' },
        future:  { ja:'misliću',   ti:'mislićeš',  on:'misliće',  mi:'mislićemo',  vi:'mislićete',  oni:'misliće'    },
      }
    },
    {
      infinitive: 'čuti', aspect: 'bi', english: 'to hear',
      conjugations: {
        present: { ja:'čujem',   ti:'čuješ',   on:'čuje',   mi:'čujemo',   vi:'čujete',   oni:'čuju'     },
        past:    { ja:'čuo sam', ti:'čuo si',  on:'čuo je', mi:'čuli smo', vi:'čuli ste', oni:'čuli su'  },
        future:  { ja:'čuću',    ti:'čućeš',   on:'čuće',   mi:'čućemo',   vi:'čućete',   oni:'čuće'     },
      }
    },
    {
      infinitive: 'ostati', aspect: 'pfv', english: 'to stay / to remain',
      conjugations: {
        present: { ja:'ostanem',    ti:'ostaneš',    on:'ostane',    mi:'ostanemo',    vi:'ostanete',    oni:'ostanu'      },
        past:    { ja:'ostao sam',  ti:'ostao si',   on:'ostao je',  mi:'ostali smo',  vi:'ostali ste',  oni:'ostali su'   },
        future:  { ja:'ostaću',     ti:'ostaćeš',    on:'ostaće',    mi:'ostaćemo',    vi:'ostaćete',    oni:'ostaće'      },
      }
    },
    {
      infinitive: 'naći', aspect: 'pfv', english: 'to find',
      conjugations: {
        present: { ja:'nađem',    ti:'nađeš',    on:'nađe',    mi:'nađemo',    vi:'nađete',    oni:'nađu'      },
        past:    { ja:'našao sam',ti:'našao si', on:'našao je',mi:'našli smo', vi:'našli ste', oni:'našli su'  },
        future:  { ja:'naći ću',  ti:'naći ćeš', on:'naći će', mi:'naći ćemo', vi:'naći ćete', oni:'naći će'   },
      }
    },
    {
      infinitive: 'otići', aspect: 'pfv', english: 'to leave / to go away',
      conjugations: {
        present: { ja:'otiđem',    ti:'otiđeš',    on:'otiđe',    mi:'otiđemo',    vi:'otiđete',    oni:'otiđu'      },
        past:    { ja:'otišao sam',ti:'otišao si', on:'otišao je',mi:'otišli smo', vi:'otišli ste', oni:'otišli su'  },
        future:  { ja:'otići ću',  ti:'otići ćeš', on:'otići će', mi:'otići ćemo', vi:'otići ćete', oni:'otići će'   },
      }
    },
    {
      infinitive: 'morati', aspect: 'imp', english: 'to have to / must',
      conjugations: {
        present: { ja:'moram',    ti:'moraš',    on:'mora',    mi:'moramo',    vi:'morate',    oni:'moraju'    },
        past:    { ja:'morao sam',ti:'morao si', on:'morao je',mi:'morali smo',vi:'morali ste',oni:'morali su' },
        future:  { ja:'moraću',   ti:'moraćeš',  on:'moraće',  mi:'moraćemo',  vi:'moraćete',  oni:'moraće'    },
      }
    },
    {
      infinitive: 'trebati', aspect: 'imp', english: 'to need / to be needed',
      conjugations: {
        present: { ja:'trebam',    ti:'trebaš',    on:'treba',    mi:'trebamo',    vi:'trebate',    oni:'trebaju'    },
        past:    { ja:'trebao sam',ti:'trebao si', on:'trebao je',mi:'trebali smo',vi:'trebali ste',oni:'trebali su' },
        future:  { ja:'trebaću',   ti:'trebaćeš',  on:'trebaće',  mi:'trebaćemo',  vi:'trebaćete',  oni:'trebaće'    },
      }
    },
    // ── Group 2: -ati verbs ────────────────────────────────────────────────
    {
      infinitive: 'raditi', aspect: 'imp', english: 'to work / to do',
      conjugations: {
        present: { ja:'radim',    ti:'radiš',    on:'radi',    mi:'radimo',    vi:'radite',    oni:'rade'      },
        past:    { ja:'radio sam',ti:'radio si', on:'radio je',mi:'radili smo',vi:'radili ste',oni:'radili su' },
        future:  { ja:'radiću',   ti:'radićeš',  on:'radiće',  mi:'radićemo',  vi:'radićete',  oni:'radiće'    },
      }
    },
    {
      infinitive: 'čitati', aspect: 'imp', english: 'to read',
      conjugations: {
        present: { ja:'čitam',    ti:'čitaš',    on:'čita',    mi:'čitamo',    vi:'čitate',    oni:'čitaju'    },
        past:    { ja:'čitao sam',ti:'čitao si', on:'čitao je',mi:'čitali smo',vi:'čitali ste',oni:'čitali su' },
        future:  { ja:'čitaću',   ti:'čitaćeš',  on:'čitaće',  mi:'čitaćemo',  vi:'čitaćete',  oni:'čitaće'    },
      }
    },
    {
      infinitive: 'pisati', aspect: 'imp', english: 'to write',
      conjugations: {
        present: { ja:'pišem',    ti:'pišeš',    on:'piše',    mi:'pišemo',    vi:'pišete',    oni:'pišu'      },
        past:    { ja:'pisao sam',ti:'pisao si', on:'pisao je',mi:'pisali smo',vi:'pisali ste',oni:'pisali su' },
        future:  { ja:'pisaću',   ti:'pisaćeš',  on:'pisaće',  mi:'pisaćemo',  vi:'pisaćete',  oni:'pisaće'    },
      }
    },
    {
      infinitive: 'gledati', aspect: 'imp', english: 'to watch / to look',
      conjugations: {
        present: { ja:'gledam',    ti:'gledaš',    on:'gleda',    mi:'gledamo',    vi:'gledate',    oni:'gledaju'    },
        past:    { ja:'gledao sam',ti:'gledao si', on:'gledao je',mi:'gledali smo',vi:'gledali ste',oni:'gledali su' },
        future:  { ja:'gledaću',   ti:'gledaćeš',  on:'gledaće',  mi:'gledaćemo',  vi:'gledaćete',  oni:'gledaće'    },
      }
    },
    {
      infinitive: 'slušati', aspect: 'imp', english: 'to listen',
      conjugations: {
        present: { ja:'slušam',    ti:'slušaš',    on:'sluša',    mi:'slušamo',    vi:'slušate',    oni:'slušaju'    },
        past:    { ja:'slušao sam',ti:'slušao si', on:'slušao je',mi:'slušali smo',vi:'slušali ste',oni:'slušali su' },
        future:  { ja:'slušaću',   ti:'slušaćeš',  on:'slušaće',  mi:'slušaćemo',  vi:'slušaćete',  oni:'slušaće'    },
      }
    },
    {
      infinitive: 'igrati', aspect: 'imp', english: 'to play (sport/game)',
      conjugations: {
        present: { ja:'igram',    ti:'igraš',    on:'igra',    mi:'igramo',    vi:'igrate',    oni:'igraju'    },
        past:    { ja:'igrao sam',ti:'igrao si', on:'igrao je',mi:'igrali smo',vi:'igrali ste',oni:'igrali su' },
        future:  { ja:'igraću',   ti:'igraćeš',  on:'igraće',  mi:'igraćemo',  vi:'igraćete',  oni:'igraće'    },
      }
    },
    {
      infinitive: 'pričati', aspect: 'imp', english: 'to talk / to tell',
      conjugations: {
        present: { ja:'pričam',    ti:'pričaš',    on:'priča',    mi:'pričamo',    vi:'pričate',    oni:'pričaju'    },
        past:    { ja:'pričao sam',ti:'pričao si', on:'pričao je',mi:'pričali smo',vi:'pričali ste',oni:'pričali su' },
        future:  { ja:'pričaću',   ti:'pričaćeš',  on:'pričaće',  mi:'pričaćemo',  vi:'pričaćete',  oni:'pričaće'    },
      }
    },
    {
      infinitive: 'pevati', aspect: 'imp', english: 'to sing',
      conjugations: {
        present: { ja:'pevam',    ti:'pevaš',    on:'peva',    mi:'pevamo',    vi:'pevate',    oni:'pevaju'    },
        past:    { ja:'pevao sam',ti:'pevao si', on:'pevao je',mi:'pevali smo',vi:'pevali ste',oni:'pevali su' },
        future:  { ja:'pevaću',   ti:'pevaćeš',  on:'pevaće',  mi:'pevaćemo',  vi:'pevaćete',  oni:'pevaće'    },
      }
    },
    {
      infinitive: 'spavati', aspect: 'imp', english: 'to sleep',
      conjugations: {
        present: { ja:'spavam',    ti:'spavaš',    on:'spava',    mi:'spavamo',    vi:'spavate',    oni:'spavaju'    },
        past:    { ja:'spavao sam',ti:'spavao si', on:'spavao je',mi:'spavali smo',vi:'spavali ste',oni:'spavali su' },
        future:  { ja:'spavaću',   ti:'spavaćeš',  on:'spavaće',  mi:'spavaćemo',  vi:'spavaćete',  oni:'spavaće'    },
      }
    },
    {
      infinitive: 'pitati', aspect: 'imp', english: 'to ask',
      conjugations: {
        present: { ja:'pitam',    ti:'pitaš',    on:'pita',    mi:'pitamo',    vi:'pitate',    oni:'pitaju'    },
        past:    { ja:'pitao sam',ti:'pitao si', on:'pitao je',mi:'pitali smo',vi:'pitali ste',oni:'pitali su' },
        future:  { ja:'pitaću',   ti:'pitaćeš',  on:'pitaće',  mi:'pitaćemo',  vi:'pitaćete',  oni:'pitaće'    },
      }
    },
    {
      infinitive: 'kuvati', aspect: 'imp', english: 'to cook',
      conjugations: {
        present: { ja:'kuvam',    ti:'kuvaš',    on:'kuva',    mi:'kuvamo',    vi:'kuvate',    oni:'kuvaju'    },
        past:    { ja:'kuvao sam',ti:'kuvao si', on:'kuvao je',mi:'kuvali smo',vi:'kuvali ste',oni:'kuvali su' },
        future:  { ja:'kuvaću',   ti:'kuvaćeš',  on:'kuvaće',  mi:'kuvaćemo',  vi:'kuvaćete',  oni:'kuvaće'    },
      }
    },
    {
      infinitive: 'čekati', aspect: 'imp', english: 'to wait',
      conjugations: {
        present: { ja:'čekam',    ti:'čekaš',    on:'čeka',    mi:'čekamo',    vi:'čekate',    oni:'čekaju'    },
        past:    { ja:'čekao sam',ti:'čekao si', on:'čekao je',mi:'čekali smo',vi:'čekali ste',oni:'čekali su' },
        future:  { ja:'čekaću',   ti:'čekaćeš',  on:'čekaće',  mi:'čekaćemo',  vi:'čekaćete',  oni:'čekaće'    },
      }
    },
    {
      infinitive: 'plivati', aspect: 'imp', english: 'to swim',
      conjugations: {
        present: { ja:'plivam',    ti:'plivaš',    on:'pliva',    mi:'plivamo',    vi:'plivate',    oni:'plivaju'    },
        past:    { ja:'plivao sam',ti:'plivao si', on:'plivao je',mi:'plivali smo',vi:'plivali ste',oni:'plivali su' },
        future:  { ja:'plivaću',   ti:'plivaćeš',  on:'plivaće',  mi:'plivaćemo',  vi:'plivaćete',  oni:'plivaće'    },
      }
    },
    {
      infinitive: 'šetati', aspect: 'imp', english: 'to walk / to stroll',
      conjugations: {
        present: { ja:'šetam',    ti:'šetaš',    on:'šeta',    mi:'šetamo',    vi:'šetate',    oni:'šetaju'    },
        past:    { ja:'šetao sam',ti:'šetao si', on:'šetao je',mi:'šetali smo',vi:'šetali ste',oni:'šetali su' },
        future:  { ja:'šetaću',   ti:'šetaćeš',  on:'šetaće',  mi:'šetaćemo',  vi:'šetaćete',  oni:'šetaće'    },
      }
    },
    {
      infinitive: 'crtati', aspect: 'imp', english: 'to draw',
      conjugations: {
        present: { ja:'crtam',    ti:'crtaš',    on:'crta',    mi:'crtamo',    vi:'crtate',    oni:'crtaju'    },
        past:    { ja:'crtao sam',ti:'crtao si', on:'crtao je',mi:'crtali smo',vi:'crtali ste',oni:'crtali su' },
        future:  { ja:'crtaću',   ti:'crtaćeš',  on:'crtaće',  mi:'crtaćemo',  vi:'crtaćete',  oni:'crtaće'    },
      }
    },
    {
      infinitive: 'mešati', aspect: 'imp', english: 'to mix / to stir',
      conjugations: {
        present: { ja:'mešam',    ti:'mešaš',    on:'meša',    mi:'mešamo',    vi:'mešate',    oni:'mešaju'    },
        past:    { ja:'mešao sam',ti:'mešao si', on:'mešao je',mi:'mešali smo',vi:'mešali ste',oni:'mešali su' },
        future:  { ja:'mešaću',   ti:'mešaćeš',  on:'mešaće',  mi:'mešaćemo',  vi:'mešaćete',  oni:'mešaće'    },
      }
    },
    {
      infinitive: 'birati', aspect: 'imp', english: 'to choose / to select',
      conjugations: {
        present: { ja:'biram',    ti:'biraš',    on:'bira',    mi:'biramo',    vi:'birate',    oni:'biraju'    },
        past:    { ja:'birao sam',ti:'birao si', on:'birao je',mi:'birali smo',vi:'birali ste',oni:'birali su' },
        future:  { ja:'biraću',   ti:'biraćeš',  on:'biraće',  mi:'biraćemo',  vi:'biraćete',  oni:'biraće'    },
      }
    },
    {
      infinitive: 'ručati', aspect: 'imp', english: 'to have lunch',
      conjugations: {
        present: { ja:'ručam',    ti:'ručaš',    on:'ruča',    mi:'ručamo',    vi:'ručate',    oni:'ručaju'    },
        past:    { ja:'ručao sam',ti:'ručao si', on:'ručao je',mi:'ručali smo',vi:'ručali ste',oni:'ručali su' },
        future:  { ja:'ručaću',   ti:'ručaćeš',  on:'ručaće',  mi:'ručaćemo',  vi:'ručaćete',  oni:'ručaće'    },
      }
    },
    {
      infinitive: 'večerati', aspect: 'imp', english: 'to have dinner',
      conjugations: {
        present: { ja:'večeram',    ti:'večeraš',    on:'večera',    mi:'večeramo',    vi:'večerate',    oni:'večeraju'    },
        past:    { ja:'večerao sam',ti:'večerao si', on:'večerao je',mi:'večerali smo',vi:'večerali ste',oni:'večerali su' },
        future:  { ja:'večeraću',   ti:'večeraćeš',  on:'večeraće',  mi:'večeraćemo',  vi:'večeraćete',  oni:'večeraće'    },
      }
    },
    {
      infinitive: 'vraćati', aspect: 'imp', english: 'to return (frequently)',
      conjugations: {
        present: { ja:'vraćam',    ti:'vraćaš',    on:'vraća',    mi:'vraćamo',    vi:'vraćate',    oni:'vraćaju'    },
        past:    { ja:'vraćao sam',ti:'vraćao si', on:'vraćao je',mi:'vraćali smo',vi:'vraćali ste',oni:'vraćali su' },
        future:  { ja:'vraćaću',   ti:'vraćaćeš',  on:'vraćaće',  mi:'vraćaćemo',  vi:'vraćaćete',  oni:'vraćaće'    },
      }
    },
    {
      infinitive: 'plaćati', aspect: 'imp', english: 'to pay',
      conjugations: {
        present: { ja:'plaćam',    ti:'plaćaš',    on:'plaća',    mi:'plaćamo',    vi:'plaćate',    oni:'plaćaju'    },
        past:    { ja:'plaćao sam',ti:'plaćao si', on:'plaćao je',mi:'plaćali smo',vi:'plaćali ste',oni:'plaćali su' },
        future:  { ja:'plaćaću',   ti:'plaćaćeš',  on:'plaćaće',  mi:'plaćaćemo',  vi:'plaćaćete',  oni:'plaćaće'    },
      }
    },
    {
      infinitive: 'skakati', aspect: 'imp', english: 'to jump',
      conjugations: {
        present: { ja:'skačem',    ti:'skačeš',    on:'skače',    mi:'skačemo',    vi:'skačete',    oni:'skaču'      },
        past:    { ja:'skakao sam',ti:'skakao si', on:'skakao je',mi:'skakali smo',vi:'skakali ste',oni:'skakali su' },
        future:  { ja:'skakaću',   ti:'skakaćeš',  on:'skakaće',  mi:'skakaćemo',  vi:'skakaćete',  oni:'skakaće'    },
      }
    },
    {
      infinitive: 'vikati', aspect: 'imp', english: 'to shout / to yell',
      conjugations: {
        present: { ja:'vičem',    ti:'vičeš',    on:'viče',    mi:'vičemo',    vi:'vičete',    oni:'viču'      },
        past:    { ja:'vikao sam',ti:'vikao si', on:'vikao je',mi:'vikali smo',vi:'vikali ste',oni:'vikali su' },
        future:  { ja:'vikaću',   ti:'vikaćeš',  on:'vikaće',  mi:'vikaćemo',  vi:'vikaćete',  oni:'vikaće'    },
      }
    },
    {
      infinitive: 'tražiti', aspect: 'imp', english: 'to look for / to ask for',
      conjugations: {
        present: { ja:'tražim',    ti:'tražiš',    on:'traži',    mi:'tražimo',    vi:'tražite',    oni:'traže'      },
        past:    { ja:'tražio sam',ti:'tražio si', on:'tražio je',mi:'tražili smo',vi:'tražili ste',oni:'tražili su' },
        future:  { ja:'tražiću',   ti:'tražićeš',  on:'tražiće',  mi:'tražićemo',  vi:'tražićete',  oni:'tražiće'    },
      }
    },
    {
      infinitive: 'brisati', aspect: 'imp', english: 'to wipe / to erase',
      conjugations: {
        present: { ja:'brišem',    ti:'brišeš',    on:'briše',    mi:'brišemo',    vi:'brišete',    oni:'brišu'      },
        past:    { ja:'brisao sam',ti:'brisao si', on:'brisao je',mi:'brisali smo',vi:'brisali ste',oni:'brisali su' },
        future:  { ja:'brisaću',   ti:'brisaćeš',  on:'brisaće',  mi:'brisaćemo',  vi:'brisaćete',  oni:'brisaće'    },
      }
    },
    {
      infinitive: 'razgovarati', aspect: 'imp', english: 'to converse / to chat',
      conjugations: {
        present: { ja:'razgovaram',    ti:'razgovaraš',    on:'razgovara',    mi:'razgovaramo',    vi:'razgovarate',    oni:'razgovaraju'    },
        past:    { ja:'razgovarao sam',ti:'razgovarao si', on:'razgovarao je',mi:'razgovarali smo',vi:'razgovarali ste',oni:'razgovarali su' },
        future:  { ja:'razgovaraću',   ti:'razgovaraćeš',  on:'razgovaraće',  mi:'razgovaraćemo',  vi:'razgovaraćete',  oni:'razgovaraće'    },
      }
    },
    // ── Group 3: -iti / -eti / -ati (pres: -im/-iš) verbs ─────────────────
    {
      infinitive: 'govoriti', aspect: 'imp', english: 'to speak / to say',
      conjugations: {
        present: { ja:'govorim',    ti:'govoriš',    on:'govori',    mi:'govorimo',    vi:'govorite',    oni:'govore'      },
        past:    { ja:'govorio sam',ti:'govorio si', on:'govorio je',mi:'govorili smo',vi:'govorili ste',oni:'govorili su' },
        future:  { ja:'govoriću',   ti:'govorićeš',  on:'govoriće',  mi:'govorićemo',  vi:'govorićete',  oni:'govoriće'    },
      }
    },
    {
      infinitive: 'živeti', aspect: 'imp', english: 'to live',
      conjugations: {
        present: { ja:'živim',    ti:'živiš',    on:'živi',    mi:'živimo',    vi:'živite',    oni:'žive'      },
        past:    { ja:'živeo sam',ti:'živeo si', on:'živeo je',mi:'živeli smo',vi:'živeli ste',oni:'živeli su' },
        future:  { ja:'živeću',   ti:'živećeš',  on:'živeće',  mi:'živećemo',  vi:'živećete',  oni:'živeće'    },
      }
    },
    {
      infinitive: 'voleti', aspect: 'imp', english: 'to love / to like',
      conjugations: {
        present: { ja:'volim',    ti:'voliš',    on:'voli',    mi:'volimo',    vi:'volite',    oni:'vole'      },
        past:    { ja:'voleo sam',ti:'voleo si', on:'voleo je',mi:'voleli smo',vi:'voleli ste',oni:'voleli su' },
        future:  { ja:'voleću',   ti:'volećeš',  on:'voleće',  mi:'volećemo',  vi:'volećete',  oni:'voleće'    },
      }
    },
    {
      infinitive: 'razumeti', aspect: 'imp', english: 'to understand',
      conjugations: {
        present: { ja:'razumem',    ti:'razumeš',    on:'razume',    mi:'razumemo',    vi:'razumete',    oni:'razumeju'    },
        past:    { ja:'razumeo sam',ti:'razumeo si', on:'razumeo je',mi:'razumeli smo',vi:'razumeli ste',oni:'razumeli su' },
        future:  { ja:'razumeću',   ti:'razumećeš',  on:'razumeće',  mi:'razumećemo',  vi:'razumećete',  oni:'razumeće'    },
      }
    },
    {
      infinitive: 'nositi', aspect: 'imp', english: 'to carry / to wear',
      conjugations: {
        present: { ja:'nosim',    ti:'nosiš',    on:'nosi',    mi:'nosimo',    vi:'nosite',    oni:'nose'      },
        past:    { ja:'nosio sam',ti:'nosio si', on:'nosio je',mi:'nosili smo',vi:'nosili ste',oni:'nosili su' },
        future:  { ja:'nosiću',   ti:'nosićeš',  on:'nosiće',  mi:'nosićemo',  vi:'nosićete',  oni:'nosiće'    },
      }
    },
    {
      infinitive: 'voziti', aspect: 'imp', english: 'to drive',
      conjugations: {
        present: { ja:'vozim',    ti:'voziš',    on:'vozi',    mi:'vozimo',    vi:'vozite',    oni:'voze'      },
        past:    { ja:'vozio sam',ti:'vozio si', on:'vozio je',mi:'vozili smo',vi:'vozili ste',oni:'vozili su' },
        future:  { ja:'voziću',   ti:'vozićeš',  on:'voziće',  mi:'vozićemo',  vi:'vozićete',  oni:'voziće'    },
      }
    },
    {
      infinitive: 'staviti', aspect: 'pfv', english: 'to put / to place',
      conjugations: {
        present: { ja:'stavim',    ti:'staviš',    on:'stavi',    mi:'stavimo',    vi:'stavite',    oni:'stave'      },
        past:    { ja:'stavio sam',ti:'stavio si', on:'stavio je',mi:'stavili smo',vi:'stavili ste',oni:'stavili su' },
        future:  { ja:'staviću',   ti:'stavićeš',  on:'staviće',  mi:'stavićemo',  vi:'stavićete',  oni:'staviće'    },
      }
    },
    {
      infinitive: 'platiti', aspect: 'pfv', english: 'to pay (once)',
      conjugations: {
        present: { ja:'platim',    ti:'platiš',    on:'plati',    mi:'platimo',    vi:'platite',    oni:'plate'      },
        past:    { ja:'platio sam',ti:'platio si', on:'platio je',mi:'platili smo',vi:'platili ste',oni:'platili su' },
        future:  { ja:'platiću',   ti:'platićeš',  on:'platiće',  mi:'platićemo',  vi:'platićete',  oni:'platiće'    },
      }
    },
    {
      infinitive: 'kupiti', aspect: 'pfv', english: 'to buy (once)',
      conjugations: {
        present: { ja:'kupim',    ti:'kupiš',    on:'kupi',    mi:'kupimo',    vi:'kupite',    oni:'kupe'      },
        past:    { ja:'kupio sam',ti:'kupio si', on:'kupio je',mi:'kupili smo',vi:'kupili ste',oni:'kupili su' },
        future:  { ja:'kupiću',   ti:'kupićeš',  on:'kupiće',  mi:'kupićemo',  vi:'kupićete',  oni:'kupiće'    },
      }
    },
    {
      infinitive: 'pušiti', aspect: 'imp', english: 'to smoke',
      conjugations: {
        present: { ja:'pušim',    ti:'pušiš',    on:'puši',    mi:'pušimo',    vi:'pušite',    oni:'puše'      },
        past:    { ja:'pušio sam',ti:'pušio si', on:'pušio je',mi:'pušili smo',vi:'pušili ste',oni:'pušili su' },
        future:  { ja:'pušiću',   ti:'pušićeš',  on:'pušiće',  mi:'pušićemo',  vi:'pušićete',  oni:'pušiće'    },
      }
    },
    {
      infinitive: 'zaboraviti', aspect: 'pfv', english: 'to forget',
      conjugations: {
        present: { ja:'zaboravim',    ti:'zaboraviš',    on:'zaboravi',    mi:'zaboravimo',    vi:'zaboravite',    oni:'zaborave'      },
        past:    { ja:'zaboravio sam',ti:'zaboravio si', on:'zaboravio je',mi:'zaboravili smo',vi:'zaboravili ste',oni:'zaboravili su' },
        future:  { ja:'zaboraviću',   ti:'zaboravićeš',  on:'zaboraviće',  mi:'zaboravićemo',  vi:'zaboravićete',  oni:'zaboraviće'    },
      }
    },
    {
      infinitive: 'sedeti', aspect: 'imp', english: 'to sit',
      conjugations: {
        present: { ja:'sedim',    ti:'sediš',    on:'sedi',    mi:'sedimo',    vi:'sedite',    oni:'sede'      },
        past:    { ja:'sedeo sam',ti:'sedeo si', on:'sedeo je',mi:'sedeli smo',vi:'sedeli ste',oni:'sedeli su' },
        future:  { ja:'sedeću',   ti:'sedećeš',  on:'sedeće',  mi:'sedećemo',  vi:'sedećete',  oni:'sedeće'    },
      }
    },
    {
      infinitive: 'stajati', aspect: 'imp', english: 'to stand',
      conjugations: {
        present: { ja:'stojim',    ti:'stojiš',    on:'stoji',    mi:'stojimo',    vi:'stojite',    oni:'stoje'      },
        past:    { ja:'stajao sam',ti:'stajao si', on:'stajao je',mi:'stajali smo',vi:'stajali ste',oni:'stajali su' },
        future:  { ja:'stajati ću',ti:'stajati ćeš',on:'stajati će',mi:'stajati ćemo',vi:'stajati ćete',oni:'stajati će' },
      }
    },
    {
      infinitive: 'ležati', aspect: 'imp', english: 'to lie down',
      conjugations: {
        present: { ja:'ležim',    ti:'ležiš',    on:'leži',    mi:'ležimo',    vi:'ležite',    oni:'leže'      },
        past:    { ja:'ležao sam',ti:'ležao si', on:'ležao je',mi:'ležali smo',vi:'ležali ste',oni:'ležali su' },
        future:  { ja:'ležati ću',ti:'ležati ćeš',on:'ležati će',mi:'ležati ćemo',vi:'ležati ćete',oni:'ležati će' },
      }
    },
    {
      infinitive: 'trčati', aspect: 'imp', english: 'to run',
      conjugations: {
        present: { ja:'trčim',    ti:'trčiš',    on:'trči',    mi:'trčimo',    vi:'trčite',    oni:'trče'      },
        past:    { ja:'trčao sam',ti:'trčao si', on:'trčao je',mi:'trčali smo',vi:'trčali ste',oni:'trčali su' },
        future:  { ja:'trčati ću',ti:'trčati ćeš',on:'trčati će',mi:'trčati ćemo',vi:'trčati ćete',oni:'trčati će' },
      }
    },
    {
      infinitive: 'leteti', aspect: 'imp', english: 'to fly',
      conjugations: {
        present: { ja:'letim',    ti:'letiš',    on:'leti',    mi:'letimo',    vi:'letite',    oni:'lete'      },
        past:    { ja:'leteo sam',ti:'leteo si', on:'leteo je',mi:'leteli smo',vi:'leteli ste',oni:'leteli su' },
        future:  { ja:'leteću',   ti:'letećeš',  on:'leteće',  mi:'letećemo',  vi:'letećete',  oni:'leteće'    },
      }
    },
    {
      infinitive: 'učiti', aspect: 'imp', english: 'to learn / to study',
      conjugations: {
        present: { ja:'učim',    ti:'učiš',    on:'uči',    mi:'učimo',    vi:'učite',    oni:'uče'      },
        past:    { ja:'učio sam',ti:'učio si', on:'učio je',mi:'učili smo',vi:'učili ste',oni:'učili su' },
        future:  { ja:'učiću',   ti:'učićeš',  on:'učiće',  mi:'učićemo',  vi:'učićete',  oni:'učiće'    },
      }
    },
    {
      infinitive: 'odgovoriti', aspect: 'pfv', english: 'to answer / to reply',
      conjugations: {
        present: { ja:'odgovorim',    ti:'odgovoriš',    on:'odgovori',    mi:'odgovorimo',    vi:'odgovorite',    oni:'odgovore'      },
        past:    { ja:'odgovorio sam',ti:'odgovorio si', on:'odgovorio je',mi:'odgovorili smo',vi:'odgovorili ste',oni:'odgovorili su' },
        future:  { ja:'odgovoriću',   ti:'odgovorićeš',  on:'odgovoriće',  mi:'odgovorićemo',  vi:'odgovorićete',  oni:'odgovoriće'    },
      }
    },
    {
      infinitive: 'pomoći', aspect: 'pfv', english: 'to help',
      conjugations: {
        present: { ja:'pomognem',    ti:'pomogneš',    on:'pomogne',    mi:'pomognemo',    vi:'pomognete',    oni:'pomognu'      },
        past:    { ja:'pomogao sam', ti:'pomogao si',  on:'pomogao je', mi:'pomogli smo',  vi:'pomogli ste',  oni:'pomogli su'   },
        future:  { ja:'pomoći ću',   ti:'pomoći ćeš',  on:'pomoći će',  mi:'pomoći ćemo',  vi:'pomoći ćete',  oni:'pomoći će'    },
      }
    },
    {
      infinitive: 'vratiti', aspect: 'pfv', english: 'to return (something)',
      conjugations: {
        present: { ja:'vratim',    ti:'vratiš',    on:'vrati',    mi:'vratimo',    vi:'vratite',    oni:'vrate'      },
        past:    { ja:'vratio sam',ti:'vratio si', on:'vratio je',mi:'vratili smo',vi:'vratili ste',oni:'vratili su' },
        future:  { ja:'vratiću',   ti:'vratićeš',  on:'vratiće',  mi:'vratićemo',  vi:'vratićete',  oni:'vratiće'    },
      }
    },
    {
      infinitive: 'otvoriti', aspect: 'pfv', english: 'to open',
      conjugations: {
        present: { ja:'otvorim',    ti:'otvoriš',    on:'otvori',    mi:'otvorimo',    vi:'otvorite',    oni:'otvore'      },
        past:    { ja:'otvorio sam',ti:'otvorio si', on:'otvorio je',mi:'otvorili smo',vi:'otvorili ste',oni:'otvorili su' },
        future:  { ja:'otvoriću',   ti:'otvorićeš',  on:'otvoriće',  mi:'otvorićemo',  vi:'otvorićete',  oni:'otvoriće'    },
      }
    },
    {
      infinitive: 'zatvoriti', aspect: 'pfv', english: 'to close',
      conjugations: {
        present: { ja:'zatvorim',    ti:'zatvoriš',    on:'zatvori',    mi:'zatvorimo',    vi:'zatvorite',    oni:'zatvore'      },
        past:    { ja:'zatvorio sam',ti:'zatvorio si', on:'zatvorio je',mi:'zatvorili smo',vi:'zatvorili ste',oni:'zatvorili su' },
        future:  { ja:'zatvoriću',   ti:'zatvorićeš',  on:'zatvoriće',  mi:'zatvorićemo',  vi:'zatvorićete',  oni:'zatvoriće'    },
      }
    },
    {
      infinitive: 'posetiti', aspect: 'pfv', english: 'to visit',
      conjugations: {
        present: { ja:'posetim',    ti:'posetiš',    on:'poseti',    mi:'posetimo',    vi:'posetite',    oni:'posete'      },
        past:    { ja:'posetio sam',ti:'posetio si', on:'posetio je',mi:'posetili smo',vi:'posetili ste',oni:'posetili su' },
        future:  { ja:'posetiću',   ti:'posetićeš',  on:'posetiće',  mi:'posetićemo',  vi:'posetićete',  oni:'posetiće'    },
      }
    },
    {
      infinitive: 'poznavati', aspect: 'imp', english: 'to know (a person)',
      conjugations: {
        present: { ja:'poznajem',    ti:'poznaješ',    on:'poznaje',    mi:'poznajemo',    vi:'poznajete',    oni:'poznaju'    },
        past:    { ja:'poznavao sam',ti:'poznavao si', on:'poznavao je',mi:'poznavali smo',vi:'poznavali ste',oni:'poznavali su' },
        future:  { ja:'poznaću',     ti:'poznaćeš',    on:'poznaće',    mi:'poznaćemo',    vi:'poznaćete',    oni:'poznaće'    },
      }
    },
    // ── Group 4: -ovati / -avati verbs ────────────────────────────────────
    {
      infinitive: 'putovati', aspect: 'imp', english: 'to travel',
      conjugations: {
        present: { ja:'putujem',    ti:'putuješ',    on:'putuje',    mi:'putujemo',    vi:'putujete',    oni:'putuju'      },
        past:    { ja:'putovao sam',ti:'putovao si', on:'putovao je',mi:'putovali smo',vi:'putovali ste',oni:'putovali su' },
        future:  { ja:'putovaću',   ti:'putovaćeš',  on:'putovaće',  mi:'putovaćemo',  vi:'putovaćete',  oni:'putovaće'    },
      }
    },
    {
      infinitive: 'kupovati', aspect: 'imp', english: 'to shop / to buy (repeatedly)',
      conjugations: {
        present: { ja:'kupujem',    ti:'kupuješ',    on:'kupuje',    mi:'kupujemo',    vi:'kupujete',    oni:'kupuju'      },
        past:    { ja:'kupovao sam',ti:'kupovao si', on:'kupovao je',mi:'kupovali smo',vi:'kupovali ste',oni:'kupovali su' },
        future:  { ja:'kupovaću',   ti:'kupovaćeš',  on:'kupovaće',  mi:'kupovaćemo',  vi:'kupovaćete',  oni:'kupovaće'    },
      }
    },
    {
      infinitive: 'pokazivati', aspect: 'imp', english: 'to show (repeatedly)',
      conjugations: {
        present: { ja:'pokazujem',    ti:'pokazuješ',    on:'pokazuje',    mi:'pokazujemo',    vi:'pokazujete',    oni:'pokazuju'      },
        past:    { ja:'pokazivao sam',ti:'pokazivao si', on:'pokazivao je',mi:'pokazivali smo',vi:'pokazivali ste',oni:'pokazivali su' },
        future:  { ja:'pokazivaću',   ti:'pokazivaćeš',  on:'pokazivaće',  mi:'pokazivaćemo',  vi:'pokazivaćete',  oni:'pokazivaće'    },
      }
    },
    {
      infinitive: 'rokovati', aspect: 'imp', english: 'to schedule / to set a date',
      conjugations: {
        present: { ja:'rokujem',    ti:'rokuješ',    on:'rokuje',    mi:'rokujemo',    vi:'rokujete',    oni:'rokuju'      },
        past:    { ja:'rokovao sam',ti:'rokovao si', on:'rokovao je',mi:'rokovali smo',vi:'rokovali ste',oni:'rokovali su' },
        future:  { ja:'rokovaću',   ti:'rokovaćeš',  on:'rokovaće',  mi:'rokovaćemo',  vi:'rokovaćete',  oni:'rokovaće'    },
      }
    },
    {
      infinitive: 'radovati se', aspect: 'imp', english: 'to be glad / to look forward',
      conjugations: {
        present: { ja:'radujem se',    ti:'raduješ se',    on:'raduje se',    mi:'radujemo se',    vi:'radujete se',    oni:'raduju se'      },
        past:    { ja:'radovao sam se',ti:'radovao si se', on:'radovao se je',mi:'radovali smo se',vi:'radovali ste se',oni:'radovali su se' },
        future:  { ja:'radovaću se',   ti:'radovaćeš se',  on:'radovaće se',  mi:'radovaćemo se',  vi:'radovaćete se',  oni:'radovaće se'    },
      }
    },
    {
      infinitive: 'verovati', aspect: 'imp', english: 'to believe',
      conjugations: {
        present: { ja:'verujem',    ti:'veruješ',    on:'veruje',    mi:'verujemo',    vi:'verujete',    oni:'veruju'      },
        past:    { ja:'verovao sam',ti:'verovao si', on:'verovao je',mi:'verovali smo',vi:'verovali ste',oni:'verovali su' },
        future:  { ja:'verovaću',   ti:'verovaćeš',  on:'verovaće',  mi:'verovaćemo',  vi:'verovaćete',  oni:'verovaće'    },
      }
    },
    {
      infinitive: 'razvijati', aspect: 'imp', english: 'to develop',
      conjugations: {
        present: { ja:'razvijam',    ti:'razvijaš',    on:'razvija',    mi:'razvijamo',    vi:'razvijate',    oni:'razvijaju'    },
        past:    { ja:'razvijao sam',ti:'razvijao si', on:'razvijao je',mi:'razvijali smo',vi:'razvijali ste',oni:'razvijali su' },
        future:  { ja:'razvijaću',   ti:'razvijaćeš',  on:'razvijaće',  mi:'razvijaćemo',  vi:'razvijaćete',  oni:'razvijaće'    },
      }
    },
    {
      infinitive: 'objašnjavati', aspect: 'imp', english: 'to explain (repeatedly)',
      conjugations: {
        present: { ja:'objašnjavam',    ti:'objašnjavaš',    on:'objašnjava',    mi:'objašnjavamo',    vi:'objašnjavate',    oni:'objašnjavaju'    },
        past:    { ja:'objašnjavao sam',ti:'objašnjavao si', on:'objašnjavao je',mi:'objašnjavali smo',vi:'objašnjavali ste',oni:'objašnjavali su' },
        future:  { ja:'objašnjavaću',   ti:'objašnjavaćeš',  on:'objašnjavaće',  mi:'objašnjavaćemo',  vi:'objašnjavaćete',  oni:'objašnjavaće'    },
      }
    },
    // ── Group 5: Mixed / common ────────────────────────────────────────────
    {
      infinitive: 'čistiti', aspect: 'imp', english: 'to clean',
      conjugations: {
        present: { ja:'čistim',    ti:'čistiš',    on:'čisti',    mi:'čistimo',    vi:'čistite',    oni:'čiste'      },
        past:    { ja:'čistio sam',ti:'čistio si', on:'čistio je',mi:'čistili smo',vi:'čistili ste',oni:'čistili su' },
        future:  { ja:'čistiću',   ti:'čistićeš',  on:'čistiće',  mi:'čistićemo',  vi:'čistićete',  oni:'čistiće'    },
      }
    },
    {
      infinitive: 'pamtiti', aspect: 'imp', english: 'to remember',
      conjugations: {
        present: { ja:'pamtim',    ti:'pamtiš',    on:'pamti',    mi:'pamtimo',    vi:'pamtite',    oni:'pamte'      },
        past:    { ja:'pamtio sam',ti:'pamtio si', on:'pamtio je',mi:'pamtili smo',vi:'pamtili ste',oni:'pamtili su' },
        future:  { ja:'pamtiću',   ti:'pamtićeš',  on:'pamtiće',  mi:'pamtićemo',  vi:'pamtićete',  oni:'pamtiće'    },
      }
    },
    {
      infinitive: 'početi', aspect: 'pfv', english: 'to begin / to start',
      conjugations: {
        present: { ja:'počnem',    ti:'počneš',    on:'počne',    mi:'počnemo',    vi:'počnete',    oni:'počnu'      },
        past:    { ja:'počeo sam', ti:'počeo si',  on:'počeo je', mi:'počeli smo', vi:'počeli ste', oni:'počeli su'  },
        future:  { ja:'počeću',    ti:'počećeš',   on:'počeće',   mi:'počećemo',   vi:'počećete',   oni:'počeće'     },
      }
    },
    {
      infinitive: 'završiti', aspect: 'pfv', english: 'to finish / to end',
      conjugations: {
        present: { ja:'završim',    ti:'završiš',    on:'završi',    mi:'završimo',    vi:'završite',    oni:'završe'      },
        past:    { ja:'završio sam',ti:'završio si', on:'završio je',mi:'završili smo',vi:'završili ste',oni:'završili su' },
        future:  { ja:'završiću',   ti:'završićeš',  on:'završiće',  mi:'završićemo',  vi:'završićete',  oni:'završiće'    },
      }
    },
    {
      infinitive: 'pričekati', aspect: 'pfv', english: 'to wait (a bit)',
      conjugations: {
        present: { ja:'pričekam',    ti:'pričekaš',    on:'pričeka',    mi:'pričekamo',    vi:'pričekate',    oni:'pričekaju'    },
        past:    { ja:'pričekao sam',ti:'pričekao si', on:'pričekao je',mi:'pričekali smo',vi:'pričekali ste',oni:'pričekali su' },
        future:  { ja:'pričekaću',   ti:'pričekaćeš',  on:'pričekaće',  mi:'pričekaćemo',  vi:'pričekaćete',  oni:'pričekaće'    },
      }
    },
    {
      infinitive: 'preneti', aspect: 'pfv', english: 'to carry over / to transfer',
      conjugations: {
        present: { ja:'prnesem',    ti:'prneseš',    on:'prnese',    mi:'prnesemo',    vi:'prnesete',    oni:'prnesu'      },
        past:    { ja:'preneo sam', ti:'preneo si',  on:'preneo je', mi:'preneli smo', vi:'preneli ste', oni:'preneli su'  },
        future:  { ja:'preneću',    ti:'prenećeš',   on:'preneće',   mi:'prenećemo',   vi:'prenećete',   oni:'preneće'     },
      }
    },
    {
      infinitive: 'popiti', aspect: 'pfv', english: 'to drink up',
      conjugations: {
        present: { ja:'popijem',   ti:'popiješ',   on:'popije',   mi:'popijemo',   vi:'popijete',   oni:'popiju'     },
        past:    { ja:'popio sam', ti:'popio si',  on:'popio je', mi:'popili smo', vi:'popili ste', oni:'popili su'  },
        future:  { ja:'popiću',    ti:'popićeš',   on:'popiće',   mi:'popićemo',   vi:'popićete',   oni:'popiće'     },
      }
    },
    {
      infinitive: 'pojesti', aspect: 'pfv', english: 'to eat up',
      conjugations: {
        present: { ja:'pojedem',   ti:'pojedeš',   on:'pojede',   mi:'pojedemo',   vi:'pojedete',   oni:'pojedu'     },
        past:    { ja:'pojeo sam', ti:'pojeo si',  on:'pojeo je', mi:'pojeli smo', vi:'pojeli ste', oni:'pojeli su'  },
        future:  { ja:'pojesti ću',ti:'pojesti ćeš',on:'pojesti će',mi:'pojesti ćemo',vi:'pojesti ćete',oni:'pojesti će' },
      }
    },
    {
      infinitive: 'pozvati', aspect: 'pfv', english: 'to call / to invite',
      conjugations: {
        present: { ja:'pozovem',    ti:'pozoveš',    on:'pozove',    mi:'pozovemo',    vi:'pozovete',    oni:'pozovu'      },
        past:    { ja:'pozvao sam', ti:'pozvao si',  on:'pozvao je', mi:'pozvali smo', vi:'pozvali ste', oni:'pozvali su'  },
        future:  { ja:'pozvaću',    ti:'pozvaćeš',   on:'pozvaće',   mi:'pozvaćemo',   vi:'pozvaćete',   oni:'pozvaće'     },
      }
    },
    {
      infinitive: 'saznati', aspect: 'pfv', english: 'to find out / to learn',
      conjugations: {
        present: { ja:'saznam',    ti:'saznaš',    on:'sazna',    mi:'saznamo',    vi:'saznate',    oni:'saznaju'    },
        past:    { ja:'saznao sam',ti:'saznao si', on:'saznao je',mi:'saznali smo',vi:'saznali ste',oni:'saznali su' },
        future:  { ja:'saznaću',   ti:'saznaćeš',  on:'saznaće',  mi:'saznaćemo',  vi:'saznaćete',  oni:'saznaće'    },
      }
    },
    {
      infinitive: 'prihvatiti', aspect: 'pfv', english: 'to accept',
      conjugations: {
        present: { ja:'prihvatim',    ti:'prihvatiš',    on:'prihvati',    mi:'prihvatimo',    vi:'prihvatite',    oni:'prihvate'      },
        past:    { ja:'prihvatio sam',ti:'prihvatio si', on:'prihvatio je',mi:'prihvatili smo',vi:'prihvatili ste',oni:'prihvatili su' },
        future:  { ja:'prihvatiću',   ti:'prihvatićeš',  on:'prihvatiće',  mi:'prihvatićemo',  vi:'prihvatićete',  oni:'prihvatiće'    },
      }
    },
    {
      infinitive: 'objasniti', aspect: 'pfv', english: 'to explain (once)',
      conjugations: {
        present: { ja:'objasnim',    ti:'objasniš',    on:'objasni',    mi:'objasnimo',    vi:'objasnite',    oni:'objasne'      },
        past:    { ja:'objasnio sam',ti:'objasnio si', on:'objasnio je',mi:'objasnili smo',vi:'objasnili ste',oni:'objasnili su' },
        future:  { ja:'objasniću',   ti:'objasnićeš',  on:'objasniće',  mi:'objasnićemo',  vi:'objasnićete',  oni:'objasniće'    },
      }
    },
    {
      infinitive: 'otkazati', aspect: 'pfv', english: 'to cancel',
      conjugations: {
        present: { ja:'otkažem',    ti:'otkažeš',    on:'otkaže',    mi:'otkažemo',    vi:'otkažete',    oni:'otkažu'      },
        past:    { ja:'otkazao sam',ti:'otkazao si', on:'otkazao je',mi:'otkazali smo',vi:'otkazali ste',oni:'otkazali su' },
        future:  { ja:'otkazaću',   ti:'otkazaćeš',  on:'otkazaće',  mi:'otkazaćemo',  vi:'otkazaćete',  oni:'otkazaće'    },
      }
    },
    {
      infinitive: 'čuvati', aspect: 'imp', english: 'to keep / to guard',
      conjugations: {
        present: { ja:'čuvam',    ti:'čuvaš',    on:'čuva',    mi:'čuvamo',    vi:'čuvate',    oni:'čuvaju'    },
        past:    { ja:'čuvao sam',ti:'čuvao si', on:'čuvao je',mi:'čuvali smo',vi:'čuvali ste',oni:'čuvali su' },
        future:  { ja:'čuvaću',   ti:'čuvaćeš',  on:'čuvaće',  mi:'čuvaćemo',  vi:'čuvaćete',  oni:'čuvaće'    },
      }
    },
    {
      infinitive: 'pokazati', aspect: 'pfv', english: 'to show (once)',
      conjugations: {
        present: { ja:'pokažem',    ti:'pokažeš',    on:'pokaže',    mi:'pokažemo',    vi:'pokažete',    oni:'pokažu'      },
        past:    { ja:'pokazao sam',ti:'pokazao si', on:'pokazao je',mi:'pokazali smo',vi:'pokazali ste',oni:'pokazali su' },
        future:  { ja:'pokazaću',   ti:'pokazaćeš',  on:'pokazaće',  mi:'pokazaćemo',  vi:'pokazaćete',  oni:'pokazaće'    },
      }
    },
    {
      infinitive: 'baciti', aspect: 'pfv', english: 'to throw',
      conjugations: {
        present: { ja:'bacim',    ti:'baciš',    on:'baci',    mi:'bacimo',    vi:'bacite',    oni:'bace'      },
        past:    { ja:'bacio sam',ti:'bacio si', on:'bacio je',mi:'bacili smo',vi:'bacili ste',oni:'bacili su' },
        future:  { ja:'baciću',   ti:'bacićeš',  on:'baciće',  mi:'bacićemo',  vi:'bacićete',  oni:'baciće'    },
      }
    },
    {
      infinitive: 'popraviti', aspect: 'pfv', english: 'to fix / to repair',
      conjugations: {
        present: { ja:'popravim',    ti:'popraviš',    on:'popravi',    mi:'popravimo',    vi:'popravite',    oni:'poprave'     },
        past:    { ja:'popravio sam',ti:'popravio si', on:'popravio je',mi:'popravili smo',vi:'popravili ste',oni:'popravili su' },
        future:  { ja:'popraviću',   ti:'popravićeš',  on:'popraviće',  mi:'popravićemo',  vi:'popravićete',  oni:'popraviće'   },
      }
    },
    {
      infinitive: 'doručkovati', aspect: 'imp', english: 'to have breakfast',
      conjugations: {
        present: { ja:'doručkujem',    ti:'doručkuješ',    on:'doručkuje',    mi:'doručkujemo',    vi:'doručkujete',    oni:'doručkuju'      },
        past:    { ja:'doručkovao sam',ti:'doručkovao si', on:'doručkovao je',mi:'doručkovali smo',vi:'doručkovali ste',oni:'doručkovali su' },
        future:  { ja:'doručkovaću',   ti:'doručkovaćeš',  on:'doručkovaće',  mi:'doručkovaćemo',  vi:'doručkovaćete',  oni:'doručkovaće'    },
      }
    },
    // ── Verbs II additions ─────────────────────────────────────────────────
    {
      infinitive: 'misliti', aspect: 'imp', english: 'to think',
      conjugations: {
        present: { ja:'mislim',    ti:'misliš',    on:'misli',    mi:'mislimo',    vi:'mislite',    oni:'misle'      },
        past:    { ja:'mislio sam',ti:'mislio si', on:'mislio je',mi:'mislili smo',vi:'mislili ste',oni:'mislili su' },
        future:  { ja:'misliću',   ti:'mislićeš',  on:'misliće',  mi:'mislićemo',  vi:'mislićete',  oni:'misliće'    },
      }
    },
    {
      infinitive: 'čekati', aspect: 'imp', english: 'to wait',
      conjugations: {
        present: { ja:'čekam',    ti:'čekaš',    on:'čeka',    mi:'čekamo',    vi:'čekate',    oni:'čekaju'     },
        past:    { ja:'čekao sam',ti:'čekao si', on:'čekao je',mi:'čekali smo',vi:'čekali ste',oni:'čekali su'  },
        future:  { ja:'čekaću',   ti:'čekaćeš',  on:'čekaće',  mi:'čekaćemo',  vi:'čekaćete',  oni:'čekaće'     },
      }
    },
    {
      infinitive: 'pričati', aspect: 'imp', english: 'to talk / to tell',
      conjugations: {
        present: { ja:'pričam',    ti:'pričaš',    on:'priča',    mi:'pričamo',    vi:'pričate',    oni:'pričaju'     },
        past:    { ja:'pričao sam',ti:'pričao si', on:'pričao je',mi:'pričali smo',vi:'pričali ste',oni:'pričali su'  },
        future:  { ja:'pričaću',   ti:'pričaćeš',  on:'pričaće',  mi:'pričaćemo',  vi:'pričaćete',  oni:'pričaće'     },
      }
    },
    {
      infinitive: 'slušati', aspect: 'imp', english: 'to listen',
      conjugations: {
        present: { ja:'slušam',    ti:'slušaš',    on:'sluša',    mi:'slušamo',    vi:'slušate',    oni:'slušaju'     },
        past:    { ja:'slušao sam',ti:'slušao si', on:'slušao je',mi:'slušali smo',vi:'slušali ste',oni:'slušali su'  },
        future:  { ja:'slušaću',   ti:'slušaćeš',  on:'slušaće',  mi:'slušaćemo',  vi:'slušaćete',  oni:'slušaće'     },
      }
    },
    {
      infinitive: 'gledati', aspect: 'imp', english: 'to watch / to look at',
      conjugations: {
        present: { ja:'gledam',    ti:'gledaš',    on:'gleda',    mi:'gledamo',    vi:'gledate',    oni:'gledaju'     },
        past:    { ja:'gledao sam',ti:'gledao si', on:'gledao je',mi:'gledali smo',vi:'gledali ste',oni:'gledali su'  },
        future:  { ja:'gledaću',   ti:'gledaćeš',  on:'gledaće',  mi:'gledaćemo',  vi:'gledaćete',  oni:'gledaće'     },
      }
    },
    {
      infinitive: 'sedeti', aspect: 'imp', english: 'to sit',
      conjugations: {
        present: { ja:'sedim',    ti:'sediš',    on:'sedi',    mi:'sedimo',    vi:'sedite',    oni:'sede'      },
        past:    { ja:'sedeo sam',ti:'sedeo si', on:'sedeo je',mi:'sedeli smo',vi:'sedeli ste',oni:'sedeli su' },
        future:  { ja:'sediću',   ti:'sedićeš',  on:'sediće',  mi:'sedićemo',  vi:'sedićete',  oni:'sediće'    },
      }
    },
    {
      infinitive: 'stajati', aspect: 'imp', english: 'to stand',
      conjugations: {
        present: { ja:'stojim',    ti:'stojiš',    on:'stoji',    mi:'stojimo',    vi:'stojite',    oni:'stoje'      },
        past:    { ja:'stajao sam',ti:'stajao si', on:'stajao je',mi:'stajali smo',vi:'stajali ste',oni:'stajali su' },
        future:  { ja:'stajaću',   ti:'stajaćeš',  on:'stajaće',  mi:'stajaćemo',  vi:'stajaćete',  oni:'stajaće'    },
      }
    },
    {
      infinitive: 'hodati', aspect: 'imp', english: 'to walk',
      conjugations: {
        present: { ja:'hodam',    ti:'hodaš',    on:'hoda',    mi:'hodamo',    vi:'hodate',    oni:'hodaju'     },
        past:    { ja:'hodao sam',ti:'hodao si', on:'hodao je',mi:'hodali smo',vi:'hodali ste',oni:'hodali su'  },
        future:  { ja:'hodaću',   ti:'hodaćeš',  on:'hodaće',  mi:'hodaćemo',  vi:'hodaćete',  oni:'hodaće'     },
      }
    },
    {
      infinitive: 'trčati', aspect: 'imp', english: 'to run',
      conjugations: {
        present: { ja:'trčim',    ti:'trčiš',    on:'trči',    mi:'trčimo',    vi:'trčite',    oni:'trče'      },
        past:    { ja:'trčao sam',ti:'trčao si', on:'trčao je',mi:'trčali smo',vi:'trčali ste',oni:'trčali su' },
        future:  { ja:'trčaću',   ti:'trčaćeš',  on:'trčaće',  mi:'trčaćemo',  vi:'trčaćete',  oni:'trčaće'    },
      }
    },
    {
      infinitive: 'plakati', aspect: 'imp', english: 'to cry',
      conjugations: {
        present: { ja:'plačem',    ti:'plačeš',    on:'plače',    mi:'plačemo',    vi:'plačete',    oni:'plaču'      },
        past:    { ja:'plakao sam',ti:'plakao si', on:'plakao je',mi:'plakali smo',vi:'plakali ste',oni:'plakali su' },
        future:  { ja:'plakaću',   ti:'plakaćeš',  on:'plakaće',  mi:'plakaćemo',  vi:'plakaćete',  oni:'plakaće'    },
      }
    },
    {
      infinitive: 'smejati se', aspect: 'imp', english: 'to laugh',
      conjugations: {
        present: { ja:'smejem se',    ti:'smeješ se',    on:'smeje se',    mi:'smejemo se',    vi:'smejete se',    oni:'smeju se'      },
        past:    { ja:'smejao sam se',ti:'smejao si se', on:'smejao se',   mi:'smejali smo se',vi:'smejali ste se',oni:'smejali su se' },
        future:  { ja:'smejaću se',   ti:'smejaćeš se',  on:'smejaće se',  mi:'smejaćemo se',  vi:'smejaćete se',  oni:'smejaće se'    },
      }
    },
    {
      infinitive: 'pevati', aspect: 'imp', english: 'to sing',
      conjugations: {
        present: { ja:'pevam',    ti:'pevaš',    on:'peva',    mi:'pevamo',    vi:'pevate',    oni:'pevaju'     },
        past:    { ja:'pevao sam',ti:'pevao si', on:'pevao je',mi:'pevali smo',vi:'pevali ste',oni:'pevali su'  },
        future:  { ja:'pevaću',   ti:'pevaćeš',  on:'pevaće',  mi:'pevaćemo',  vi:'pevaćete',  oni:'pevaće'     },
      }
    },
    {
      infinitive: 'igrati se', aspect: 'imp', english: 'to play',
      conjugations: {
        present: { ja:'igram se',    ti:'igraš se',    on:'igra se',    mi:'igramo se',    vi:'igrate se',    oni:'igraju se'      },
        past:    { ja:'igrao sam se',ti:'igrao si se', on:'igrao se',   mi:'igrali smo se',vi:'igrali ste se',oni:'igrali su se'    },
        future:  { ja:'igraću se',   ti:'igraćeš se',  on:'igraće se',  mi:'igraćemo se',  vi:'igraćete se',  oni:'igraće se'      },
      }
    },
    {
      infinitive: 'učiti', aspect: 'imp', english: 'to study / to learn',
      conjugations: {
        present: { ja:'učim',    ti:'učiš',    on:'uči',    mi:'učimo',    vi:'učite',    oni:'uče'      },
        past:    { ja:'učio sam',ti:'učio si', on:'učio je',mi:'učili smo',vi:'učili ste',oni:'učili su' },
        future:  { ja:'učiću',   ti:'učićeš',  on:'učiće',  mi:'učićemo',  vi:'učićete',  oni:'učiće'    },
      }
    },
    {
      infinitive: 'otvoriti', aspect: 'pfv', english: 'to open',
      conjugations: {
        present: { ja:'otvorim',    ti:'otvoriš',    on:'otvori',    mi:'otvorimo',    vi:'otvorite',    oni:'otvore'       },
        past:    { ja:'otvorio sam',ti:'otvorio si', on:'otvorio je',mi:'otvorili smo',vi:'otvorili ste',oni:'otvorili su'  },
        future:  { ja:'otvoriću',   ti:'otvorićeš',  on:'otvoriće',  mi:'otvorićemo',  vi:'otvorićete',  oni:'otvoriće'     },
      }
    },
    {
      infinitive: 'zatvoriti', aspect: 'pfv', english: 'to close',
      conjugations: {
        present: { ja:'zatvorim',    ti:'zatvoriš',    on:'zatvori',    mi:'zatvorimo',    vi:'zatvorite',    oni:'zatvore'       },
        past:    { ja:'zatvorio sam',ti:'zatvorio si', on:'zatvorio je',mi:'zatvorili smo',vi:'zatvorili ste',oni:'zatvorili su'  },
        future:  { ja:'zatvoriću',   ti:'zatvorićeš',  on:'zatvoriće',  mi:'zatvorićemo',  vi:'zatvorićete',  oni:'zatvoriće'     },
      }
    },
    {
      infinitive: 'platiti', aspect: 'pfv', english: 'to pay',
      conjugations: {
        present: { ja:'platim',    ti:'platiš',    on:'plati',    mi:'platimo',    vi:'platite',    oni:'plate'      },
        past:    { ja:'platio sam',ti:'platio si', on:'platio je',mi:'platili smo',vi:'platili ste',oni:'platili su' },
        future:  { ja:'platiću',   ti:'platićeš',  on:'platiće',  mi:'platićemo',  vi:'platićete',  oni:'platiće'    },
      }
    },
    {
      infinitive: 'nositi', aspect: 'imp', english: 'to carry / to wear',
      conjugations: {
        present: { ja:'nosim',    ti:'nosiš',    on:'nosi',    mi:'nosimo',    vi:'nosite',    oni:'nose'      },
        past:    { ja:'nosio sam',ti:'nosio si', on:'nosio je',mi:'nosili smo',vi:'nosili ste',oni:'nosili su' },
        future:  { ja:'nosiću',   ti:'nosićeš',  on:'nosiće',  mi:'nosićemo',  vi:'nosićete',  oni:'nosiće'    },
      }
    },
    {
      infinitive: 'padati', aspect: 'imp', english: 'to fall',
      conjugations: {
        present: { ja:'padam',    ti:'padaš',    on:'pada',    mi:'padamo',    vi:'padate',    oni:'padaju'     },
        past:    { ja:'padao sam',ti:'padao si', on:'padao je',mi:'padali smo',vi:'padali ste',oni:'padali su'  },
        future:  { ja:'padaću',   ti:'padaćeš',  on:'padaće',  mi:'padaćemo',  vi:'padaćete',  oni:'padaće'     },
      }
    },
    {
      infinitive: 'brinuti se', aspect: 'imp', english: 'to worry',
      conjugations: {
        present: { ja:'brinem se',    ti:'brineš se',    on:'brine se',    mi:'brinemo se',    vi:'brinete se',    oni:'brinu se'      },
        past:    { ja:'brinuo sam se',ti:'brinuo si se', on:'brinuo se',   mi:'brinuli smo se',vi:'brinuli ste se',oni:'brinuli su se' },
        future:  { ja:'brinuću se',   ti:'brinućeš se',  on:'brinuće se',  mi:'brinućemo se',  vi:'brinućete se',  oni:'brinuće se'    },
      }
    },
    {
      infinitive: 'čuvati', aspect: 'imp', english: 'to take care of / to keep',
      conjugations: {
        present: { ja:'čuvam',    ti:'čuvaš',    on:'čuva',    mi:'čuvamo',    vi:'čuvate',    oni:'čuvaju'     },
        past:    { ja:'čuvao sam',ti:'čuvao si', on:'čuvao je',mi:'čuvali smo',vi:'čuvali ste',oni:'čuvali su'  },
        future:  { ja:'čuvaću',   ti:'čuvaćeš',  on:'čuvaće',  mi:'čuvaćemo',  vi:'čuvaćete',  oni:'čuvaće'     },
      }
    },
    {
      infinitive: 'sećati se', aspect: 'imp', english: 'to remember',
      conjugations: {
        present: { ja:'sećam se',    ti:'sećaš se',    on:'seća se',    mi:'sećamo se',    vi:'sećate se',    oni:'sećaju se'      },
        past:    { ja:'sećao sam se',ti:'sećao si se', on:'sećao se',   mi:'sećali smo se',vi:'sećali ste se',oni:'sećali su se'   },
        future:  { ja:'sećaću se',   ti:'sećaćeš se',  on:'sećaće se',  mi:'sećaćemo se',  vi:'sećaćete se',  oni:'sećaće se'      },
      }
    },
    {
      infinitive: 'zaboraviti', aspect: 'pfv', english: 'to forget',
      conjugations: {
        present: { ja:'zaboravim',    ti:'zaboraviš',    on:'zaboravi',    mi:'zaboravimo',    vi:'zaboravite',    oni:'zaborave'       },
        past:    { ja:'zaboravio sam',ti:'zaboravio si', on:'zaboravio je',mi:'zaboravili smo',vi:'zaboravili ste',oni:'zaboravili su'  },
        future:  { ja:'zaboraviću',   ti:'zaboravićeš',  on:'zaboraviće',  mi:'zaboravićemo',  vi:'zaboravićete',  oni:'zaboraviće'     },
      }
    },
    {
      infinitive: 'objasniti', aspect: 'pfv', english: 'to explain',
      conjugations: {
        present: { ja:'objasnim',    ti:'objasniš',    on:'objasni',    mi:'objasnimo',    vi:'objasnite',    oni:'objasne'       },
        past:    { ja:'objasnio sam',ti:'objasnio si', on:'objasnio je',mi:'objasnili smo',vi:'objasnili ste',oni:'objasnili su'  },
        future:  { ja:'objasniću',   ti:'objasnićeš',  on:'objasniće',  mi:'objasnićemo',  vi:'objasnićete',  oni:'objasniće'     },
      }
    },
    {
      infinitive: 'pozvati', aspect: 'pfv', english: 'to invite / to call',
      conjugations: {
        present: { ja:'pozovem',    ti:'pozoveš',    on:'pozove',    mi:'pozovemo',    vi:'pozovete',    oni:'pozovu'      },
        past:    { ja:'pozvao sam',ti:'pozvao si', on:'pozvao je',mi:'pozvali smo',vi:'pozvali ste',oni:'pozvali su'  },
        future:  { ja:'pozvaću',   ti:'pozvaćeš',  on:'pozvaće',  mi:'pozvaćemo',  vi:'pozvaćete',  oni:'pozvaće'     },
      }
    },
  ];

  // ═══════════════════════════════════════════════════
  //  GROUPS STORAGE
  // ═══════════════════════════════════════════════════
  const GROUPS_KEY  = 'serbian_groups';
  const GROUPS_VER  = '3';

  const DEFAULT_GROUPS = [
    'Greetings','Basics','Food & Drink','Places','Numbers','Animals',
    'People','Time','Colors','Body','Home','Verbs','Adjectives','Prepositions',
    'Phrases','Verbs II','Transportation','Clothing','Nature & Weather','School & Work',
    'Unit 1','Unit 2','Unit 3','Unit 4','Unit 5','Unit 6','Unit 7',
    'Unit 8','Unit 9','Unit 10','Unit 11','Unit 12','Unit 13','Unit 14',
  ];

  function loadGroups() {
    const raw = localStorage.getItem(GROUPS_KEY);
    const ver = localStorage.getItem(GROUPS_KEY + '_v');
    if (!raw || ver !== GROUPS_VER) {
      const existing = raw ? JSON.parse(raw) : [];
      const merged   = [...existing];
      DEFAULT_GROUPS.forEach(g => { if (!existing.includes(g)) merged.push(g); });
      saveGroups(merged);
      localStorage.setItem(GROUPS_KEY + '_v', GROUPS_VER);
      return merged;
    }
    return JSON.parse(raw);
  }
  function saveGroups(g) { localStorage.setItem(GROUPS_KEY, JSON.stringify(g)); }

  function getGroupColor(name) {
    if (!name) return '#546e7a';
    const idx = groups.indexOf(name);
    return idx >= 0 ? PALETTE[idx % PALETTE.length] : '#546e7a';
  }

  // ═══════════════════════════════════════════════════
  //  FILL-IN DRILL DATA
  // ═══════════════════════════════════════════════════
  const SENTENCE_DRILLS = [
    // ─── biti (to be) — present ───────────────────────
    { sr:'Ja ___ student.',          en:'I am a student.',                answer:'sam',     options:['sam','si','je','smo'],               hint:'biti (to be) — 1st sg. present' },
    { sr:'Ti ___ umoran.',           en:'You are tired. (masc.)',          answer:'si',      options:['sam','si','je','ste'],               hint:'biti (to be) — 2nd sg. present' },
    { sr:'Ona ___ nastavnica.',      en:'She is a teacher.',               answer:'je',      options:['sam','je','smo','su'],               hint:'biti (to be) — 3rd sg. present' },
    { sr:'Mi ___ srećni.',           en:'We are happy.',                   answer:'smo',     options:['sam','je','smo','su'],               hint:'biti (to be) — 1st pl. present' },
    { sr:'Vi ___ dobri.',            en:'You (pl.) are good.',             answer:'ste',     options:['smo','ste','su','je'],               hint:'biti (to be) — 2nd pl. present' },
    { sr:'Oni ___ ovde.',            en:'They are here.',                  answer:'su',      options:['smo','ste','su','je'],               hint:'biti (to be) — 3rd pl. present' },
    // ─── imati (to have) — present ───────────────────
    { sr:'Ja ___ psa.',              en:'I have a dog.',                   answer:'imam',    options:['imam','imaš','ima','imamo'],         hint:'imati (to have) — 1st sg. present' },
    { sr:'Ti ___ brata.',            en:'You have a brother.',             answer:'imaš',    options:['imam','imaš','ima','imaju'],         hint:'imati (to have) — 2nd sg. present' },
    { sr:'On ___ sestru.',           en:'He has a sister.',                answer:'ima',     options:['imam','imaš','ima','imamo'],         hint:'imati (to have) — 3rd sg. present' },
    { sr:'Oni ___ kuću.',            en:'They have a house.',              answer:'imaju',   options:['ima','imamo','imate','imaju'],       hint:'imati (to have) — 3rd pl. present' },
    // ─── govoriti (to speak) — present ───────────────
    { sr:'Ja ___ srpski.',           en:'I speak Serbian.',                answer:'govorim', options:['govorim','govoriš','govori','govore'],   hint:'govoriti (to speak) — 1st sg. present' },
    { sr:'Ti ___ brzo.',             en:'You speak fast.',                 answer:'govoriš', options:['govorim','govoriš','govori','govorimo'], hint:'govoriti (to speak) — 2nd sg. present' },
    { sr:'Ona ___ engleski.',        en:'She speaks English.',             answer:'govori',  options:['govorim','govoriš','govori','govore'],   hint:'govoriti (to speak) — 3rd sg. present' },
    { sr:'Oni ___ tiho.',            en:'They speak quietly.',             answer:'govore',  options:['govori','govorimo','govorite','govore'], hint:'govoriti (to speak) — 3rd pl. present' },
    // ─── ići (to go) — present ───────────────────────
    { sr:'Ja ___ u školu.',          en:'I am going to school.',           answer:'idem',    options:['idem','ideš','ide','idemo'],         hint:'ići (to go) — 1st sg. present' },
    { sr:'Ona ___ kući.',            en:'She is going home.',              answer:'ide',     options:['idem','ideš','ide','idu'],           hint:'ići (to go) — 3rd sg. present' },
    { sr:'Mi ___ u grad.',           en:'We are going to town.',           answer:'idemo',   options:['idem','idemo','idete','idu'],        hint:'ići (to go) — 1st pl. present' },
    { sr:'Oni ___ na more.',         en:'They are going to the sea.',      answer:'idu',     options:['ide','idemo','idete','idu'],         hint:'ići (to go) — 3rd pl. present' },
    // ─── raditi (to work) — present ──────────────────
    { sr:'Ja ___ u banci.',          en:'I work in a bank.',               answer:'radim',   options:['radim','radiš','radi','rade'],       hint:'raditi (to work) — 1st sg. present' },
    { sr:'Ti ___ svaki dan.',        en:'You work every day.',             answer:'radiš',   options:['radim','radiš','radi','radimo'],     hint:'raditi (to work) — 2nd sg. present' },
    { sr:'On ___ u fabrici.',        en:'He works in a factory.',          answer:'radi',    options:['radim','radiš','radi','rade'],       hint:'raditi (to work) — 3rd sg. present' },
    { sr:'Oni ___ zajedno.',         en:'They work together.',             answer:'rade',    options:['radi','radimo','radite','rade'],     hint:'raditi (to work) — 3rd pl. present' },
    // ─── jesti (to eat) — present ────────────────────
    { sr:'Ona ___ jabuku.',          en:'She is eating an apple.',         answer:'jede',    options:['jedem','jedeš','jede','jedu'],       hint:'jesti (to eat) — 3rd sg. present' },
    { sr:'Mi ___ ručak.',            en:'We are eating lunch.',            answer:'jedemo',  options:['jede','jedemo','jedete','jedu'],     hint:'jesti (to eat) — 1st pl. present' },
    { sr:'Oni ___ večeru.',          en:'They are eating dinner.',         answer:'jedu',    options:['jede','jedemo','jedete','jedu'],     hint:'jesti (to eat) — 3rd pl. present' },
    // ─── piti (to drink) — present ───────────────────
    { sr:'Ja ___ kafu.',             en:'I am drinking coffee.',           answer:'pijem',   options:['pijem','piješ','pije','pijemo'],     hint:'piti (to drink) — 1st sg. present' },
    { sr:'Ona ___ vodu.',            en:'She is drinking water.',          answer:'pije',    options:['pijem','piješ','pije','piju'],       hint:'piti (to drink) — 3rd sg. present' },
    { sr:'Oni ___ pivo.',            en:'They are drinking beer.',         answer:'piju',    options:['pije','pijemo','pijete','piju'],     hint:'piti (to drink) — 3rd pl. present' },
    // ─── znati (to know) — present ───────────────────
    { sr:'Ja ___ odgovor.',          en:'I know the answer.',              answer:'znam',    options:['znam','znaš','zna','znamo'],         hint:'znati (to know) — 1st sg. present' },
    { sr:'On ___ srpski dobro.',     en:'He knows Serbian well.',          answer:'zna',     options:['znam','znaš','zna','znaju'],         hint:'znati (to know) — 3rd sg. present' },
    { sr:'Mi ___ put.',              en:'We know the way.',                answer:'znamo',   options:['znam','zna','znamo','znaju'],        hint:'znati (to know) — 1st pl. present' },
    // ─── videti (to see) — present ───────────────────
    { sr:'Ja ___ planine.',          en:'I see the mountains.',            answer:'vidim',   options:['vidim','vidiš','vidi','vidimo'],     hint:'videti (to see) — 1st sg. present' },
    { sr:'Ti ___ more.',             en:'You see the sea.',                answer:'vidiš',   options:['vidim','vidiš','vidi','vide'],       hint:'videti (to see) — 2nd sg. present' },
    { sr:'Oni ___ park.',            en:'They see the park.',              answer:'vide',    options:['vidi','vidimo','vidite','vide'],     hint:'videti (to see) — 3rd pl. present' },
    // ─── živeti (to live) — present ──────────────────
    { sr:'Ona ___ u Beogradu.',      en:'She lives in Belgrade.',          answer:'živi',    options:['živim','živi','živimo','žive'],      hint:'živeti (to live) — 3rd sg. present' },
    { sr:'Mi ___ u gradu.',          en:'We live in the city.',            answer:'živimo',  options:['živim','živi','živimo','žive'],      hint:'živeti (to live) — 1st pl. present' },
    // ─── voleti (to love/like) — present ─────────────
    { sr:'Ja ___ srpsku hranu.',     en:'I love Serbian food.',            answer:'volim',   options:['volim','voliš','voli','volimo'],     hint:'voleti (to love) — 1st sg. present' },
    { sr:'Ona ___ muziku.',          en:'She loves music.',                answer:'voli',    options:['volim','voliš','voli','vole'],       hint:'voleti (to love) — 3rd sg. present' },
    // ─── moći (to be able / can) — present ───────────
    { sr:'Ja ___ da pomognem.',      en:'I can help.',                     answer:'mogu',    options:['mogu','možeš','može','možemo'],      hint:'moći (can) — 1st sg. present' },
    { sr:'Ti ___ da dođeš.',         en:'You can come.',                   answer:'možeš',   options:['mogu','možeš','može','možemo'],      hint:'moći (can) — 2nd sg. present' },
    { sr:'Ona ___ da peva.',         en:'She can sing.',                   answer:'može',    options:['mogu','možeš','može','možemo'],      hint:'moći (can) — 3rd sg. present' },
    // ─── čitati (to read) — present ──────────────────
    { sr:'Ona ___ knjigu.',          en:'She is reading a book.',          answer:'čita',    options:['čitam','čitaš','čita','čitaju'],     hint:'čitati (to read) — 3rd sg. present' },
    { sr:'Ja ___ novine.',           en:'I am reading the newspaper.',     answer:'čitam',   options:['čitam','čitaš','čita','čitamo'],     hint:'čitati (to read) — 1st sg. present' },
    // ─── pisati (to write) — present ─────────────────
    { sr:'On ___ pismo.',            en:'He is writing a letter.',         answer:'piše',    options:['pišem','pišeš','piše','pišemo'],     hint:'pisati (to write) — 3rd sg. present' },
    { sr:'Ja ___ email.',            en:'I am writing an email.',          answer:'pišem',   options:['pišem','pišeš','piše','pišu'],       hint:'pisati (to write) — 1st sg. present' },
    // ─── učiti (to study/learn) — present ────────────
    { sr:'Mi ___ srpski.',           en:'We are studying Serbian.',        answer:'učimo',   options:['učim','učiš','učimo','uče'],         hint:'učiti (to study) — 1st pl. present' },
    { sr:'Ti ___ za ispit.',         en:'You are studying for an exam.',   answer:'učiš',    options:['učim','učiš','uči','učimo'],         hint:'učiti (to study) — 2nd sg. present' },
    // ─── dolaziti (to come/arrive) — present ─────────
    { sr:'Ona ___ kasno.',           en:'She is coming late.',             answer:'dolazi',  options:['dolazim','dolazi','dolazimo','dolaze'], hint:'dolaziti (to arrive) — 3rd sg. present' },
    { sr:'Oni ___ sutra.',           en:'They are coming tomorrow.',       answer:'dolaze',  options:['dolazi','dolazimo','dolazite','dolaze'],hint:'dolaziti (to arrive) — 3rd pl. present' },
    // ─── spavati (to sleep) — present ────────────────
    { sr:'Beba ___.',                en:'The baby is sleeping.',           answer:'spava',   options:['spavam','spavaš','spava','spavamo'],  hint:'spavati (to sleep) — 3rd sg. present' },
    { sr:'Ja ___ dobro.',            en:'I sleep well.',                   answer:'spavam',  options:['spavam','spavaš','spava','spavaju'],  hint:'spavati (to sleep) — 1st sg. present' },
    // ─── čekati (to wait) — present ──────────────────
    { sr:'Mi ___ autobus.',          en:'We are waiting for the bus.',     answer:'čekamo',  options:['čekam','čekaš','čekamo','čekaju'],   hint:'čekati (to wait) — 1st pl. present' },
    { sr:'Ti ___ prijatelja.',       en:'You are waiting for a friend.',   answer:'čekaš',   options:['čekam','čekaš','čeka','čekamo'],     hint:'čekati (to wait) — 2nd sg. present' },
    // ─── past tense ───────────────────────────────────
    { sr:'On je ___ u Beogradu.',    en:'He lived in Belgrade.',           answer:'živeo',   options:['živeo','živela','živeli','živelo'],   hint:'živeti — past, masc. sg.' },
    { sr:'Ona je ___ knjigu.',       en:'She read the book.',              answer:'čitala',  options:['čitao','čitala','čitali','čitale'],   hint:'čitati — past, fem. sg.' },
    { sr:'Oni su ___ kafu.',         en:'They drank coffee.',              answer:'pili',    options:['pio','pila','pili','pile'],           hint:'piti — past, masc. pl.' },
    { sr:'Ja sam ___ zadatak.',      en:'I wrote the assignment. (masc.)', answer:'pisao',   options:['pisao','pisala','pisali','pisale'],   hint:'pisati — past, masc. sg.' },
    { sr:'Mi smo ___ zajedno.',      en:'We worked together.',             answer:'radili',  options:['radio','radila','radili','radile'],   hint:'raditi — past, pl.' },
    // ─── misliti (to think) ───────────────────────────
    { sr:'Ja ___ da je to dobra ideja.',  en:'I think that is a good idea.',    answer:'mislim',  options:['mislim','misliš','misli','misle'],        hint:'misliti (to think) — 1st sg. present' },
    { sr:'Šta ___ o tome?',               en:'What do you think about it?',     answer:'misliš',  options:['mislim','misliš','misli','mislimo'],       hint:'misliti (to think) — 2nd sg. present' },
    { sr:'Ona je ___ o porodici.',        en:'She was thinking about her family.', answer:'mislila', options:['mislio','mislila','mislili','mislile'],   hint:'misliti — past, fem. sg.' },
    // ─── pričati (to talk) ────────────────────────────
    { sr:'Oni ___ ceo dan.',              en:'They talk all day.',               answer:'pričaju', options:['pričam','pričaš','priča','pričaju'],       hint:'pričati (to talk) — 3rd pl. present' },
    { sr:'Ona ___ o svom putu.',          en:'She is talking about her trip.',   answer:'priča',   options:['pričam','pričaš','priča','pričamo'],       hint:'pričati (to talk) — 3rd sg. present' },
    // ─── slušati (to listen) ──────────────────────────
    { sr:'Ja ___ muziku svaki dan.',      en:'I listen to music every day.',     answer:'slušam',  options:['slušam','slušaš','sluša','slušaju'],       hint:'slušati (to listen) — 1st sg. present' },
    { sr:'Deca ___ učitelja.',            en:'The children are listening to the teacher.', answer:'slušaju', options:['slušam','sluša','slušamo','slušaju'], hint:'slušati (to listen) — 3rd pl. present' },
    // ─── gledati (to watch) ───────────────────────────
    { sr:'Mi ___ film zajedno.',          en:'We are watching a movie together.',answer:'gledamo', options:['gledam','gledaš','gledamo','gledaju'],      hint:'gledati (to watch) — 1st pl. present' },
    { sr:'Ona je ___ televiziju celo veče.', en:'She watched TV all evening.',   answer:'gledala', options:['gledao','gledala','gledali','gledalo'],     hint:'gledati — past, fem. sg.' },
    // ─── sedeti (to sit) ──────────────────────────────
    { sr:'On ___ u parku i čita.',        en:'He sits in the park and reads.',   answer:'sedi',    options:['sedim','sediš','sedi','sede'],             hint:'sedeti (to sit) — 3rd sg. present' },
    // ─── stajati (to stand) ───────────────────────────
    { sr:'Ona ___ ispred vrata.',         en:'She is standing in front of the door.', answer:'stoji', options:['stojim','stojiš','stoji','stoje'],      hint:'stajati (to stand) — 3rd sg. present' },
    // ─── hodati (to walk) ─────────────────────────────
    { sr:'Ona ___ po gradu svako jutro.', en:'She walks around the city every morning.', answer:'hoda', options:['hodam','hodaš','hoda','hodaju'],    hint:'hodati (to walk) — 3rd sg. present' },
    // ─── trčati (to run) ──────────────────────────────
    { sr:'Ja ___ u parku svako jutro.',   en:'I run in the park every morning.', answer:'trčim',   options:['trčim','trčiš','trči','trče'],             hint:'trčati (to run) — 1st sg. present' },
    // ─── plakati (to cry) ─────────────────────────────
    { sr:'Beba ___.',                     en:'The baby is crying.',              answer:'plače',   options:['plačem','plačeš','plače','plačemo'],       hint:'plakati (to cry) — 3rd sg. present' },
    { sr:'Ona je ___ od sreće.',          en:'She cried from joy.',              answer:'plakala', options:['plakao','plakala','plakali','plakale'],     hint:'plakati — past, fem. sg.' },
    // ─── smejati se (to laugh) ────────────────────────
    { sr:'Svi se ___ na tu šalu.',        en:'Everyone is laughing at that joke.',answer:'smeju',  options:['smejem','smeješ','smeje','smeju'],         hint:'smejati se (to laugh) — 3rd pl. present' },
    // ─── pevati (to sing) ─────────────────────────────
    { sr:'Ona lepo ___.',                 en:'She sings beautifully.',           answer:'peva',    options:['pevam','pevaš','peva','pevaju'],           hint:'pevati (to sing) — 3rd sg. present' },
    { sr:'Oni su ___ celu noć.',          en:'They sang all night.',             answer:'pevali',  options:['pevao','pevala','pevali','pevale'],         hint:'pevati — past, masc. pl.' },
    // ─── nositi (to carry/wear) ───────────────────────
    { sr:'On ___ tešku torbu.',           en:'He is carrying a heavy bag.',      answer:'nosi',    options:['nosim','nosiš','nosi','nose'],             hint:'nositi (to carry) — 3rd sg. present' },
    { sr:'Ona ___ lepu haljinu.',         en:'She is wearing a beautiful dress.',answer:'nosi',    options:['nosim','nosiš','nosi','nose'],             hint:'nositi (to wear) — 3rd sg. present' },
    // ─── brinuti se (to worry) ────────────────────────
    { sr:'Mama se uvek ___ za nas.',      en:'Mom always worries about us.',     answer:'brine',   options:['brinem','brineš','brine','brinu'],         hint:'brinuti se (to worry) — 3rd sg. present' },
    // ─── čuvati (to take care of) ─────────────────────
    { sr:'Ona ___ decu dok smo odsutni.',en:'She takes care of the kids while we are away.', answer:'čuva', options:['čuvam','čuvaš','čuva','čuvaju'], hint:'čuvati (to take care of) — 3rd sg. present' },
    // ─── sećati se (to remember) ──────────────────────
    { sr:'Ona se ___ prvog dana.',        en:'She remembers the first day.',     answer:'seća',    options:['sećam','sećaš','seća','sećaju'],           hint:'sećati se (to remember) — 3rd sg. present' },
    // ─── zaboraviti (to forget) ───────────────────────
    { sr:'Ja sam ___ da kupim hleb.',     en:'I forgot to buy bread. (masc.)',   answer:'zaboravio', options:['zaboravio','zaboravila','zaboravili','zaboraviti'], hint:'zaboraviti (to forget) — past, masc. sg.' },
    // ─── objasniti (to explain) ───────────────────────
    { sr:'Ona je ___ pravila igre.',      en:'She explained the rules of the game.', answer:'objasnila', options:['objasnio','objasnila','objasnili','objasnile'], hint:'objasniti (to explain) — past, fem. sg.' },
    // ─── pozvati (to invite) ──────────────────────────
    { sr:'On je ___ sve prijatelje.',     en:'He invited all his friends.',      answer:'pozvao',  options:['pozvao','pozvala','pozvali','pozvale'],     hint:'pozvati (to invite) — past, masc. sg.' },
    // ─── future tense ─────────────────────────────────
    { sr:'Ja ___ raditi sutra.',          en:'I will work tomorrow.',            answer:'ću',      options:['ću','ćeš','će','ćemo'],                    hint:'future I (ću) — 1st sg.' },
    { sr:'Ti ___ govoriti srpski.',       en:'You will speak Serbian.',          answer:'ćeš',     options:['ću','ćeš','će','ćete'],                    hint:'future I (ćeš) — 2nd sg.' },
    { sr:'Ona ___ doći sutra.',           en:'She will come tomorrow.',          answer:'će',      options:['ću','ćeš','će','ćemo'],                    hint:'future I (će) — 3rd sg.' },
    { sr:'Mi ___ putovati leti.',         en:'We will travel in the summer.',    answer:'ćemo',    options:['ću','će','ćemo','ćete'],                   hint:'future I (ćemo) — 1st pl.' },
    { sr:'Vi ___ naučiti srpski.',        en:'You (pl.) will learn Serbian.',    answer:'ćete',    options:['ću','ćeš','ćemo','ćete'],                  hint:'future I (ćete) — 2nd pl.' },
    { sr:'Oni ___ stići na vreme.',       en:'They will arrive on time.',        answer:'će',      options:['ću','ćeš','će','ćemo'],                    hint:'future I (će) — 3rd pl.' },
    { sr:'Ja ___ da kupim hleb.',         en:'I will buy bread.',                answer:'ću',      options:['ću','ćeš','će','ćemo'],                    hint:'future I with da (ću) — 1st sg.' },
    { sr:'On ___ da pita nastavnika.',    en:'He will ask the teacher.',         answer:'će',      options:['ću','ćeš','će','ćemo'],                    hint:'future I with da (će) — 3rd sg.' },
    { sr:'Mi ___ da učimo zajedno.',      en:'We will study together.',          answer:'ćemo',    options:['ću','će','ćemo','ćete'],                   hint:'future I with da (ćemo) — 1st pl.' },
    { sr:'Sutra ___ lepo vreme.',         en:'Tomorrow the weather will be nice.',answer:'će biti', options:['će biti','ću biti','ćemo biti','ćete biti'], hint:'future I (će biti) — 3rd sg.' },
    { sr:'Ona ___ u Beograd sledeće nedelje.', en:'She will go to Belgrade next week.', answer:'će ići', options:['će ići','ću ići','ćemo ići','ćete ići'], hint:'future I (će ići) — 3rd sg.' },
  ];

  // ═══════════════════════════════════════════════════
  //  FLASHCARD STORAGE
  // ═══════════════════════════════════════════════════
  const STORAGE_KEY = 'serbian_cards';
  const CARDS_VER   = '5';

  const DEFAULT_CARDS = [
    // ── GREETINGS ─────────────────────────────────────────────────────────
    { serbian:'zdravo',        english:'hello',                    category:'Greetings' },
    { serbian:'doviđenja',     english:'goodbye',                   category:'Greetings' },
    { serbian:'hvala',         english:'thank you',                 category:'Greetings' },
    { serbian:'molim',         english:"please / you're welcome",   category:'Greetings' },
    { serbian:'dobro jutro',   english:'good morning',              category:'Greetings' },
    { serbian:'dobro veče',    english:'good evening',              category:'Greetings' },
    { serbian:'laku noć',      english:'good night',                category:'Greetings' },
    { serbian:'kako si?',      english:'how are you? (informal)',   category:'Greetings' },
    { serbian:'kako ste?',     english:'how are you? (formal)',     category:'Greetings' },
    { serbian:'dobro',         english:'fine / well',               category:'Greetings' },
    { serbian:'izvini',        english:'excuse me / sorry (inf.)',  category:'Greetings' },
    { serbian:'izvinite',      english:'excuse me (formal)',        category:'Greetings' },
    // ── BASICS ────────────────────────────────────────────────────────────
    { serbian:'da',            english:'yes',                       category:'Basics' },
    { serbian:'ne',            english:'no',                        category:'Basics' },
    { serbian:'možda',         english:'maybe',                     category:'Basics' },
    { serbian:'naravno',       english:'of course',                 category:'Basics' },
    { serbian:'u redu',        english:'OK / alright',              category:'Basics' },
    { serbian:'razumem',       english:'I understand',              category:'Basics' },
    { serbian:'ne razumem',    english:"I don't understand",        category:'Basics' },
    { serbian:'ovde',          english:'here',                      category:'Basics' },
    { serbian:'tamo',          english:'there',                     category:'Basics' },
    { serbian:'sada',          english:'now',                       category:'Basics' },
    { serbian:'malo',          english:'a little / a bit',          category:'Basics' },
    { serbian:'mnogo',         english:'a lot / many',              category:'Basics' },
    { serbian:'ovo',           english:'this',                      category:'Basics' },
    { serbian:'ono',           english:'that',                      category:'Basics' },
    { serbian:'ko',            english:'who',                       category:'Basics' },
    { serbian:'šta',           english:'what',                      category:'Basics' },
    { serbian:'gde',           english:'where',                     category:'Basics' },
    { serbian:'kada',          english:'when',                      category:'Basics' },
    { serbian:'zašto',         english:'why',                       category:'Basics' },
    { serbian:'kako',          english:'how',                       category:'Basics' },
    // ── NUMBERS ───────────────────────────────────────────────────────────
    { serbian:'jedan',         english:'one',                       category:'Numbers' },
    { serbian:'dva',           english:'two',                       category:'Numbers' },
    { serbian:'tri',           english:'three',                     category:'Numbers' },
    { serbian:'četiri',        english:'four',                      category:'Numbers' },
    { serbian:'pet',           english:'five',                      category:'Numbers' },
    { serbian:'šest',          english:'six',                       category:'Numbers' },
    { serbian:'sedam',         english:'seven',                     category:'Numbers' },
    { serbian:'osam',          english:'eight',                     category:'Numbers' },
    { serbian:'devet',         english:'nine',                      category:'Numbers' },
    { serbian:'deset',         english:'ten',                       category:'Numbers' },
    { serbian:'dvadeset',      english:'twenty',                    category:'Numbers' },
    { serbian:'sto',           english:'one hundred',               category:'Numbers' },
    { serbian:'hiljada',       english:'one thousand',              category:'Numbers' },
    { serbian:'prvi',          english:'first',                     category:'Numbers' },
    { serbian:'drugi',         english:'second',                    category:'Numbers' },
    { serbian:'treći',         english:'third',                     category:'Numbers' },
    // ── FOOD & DRINK ──────────────────────────────────────────────────────
    { serbian:'voda',          english:'water',                     category:'Food & Drink' },
    { serbian:'hleb',          english:'bread',                     category:'Food & Drink' },
    { serbian:'kafa',          english:'coffee',                    category:'Food & Drink' },
    { serbian:'čaj',           english:'tea',                       category:'Food & Drink' },
    { serbian:'mleko',         english:'milk',                      category:'Food & Drink' },
    { serbian:'sok',           english:'juice',                     category:'Food & Drink' },
    { serbian:'pivo',          english:'beer',                      category:'Food & Drink' },
    { serbian:'vino',          english:'wine',                      category:'Food & Drink' },
    { serbian:'meso',          english:'meat',                      category:'Food & Drink' },
    { serbian:'riba',          english:'fish',                      category:'Food & Drink' },
    { serbian:'piletina',      english:'chicken',                   category:'Food & Drink' },
    { serbian:'jaje',          english:'egg',                       category:'Food & Drink' },
    { serbian:'sir',           english:'cheese',                    category:'Food & Drink' },
    { serbian:'salata',        english:'salad',                     category:'Food & Drink' },
    { serbian:'supa',          english:'soup',                      category:'Food & Drink' },
    { serbian:'krompir',       english:'potato',                    category:'Food & Drink' },
    { serbian:'jabuka',        english:'apple',                     category:'Food & Drink' },
    { serbian:'paradajz',      english:'tomato',                    category:'Food & Drink' },
    { serbian:'šećer',         english:'sugar',                     category:'Food & Drink' },
    { serbian:'so',            english:'salt',                      category:'Food & Drink' },
    { serbian:'ulje',          english:'oil',                       category:'Food & Drink' },
    { serbian:'restoran',      english:'restaurant',                category:'Food & Drink' },
    { serbian:'račun',         english:'bill / check',              category:'Food & Drink' },
    { serbian:'doručak',       english:'breakfast',                 category:'Food & Drink' },
    { serbian:'ručak',         english:'lunch',                     category:'Food & Drink' },
    { serbian:'večera',        english:'dinner',                    category:'Food & Drink' },
    // ── PLACES ────────────────────────────────────────────────────────────
    { serbian:'kuća',          english:'house',                     category:'Places' },
    { serbian:'ulica',         english:'street',                    category:'Places' },
    { serbian:'grad',          english:'city / town',               category:'Places' },
    { serbian:'selo',          english:'village',                   category:'Places' },
    { serbian:'zemlja',        english:'country / land',            category:'Places' },
    { serbian:'bolnica',       english:'hospital',                  category:'Places' },
    { serbian:'prodavnica',    english:'store / shop',              category:'Places' },
    { serbian:'pijaca',        english:'market',                    category:'Places' },
    { serbian:'park',          english:'park',                      category:'Places' },
    { serbian:'hotel',         english:'hotel',                     category:'Places' },
    { serbian:'aerodrom',      english:'airport',                   category:'Places' },
    { serbian:'stanica',       english:'station',                   category:'Places' },
    { serbian:'crkva',         english:'church',                    category:'Places' },
    { serbian:'muzej',         english:'museum',                    category:'Places' },
    { serbian:'bioskop',       english:'cinema',                    category:'Places' },
    { serbian:'banka',         english:'bank',                      category:'Places' },
    { serbian:'apoteka',       english:'pharmacy',                  category:'Places' },
    { serbian:'planina',       english:'mountain',                  category:'Places' },
    { serbian:'šuma',          english:'forest',                    category:'Places' },
    { serbian:'most',          english:'bridge',                    category:'Places' },
    { serbian:'more',          english:'sea',                       category:'Places' },
    { serbian:'reka',          english:'river',                     category:'Places' },
    // ── ANIMALS ───────────────────────────────────────────────────────────
    { serbian:'pas',           english:'dog',                       category:'Animals' },
    { serbian:'mačka',         english:'cat',                       category:'Animals' },
    { serbian:'konj',          english:'horse',                     category:'Animals' },
    { serbian:'krava',         english:'cow',                       category:'Animals' },
    { serbian:'ovca',          english:'sheep',                     category:'Animals' },
    { serbian:'svinja',        english:'pig',                       category:'Animals' },
    { serbian:'kokoška',       english:'hen / chicken',             category:'Animals' },
    { serbian:'ptica',         english:'bird',                      category:'Animals' },
    { serbian:'zec',           english:'rabbit',                    category:'Animals' },
    { serbian:'medved',        english:'bear',                      category:'Animals' },
    { serbian:'vuk',           english:'wolf',                      category:'Animals' },
    { serbian:'lisica',        english:'fox',                       category:'Animals' },
    { serbian:'miš',           english:'mouse',                     category:'Animals' },
    { serbian:'lav',           english:'lion',                      category:'Animals' },
    { serbian:'tigar',         english:'tiger',                     category:'Animals' },
    { serbian:'slon',          english:'elephant',                  category:'Animals' },
    { serbian:'zmija',         english:'snake',                     category:'Animals' },
    // ── PEOPLE ────────────────────────────────────────────────────────────
    { serbian:'prijatelj',     english:'friend (m)',                category:'People' },
    { serbian:'prijateljica',  english:'friend (f)',                category:'People' },
    { serbian:'porodica',      english:'family',                    category:'People' },
    { serbian:'otac',          english:'father',                    category:'People' },
    { serbian:'majka',         english:'mother',                    category:'People' },
    { serbian:'kćerka',        english:'daughter',                  category:'People' },
    { serbian:'dečak',         english:'boy',                       category:'People' },
    { serbian:'devojka',       english:'girl / young woman',        category:'People' },
    { serbian:'beba',          english:'baby',                      category:'People' },
    { serbian:'dete',          english:'child',                     category:'People' },
    { serbian:'muž',           english:'husband',                   category:'People' },
    { serbian:'supruga',       english:'wife',                      category:'People' },
    { serbian:'deda',          english:'grandfather',               category:'People' },
    { serbian:'baka',          english:'grandmother',               category:'People' },
    { serbian:'komšija',       english:'neighbor',                  category:'People' },
    { serbian:'stranac',       english:'foreigner / stranger',      category:'People' },
    { serbian:'učitelj',       english:'teacher (m)',               category:'People' },
    { serbian:'doktor',        english:'doctor',                    category:'People' },
    // ── TIME ──────────────────────────────────────────────────────────────
    { serbian:'dan',           english:'day',                       category:'Time' },
    { serbian:'noć',           english:'night',                     category:'Time' },
    { serbian:'sat',           english:"hour / o'clock",            category:'Time' },
    { serbian:'minuta',        english:'minute',                    category:'Time' },
    { serbian:'jutro',         english:'morning',                   category:'Time' },
    { serbian:'podne',         english:'noon / midday',             category:'Time' },
    { serbian:'veče',          english:'evening',                   category:'Time' },
    { serbian:'nedelja',       english:'week / Sunday',             category:'Time' },
    { serbian:'mesec',         english:'month / moon',              category:'Time' },
    { serbian:'godina',        english:'year',                      category:'Time' },
    { serbian:'danas',         english:'today',                     category:'Time' },
    { serbian:'juče',          english:'yesterday',                 category:'Time' },
    { serbian:'sutra',         english:'tomorrow',                  category:'Time' },
    { serbian:'ponedeljak',    english:'Monday',                    category:'Time' },
    { serbian:'utorak',        english:'Tuesday',                   category:'Time' },
    { serbian:'sreda',         english:'Wednesday',                 category:'Time' },
    { serbian:'četvrtak',      english:'Thursday',                  category:'Time' },
    { serbian:'petak',         english:'Friday',                    category:'Time' },
    { serbian:'subota',        english:'Saturday',                  category:'Time' },
    { serbian:'proleće',       english:'spring',                    category:'Time' },
    { serbian:'leto',          english:'summer',                    category:'Time' },
    { serbian:'jesen',         english:'autumn / fall',             category:'Time' },
    { serbian:'zima',          english:'winter',                    category:'Time' },
    // ── COLORS ────────────────────────────────────────────────────────────
    { serbian:'crvena',        english:'red',                       category:'Colors' },
    { serbian:'plava',         english:'blue',                      category:'Colors' },
    { serbian:'zelena',        english:'green',                     category:'Colors' },
    { serbian:'žuta',          english:'yellow',                    category:'Colors' },
    { serbian:'narandžasta',   english:'orange',                    category:'Colors' },
    { serbian:'ljubičasta',    english:'purple',                    category:'Colors' },
    { serbian:'crna',          english:'black',                     category:'Colors' },
    { serbian:'bela',          english:'white',                     category:'Colors' },
    { serbian:'siva',          english:'gray',                      category:'Colors' },
    { serbian:'smeđa',         english:'brown',                     category:'Colors' },
    { serbian:'roze',          english:'pink',                      category:'Colors' },
    // ── BODY ──────────────────────────────────────────────────────────────
    { serbian:'glava',         english:'head',                      category:'Body' },
    { serbian:'lice',          english:'face',                      category:'Body' },
    { serbian:'oko',           english:'eye',                       category:'Body' },
    { serbian:'uho',           english:'ear',                       category:'Body' },
    { serbian:'nos',           english:'nose',                      category:'Body' },
    { serbian:'usta',          english:'mouth',                     category:'Body' },
    { serbian:'zub',           english:'tooth',                     category:'Body' },
    { serbian:'ruka',          english:'hand / arm',                category:'Body' },
    { serbian:'noga',          english:'leg / foot',                category:'Body' },
    { serbian:'srce',          english:'heart',                     category:'Body' },
    { serbian:'stomak',        english:'stomach',                   category:'Body' },
    { serbian:'leđa',          english:'back',                      category:'Body' },
    { serbian:'kosa',          english:'hair',                      category:'Body' },
    { serbian:'prst',          english:'finger / toe',              category:'Body' },
    { serbian:'koža',          english:'skin',                      category:'Body' },
    // ── HOME ──────────────────────────────────────────────────────────────
    { serbian:'soba',          english:'room',                      category:'Home' },
    { serbian:'kuhinja',       english:'kitchen',                   category:'Home' },
    { serbian:'kupatilo',      english:'bathroom',                  category:'Home' },
    { serbian:'spavaća soba',  english:'bedroom',                   category:'Home' },
    { serbian:'dnevna soba',   english:'living room',               category:'Home' },
    { serbian:'sto',           english:'table',                     category:'Home' },
    { serbian:'stolica',       english:'chair',                     category:'Home' },
    { serbian:'krevet',        english:'bed',                       category:'Home' },
    { serbian:'vrata',         english:'door',                      category:'Home' },
    { serbian:'prozor',        english:'window',                    category:'Home' },
    { serbian:'pod',           english:'floor',                     category:'Home' },
    { serbian:'zid',           english:'wall',                      category:'Home' },
    { serbian:'plafon',        english:'ceiling',                   category:'Home' },
    { serbian:'lampa',         english:'lamp',                      category:'Home' },
    { serbian:'frižider',      english:'refrigerator',              category:'Home' },
    { serbian:'ogledalo',      english:'mirror',                    category:'Home' },
    { serbian:'šporet',        english:'stove / cooker',            category:'Home' },
    // ── VERBS ─────────────────────────────────────────────────────────────
    { serbian:'biti',          english:'to be',                     category:'Verbs' },
    { serbian:'imati',         english:'to have',                   category:'Verbs' },
    { serbian:'ići',           english:'to go',                     category:'Verbs' },
    { serbian:'doći',          english:'to come',                   category:'Verbs' },
    { serbian:'videti',        english:'to see',                    category:'Verbs' },
    { serbian:'jesti',         english:'to eat',                    category:'Verbs' },
    { serbian:'piti',          english:'to drink',                  category:'Verbs' },
    { serbian:'govoriti',      english:'to speak / to talk',        category:'Verbs' },
    { serbian:'razumeti',      english:'to understand',             category:'Verbs' },
    { serbian:'čuti',          english:'to hear',                   category:'Verbs' },
    { serbian:'znati',         english:'to know',                   category:'Verbs' },
    { serbian:'moći',          english:'can / to be able to',       category:'Verbs' },
    { serbian:'hteti',         english:'to want',                   category:'Verbs' },
    { serbian:'voleti',        english:'to love / to like',         category:'Verbs' },
    { serbian:'raditi',        english:'to work / to do',           category:'Verbs' },
    { serbian:'živeti',        english:'to live',                   category:'Verbs' },
    { serbian:'čitati',        english:'to read',                   category:'Verbs' },
    { serbian:'pisati',        english:'to write',                  category:'Verbs' },
    { serbian:'spavati',       english:'to sleep',                  category:'Verbs' },
    { serbian:'kupiti',        english:'to buy',                    category:'Verbs' },
    { serbian:'tražiti',       english:'to look for / to ask for',  category:'Verbs' },
    { serbian:'dati',          english:'to give',                   category:'Verbs' },
    // ── ADJECTIVES ────────────────────────────────────────────────────────
    { serbian:'dobar',         english:'good',                      category:'Adjectives' },
    { serbian:'loš',           english:'bad',                       category:'Adjectives' },
    { serbian:'velik',         english:'big / large',               category:'Adjectives' },
    { serbian:'mali',          english:'small / little',            category:'Adjectives' },
    { serbian:'nov',           english:'new',                       category:'Adjectives' },
    { serbian:'star',          english:'old',                       category:'Adjectives' },
    { serbian:'lep',           english:'beautiful / nice',          category:'Adjectives' },
    { serbian:'brz',           english:'fast / quick',              category:'Adjectives' },
    { serbian:'spor',          english:'slow',                      category:'Adjectives' },
    { serbian:'topao',         english:'warm',                      category:'Adjectives' },
    { serbian:'hladan',        english:'cold',                      category:'Adjectives' },
    { serbian:'vruć',          english:'hot',                       category:'Adjectives' },
    { serbian:'težak',         english:'heavy / difficult',         category:'Adjectives' },
    { serbian:'lak',           english:'light / easy',              category:'Adjectives' },
    { serbian:'skup',          english:'expensive',                 category:'Adjectives' },
    { serbian:'jeftin',        english:'cheap',                     category:'Adjectives' },
    { serbian:'srećan',        english:'happy',                     category:'Adjectives' },
    { serbian:'tužan',         english:'sad',                       category:'Adjectives' },
    { serbian:'gladan',        english:'hungry',                    category:'Adjectives' },
    { serbian:'žedan',         english:'thirsty',                   category:'Adjectives' },
    { serbian:'jak',           english:'strong',                    category:'Adjectives' },
    { serbian:'slab',          english:'weak',                      category:'Adjectives' },
    // ── PREPOSITIONS ──────────────────────────────────────────────────────
    { serbian:'u',       english:'in / into',              category:'Prepositions', note:'motion → + Accusative\nidem u školu  (I go to school)\n\nposition → + Locative\nživim u gradu  (I live in the city)' },
    { serbian:'na',      english:'on / onto / at',         category:'Prepositions', note:'motion → + Accusative\nstaviću na sto  (I will put it on the table)\n\nposition → + Locative\nknjiga je na stolu  (the book is on the table)' },
    { serbian:'od',      english:'from / of',              category:'Prepositions', note:'+ Genitive\nod majke  (from mother)' },
    { serbian:'do',      english:'to / until / up to',     category:'Prepositions', note:'+ Genitive\ndo škole  (to school / until school)' },
    { serbian:'iz',      english:'from / out of',          category:'Prepositions', note:'+ Genitive\niz Beograda  (from Belgrade)' },
    { serbian:'za',      english:'for / behind',           category:'Prepositions', note:'purpose → + Accusative\nkupujem za tebe  (I am buying for you)\n\nbehind → + Instrumental\nza stolom  (behind the table)' },
    { serbian:'sa',      english:'with / off of',          category:'Prepositions', note:'together → + Instrumental\nsa prijateljem  (with a friend)\n\nfrom off → + Genitive\nsa stola  (off the table)' },
    { serbian:'kod',     english:'at / by / near',         category:'Prepositions', note:'+ Genitive\nkod kuće  (at home)' },
    { serbian:'bez',     english:'without',                category:'Prepositions', note:'+ Genitive\nbez vode  (without water)' },
    { serbian:'kroz',    english:'through',                category:'Prepositions', note:'+ Accusative\nkroz šumu  (through the forest)' },
    { serbian:'prema',   english:'toward / according to',  category:'Prepositions', note:'+ Dative\nprema gradu  (toward the city)' },
    { serbian:'između',  english:'between',                category:'Prepositions', note:'+ Genitive\nizmeđu kuća  (between the houses)' },
    { serbian:'pored',   english:'next to / beside',       category:'Prepositions', note:'+ Genitive\npored reke  (beside the river)' },
    { serbian:'ispred',  english:'in front of',            category:'Prepositions', note:'+ Genitive\nispred škole  (in front of the school)' },
    { serbian:'iza',     english:'behind',                 category:'Prepositions', note:'+ Genitive\niza zgrade  (behind the building)' },
    { serbian:'iznad',   english:'above / over',           category:'Prepositions', note:'+ Genitive\niznad grada  (above the city)' },
    { serbian:'ispod',   english:'under / below',          category:'Prepositions', note:'+ Genitive\nispod mosta  (below the bridge)' },
    { serbian:'oko',     english:'around / about (time)',  category:'Prepositions', note:'+ Genitive\noko stola  (around the table)' },
    { serbian:'zbog',    english:'because of / due to',    category:'Prepositions', note:'+ Genitive\nzbog kiše  (because of the rain)' },
    { serbian:'posle',   english:'after',                  category:'Prepositions', note:'+ Genitive\nposle ručka  (after lunch)' },
    { serbian:'pre',     english:'before',                 category:'Prepositions', note:'+ Genitive\npre večere  (before dinner)' },
    { serbian:'tokom',   english:'during',                 category:'Prepositions', note:'+ Genitive\ntokom leta  (during summer)' },
    { serbian:'po',      english:'around / along / per',   category:'Prepositions', note:'+ Dative\nšetam po gradu  (I walk around town)' },
    { serbian:'nad',     english:'above / over (dominant)', category:'Prepositions', note:'+ Instrumental\nnad selom  (above the village)' },
    { serbian:'pod',     english:'under / below (static)', category:'Prepositions', note:'+ Instrumental\npod stolom  (under the table)' },
    { serbian:'pred',    english:'in front of / before',   category:'Prepositions', note:'static → + Instrumental\npred kućom  (in front of the house)\n\nmotion → + Accusative\npred kuću  (toward the front of the house)' },
    { serbian:'pri',     english:'at / near / upon',       category:'Prepositions', note:'+ Locative\npri kraju  (near the end)' },
    { serbian:'o',       english:'about / concerning',     category:'Prepositions', note:'+ Locative\npričam o tome  (I talk about that)' },
    { serbian:'ka',      english:'toward (direction)',     category:'Prepositions', note:'+ Dative\nka moru  (toward the sea)' },
    // ── PHRASES ───────────────────────────────────────────────────────────
    { serbian:'Kako se zoveš?',              english:"What's your name? (inf.)",          category:'Phrases' },
    { serbian:'Zovem se…',                   english:'My name is…',                        category:'Phrases' },
    { serbian:'Odakle si?',                  english:'Where are you from? (inf.)',         category:'Phrases' },
    { serbian:'Ja sam iz Amerike.',          english:'I am from America.',                 category:'Phrases' },
    { serbian:'Koliko imaš godina?',         english:'How old are you? (inf.)',            category:'Phrases' },
    { serbian:'Imam dvadeset godina.',       english:'I am twenty years old.',             category:'Phrases' },
    { serbian:'Govorite li engleski?',       english:'Do you speak English? (formal)',     category:'Phrases' },
    { serbian:'Ne govorim srpski.',          english:"I don't speak Serbian.",             category:'Phrases' },
    { serbian:'Govorim malo srpski.',        english:'I speak a little Serbian.',          category:'Phrases' },
    { serbian:'Molim, ponovite.',            english:'Please repeat that. (formal)',       category:'Phrases' },
    { serbian:'Govorite sporije, molim.',    english:'Please speak more slowly.',          category:'Phrases' },
    { serbian:'Nisam razumeo.',              english:"I didn't understand. (masc.)",       category:'Phrases' },
    { serbian:'Možete li mi pomoći?',        english:'Can you help me? (formal)',          category:'Phrases' },
    { serbian:'Gde je toalet?',              english:'Where is the bathroom?',             category:'Phrases' },
    { serbian:'Koliko košta?',               english:'How much does it cost?',             category:'Phrases' },
    { serbian:'Koliko je sati?',             english:'What time is it?',                   category:'Phrases' },
    { serbian:'Kada kreće autobus?',         english:'When does the bus leave?',           category:'Phrases' },
    { serbian:'Jedna karta do Beograda.',    english:'One ticket to Belgrade.',            category:'Phrases' },
    { serbian:'Gde mogu da kupim karte?',    english:'Where can I buy tickets?',           category:'Phrases' },
    { serbian:'Nazovite mi taksi, molim.',   english:'Please call me a taxi.',             category:'Phrases' },
    { serbian:'Imam rezervaciju.',           english:'I have a reservation.',              category:'Phrases' },
    { serbian:'Jedan sto za dvoje.',         english:'A table for two.',                   category:'Phrases' },
    { serbian:'Šta preporučujete?',          english:'What do you recommend?',             category:'Phrases' },
    { serbian:'Donesite mi račun, molim.',   english:'Bring me the bill, please.',         category:'Phrases' },
    { serbian:'Bilo je ukusno.',             english:'It was delicious.',                  category:'Phrases' },
    { serbian:'Živeli!',                     english:'Cheers!',                            category:'Phrases' },
    { serbian:'Prijatno!',                   english:'Bon appétit!',                       category:'Phrases' },
    { serbian:'Sviđa mi se.',                english:'I like it.',                         category:'Phrases' },
    { serbian:'Ne sviđa mi se.',             english:"I don't like it.",                   category:'Phrases' },
    { serbian:'Veoma je lepo.',              english:'It is very beautiful.',              category:'Phrases' },
    { serbian:'Nema problema.',              english:'No problem.',                        category:'Phrases' },
    { serbian:'Svejedno mi je.',             english:"I don't mind. / All the same.",      category:'Phrases' },
    { serbian:'Sretan put!',                 english:'Have a good trip!',                  category:'Phrases' },
    { serbian:'Srećan rođendan!',            english:'Happy birthday!',                    category:'Phrases' },
    { serbian:'Srećna Nova Godina!',         english:'Happy New Year!',                    category:'Phrases' },
    { serbian:'Čestitamo!',                  english:'Congratulations!',                   category:'Phrases' },
    { serbian:'Sve najbolje!',               english:'All the best!',                      category:'Phrases' },
    { serbian:'Boli me glava.',              english:'I have a headache.',                 category:'Phrases' },
    { serbian:'Nisam dobro.',                english:"I'm not well.",                      category:'Phrases' },
    { serbian:'Zovite doktora!',             english:'Call a doctor!',                     category:'Phrases' },
    { serbian:'Izgubio sam se.',             english:"I'm lost. (masc.)",                  category:'Phrases' },
    { serbian:'Izgubila sam se.',            english:"I'm lost. (fem.)",                   category:'Phrases' },
    { serbian:'Pomozite!',                   english:'Help!',                              category:'Phrases' },
    { serbian:'Volim te.',                   english:'I love you.',                        category:'Phrases' },
    { serbian:'Nedostaješ mi.',              english:'I miss you.',                        category:'Phrases' },
    { serbian:'Idemo zajedno.',              english:"Let's go together.",                 category:'Phrases' },
    { serbian:'Šta radiš večeras?',          english:'What are you doing tonight?',        category:'Phrases' },
    { serbian:'Želim da naručim…',           english:'I would like to order…',             category:'Phrases' },
    { serbian:'Ima li slobodnih soba?',      english:'Are there any rooms available?',     category:'Phrases' },
    { serbian:'Koliko dugo traje put?',      english:'How long does the trip take?',       category:'Phrases' },
    { serbian:'Biće dobro.',                 english:'It will be okay.',                   category:'Phrases' },
    { serbian:'Drago mi je.',                english:'Nice to meet you.',                  category:'Phrases' },
    { serbian:'Gde se nalazimo?',            english:'Where are we?',                      category:'Phrases' },
    // ── VERBS II ──────────────────────────────────────────────────────────
    { serbian:'misliti',       english:'to think',                  category:'Verbs II' },
    { serbian:'čekati',        english:'to wait',                   category:'Verbs II' },
    { serbian:'pričati',       english:'to talk / to tell',         category:'Verbs II' },
    { serbian:'slušati',       english:'to listen',                 category:'Verbs II' },
    { serbian:'gledati',       english:'to watch / to look at',     category:'Verbs II' },
    { serbian:'sedeti',        english:'to sit',                    category:'Verbs II' },
    { serbian:'stajati',       english:'to stand',                  category:'Verbs II' },
    { serbian:'hodati',        english:'to walk',                   category:'Verbs II' },
    { serbian:'trčati',        english:'to run',                    category:'Verbs II' },
    { serbian:'plakati',       english:'to cry',                    category:'Verbs II' },
    { serbian:'smejati se',    english:'to laugh',                  category:'Verbs II' },
    { serbian:'pevati',        english:'to sing',                   category:'Verbs II' },
    { serbian:'igrati se',     english:'to play',                   category:'Verbs II' },
    { serbian:'učiti',         english:'to study / to learn',       category:'Verbs II' },
    { serbian:'otvoriti',      english:'to open',                   category:'Verbs II' },
    { serbian:'zatvoriti',     english:'to close',                  category:'Verbs II' },
    { serbian:'platiti',       english:'to pay',                    category:'Verbs II' },
    { serbian:'nositi',        english:'to carry / to wear',        category:'Verbs II' },
    { serbian:'padati',        english:'to fall',                   category:'Verbs II' },
    { serbian:'brinuti se',    english:'to worry',                  category:'Verbs II' },
    { serbian:'čuvati',        english:'to take care of / to keep', category:'Verbs II' },
    { serbian:'sećati se',     english:'to remember',               category:'Verbs II' },
    { serbian:'zaboraviti',    english:'to forget',                 category:'Verbs II' },
    { serbian:'objasniti',     english:'to explain',                category:'Verbs II' },
    { serbian:'pozvati',       english:'to invite / to call',       category:'Verbs II' },
    // ── TRANSPORTATION ────────────────────────────────────────────────────
    { serbian:'voz',           english:'train',                     category:'Transportation' },
    { serbian:'autobus',       english:'bus',                       category:'Transportation' },
    { serbian:'tramvaj',       english:'tram',                      category:'Transportation' },
    { serbian:'taksi',         english:'taxi',                      category:'Transportation' },
    { serbian:'auto',          english:'car',                       category:'Transportation' },
    { serbian:'avion',         english:'airplane',                  category:'Transportation' },
    { serbian:'brod',          english:'ship / boat',               category:'Transportation' },
    { serbian:'bicikl',        english:'bicycle',                   category:'Transportation' },
    { serbian:'karta',         english:'ticket',                    category:'Transportation' },
    { serbian:'polazak',       english:'departure',                 category:'Transportation' },
    { serbian:'dolazak',       english:'arrival',                   category:'Transportation' },
    { serbian:'vozni red',     english:'timetable / schedule',      category:'Transportation' },
    { serbian:'peron',         english:'platform',                  category:'Transportation' },
    { serbian:'autoput',       english:'highway / motorway',        category:'Transportation' },
    { serbian:'raskrsnica',    english:'intersection / crossroads', category:'Transportation' },
    { serbian:'semafor',       english:'traffic light',             category:'Transportation' },
    { serbian:'kašnjenje',     english:'delay',                     category:'Transportation' },
    { serbian:'let',           english:'flight',                    category:'Transportation' },
    { serbian:'levo',          english:'left',                      category:'Transportation' },
    { serbian:'desno',         english:'right',                     category:'Transportation' },
    // ── CLOTHING ──────────────────────────────────────────────────────────
    { serbian:'košulja',       english:'shirt',                     category:'Clothing' },
    { serbian:'majica',        english:'t-shirt',                   category:'Clothing' },
    { serbian:'pantalone',     english:'pants / trousers',          category:'Clothing' },
    { serbian:'farmerke',      english:'jeans',                     category:'Clothing' },
    { serbian:'haljina',       english:'dress',                     category:'Clothing' },
    { serbian:'suknja',        english:'skirt',                     category:'Clothing' },
    { serbian:'jakna',         english:'jacket',                    category:'Clothing' },
    { serbian:'kaput',         english:'coat',                      category:'Clothing' },
    { serbian:'čarape',        english:'socks',                     category:'Clothing' },
    { serbian:'cipele',        english:'shoes',                     category:'Clothing' },
    { serbian:'čizme',         english:'boots',                     category:'Clothing' },
    { serbian:'patike',        english:'sneakers',                  category:'Clothing' },
    { serbian:'kapa',          english:'hat / cap',                 category:'Clothing' },
    { serbian:'šal',           english:'scarf',                     category:'Clothing' },
    { serbian:'rukavice',      english:'gloves',                    category:'Clothing' },
    { serbian:'džemper',       english:'sweater / jumper',          category:'Clothing' },
    { serbian:'duks',          english:'hoodie / sweatshirt',       category:'Clothing' },
    { serbian:'torbica',       english:'bag / handbag',             category:'Clothing' },
    { serbian:'pojas',         english:'belt',                      category:'Clothing' },
    { serbian:'naočare',       english:'glasses',                   category:'Clothing' },
    // ── NATURE & WEATHER ──────────────────────────────────────────────────
    { serbian:'sunce',         english:'sun',                       category:'Nature & Weather' },
    { serbian:'zvezda',        english:'star',                      category:'Nature & Weather' },
    { serbian:'oblak',         english:'cloud',                     category:'Nature & Weather' },
    { serbian:'kiša',          english:'rain',                      category:'Nature & Weather' },
    { serbian:'sneg',          english:'snow',                      category:'Nature & Weather' },
    { serbian:'vetar',         english:'wind',                      category:'Nature & Weather' },
    { serbian:'oluja',         english:'storm',                     category:'Nature & Weather' },
    { serbian:'grmljavina',    english:'thunder',                   category:'Nature & Weather' },
    { serbian:'munja',         english:'lightning',                 category:'Nature & Weather' },
    { serbian:'magla',         english:'fog',                       category:'Nature & Weather' },
    { serbian:'led',           english:'ice',                       category:'Nature & Weather' },
    { serbian:'nebo',          english:'sky',                       category:'Nature & Weather' },
    { serbian:'vatra',         english:'fire',                      category:'Nature & Weather' },
    { serbian:'kamen',         english:'stone / rock',              category:'Nature & Weather' },
    { serbian:'pesak',         english:'sand',                      category:'Nature & Weather' },
    { serbian:'jezero',        english:'lake',                      category:'Nature & Weather' },
    { serbian:'polje',         english:'field',                     category:'Nature & Weather' },
    { serbian:'brdo',          english:'hill',                      category:'Nature & Weather' },
    { serbian:'trava',         english:'grass',                     category:'Nature & Weather' },
    { serbian:'cvet',          english:'flower',                    category:'Nature & Weather' },
    // ── SCHOOL & WORK ─────────────────────────────────────────────────────
    { serbian:'škola',         english:'school',                    category:'School & Work' },
    { serbian:'fakultet',      english:'university',                category:'School & Work' },
    { serbian:'razred',        english:'class / classroom',         category:'School & Work' },
    { serbian:'sveska',        english:'notebook',                  category:'School & Work' },
    { serbian:'olovka',        english:'pencil',                    category:'School & Work' },
    { serbian:'tabla',         english:'board / blackboard',        category:'School & Work' },
    { serbian:'ispit',         english:'exam',                      category:'School & Work' },
    { serbian:'ocena',         english:'grade / mark',              category:'School & Work' },
    { serbian:'odmor',         english:'break / vacation',          category:'School & Work' },
    { serbian:'posao',         english:'job / work',                category:'School & Work' },
    { serbian:'kancelarija',   english:'office',                    category:'School & Work' },
    { serbian:'kompjuter',     english:'computer',                  category:'School & Work' },
    { serbian:'telefon',       english:'phone',                     category:'School & Work' },
    { serbian:'mejl',          english:'email',                     category:'School & Work' },
    { serbian:'sastanak',      english:'meeting',                   category:'School & Work' },
    { serbian:'plata',         english:'salary / wages',            category:'School & Work' },
    { serbian:'kolega',        english:'colleague',                 category:'School & Work' },
    { serbian:'šef',           english:'boss',                      category:'School & Work' },
    { serbian:'firma',         english:'company / firm',            category:'School & Work' },
    { serbian:'penzija',       english:'retirement / pension',      category:'School & Work' },

    // ── UNIT 1: NA AERODROMU ──────────────────────────────────────────────
    { serbian:'pasoš',                    english:'passport',                         category:'Unit 1' },
    { serbian:'turista',                  english:'tourist',                          category:'Unit 1' },
    { serbian:'gospodin',                 english:'Mr. / sir',                        category:'Unit 1' },
    { serbian:'gospođa',                  english:'Mrs. / ma\'am',                    category:'Unit 1' },
    { serbian:'drago mi je',              english:'nice to meet you',                 category:'Unit 1' },
    { serbian:'kako se zovete?',          english:'what is your name? (formal)',      category:'Unit 1' },
    { serbian:'zovem se...',              english:'my name is...',                    category:'Unit 1' },
    { serbian:'odakle ste?',              english:'where are you from?',              category:'Unit 1' },
    { serbian:'gde živite?',              english:'where do you live?',               category:'Unit 1' },
    { serbian:'šta radite?',              english:'what do you do?',                  category:'Unit 1' },
    { serbian:'radim kao...',             english:'I work as...',                     category:'Unit 1' },
    { serbian:'učim srpski',              english:'I\'m learning Serbian',            category:'Unit 1' },
    { serbian:'govorim malo srpski',      english:'I speak a little Serbian',         category:'Unit 1' },
    { serbian:'ne govorim srpski',        english:'I don\'t speak Serbian',           category:'Unit 1' },
    { serbian:'razumem mnogo',            english:'I understand a lot',               category:'Unit 1' },
    { serbian:'da li govorite engleski?', english:'do you speak English?',            category:'Unit 1' },
    { serbian:'koji jezik govorite?',     english:'which language do you speak?',     category:'Unit 1' },
    { serbian:'jezik',                    english:'language',                         category:'Unit 1' },
    { serbian:'srpski jezik',             english:'the Serbian language',             category:'Unit 1' },
    { serbian:'engleski jezik',           english:'the English language',             category:'Unit 1' },
    { serbian:'ekonomista',               english:'economist',                        category:'Unit 1' },
    { serbian:'Englez',                   english:'Englishman',                       category:'Unit 1' },
    { serbian:'Engleskinja',              english:'Englishwoman',                     category:'Unit 1' },
    { serbian:'ja sam iz...',             english:'I am from...',                     category:'Unit 1' },
    { serbian:'živim u...',               english:'I live in...',                     category:'Unit 1' },
    { serbian:'da li ste vi...?',         english:'are you...? (formal)',             category:'Unit 1' },
    { serbian:'i ovo je...',              english:'and this is...',                   category:'Unit 1' },
    { serbian:'moj muž',                  english:'my husband',                       category:'Unit 1' },
    { serbian:'moja žena',                english:'my wife',                          category:'Unit 1' },
    { serbian:'lepo',                     english:'nice / beautiful',                 category:'Unit 1' },
    { serbian:'prijatno',                 english:'pleasant / nice to meet you',      category:'Unit 1' },

    // ── UNIT 2: U KAFEU ───────────────────────────────────────────────────
    { serbian:'kafa',                     english:'coffee',                           category:'Unit 2' },
    { serbian:'čaj',                      english:'tea',                              category:'Unit 2' },
    { serbian:'voda',                     english:'water',                            category:'Unit 2' },
    { serbian:'gazirana voda',            english:'sparkling water',                  category:'Unit 2' },
    { serbian:'negazirana voda',          english:'still water',                      category:'Unit 2' },
    { serbian:'sok',                      english:'juice',                            category:'Unit 2' },
    { serbian:'vino',                     english:'wine',                             category:'Unit 2' },
    { serbian:'belo vino',                english:'white wine',                       category:'Unit 2' },
    { serbian:'crno vino',                english:'red wine',                         category:'Unit 2' },
    { serbian:'pivo',                     english:'beer',                             category:'Unit 2' },
    { serbian:'rakija',                   english:'brandy / rakia',                   category:'Unit 2' },
    { serbian:'sendvič',                  english:'sandwich',                         category:'Unit 2' },
    { serbian:'kolač',                    english:'cake / pastry',                    category:'Unit 2' },
    { serbian:'šećer',                    english:'sugar',                            category:'Unit 2' },
    { serbian:'mleko',                    english:'milk',                             category:'Unit 2' },
    { serbian:'šoljica',                  english:'(small) cup',                      category:'Unit 2' },
    { serbian:'čaša',                     english:'glass',                            category:'Unit 2' },
    { serbian:'flaša',                    english:'bottle',                           category:'Unit 2' },
    { serbian:'konobar',                  english:'waiter',                           category:'Unit 2' },
    { serbian:'kelnerica',                english:'waitress',                         category:'Unit 2' },
    { serbian:'račun',                    english:'bill / check',                     category:'Unit 2' },
    { serbian:'koliko košta?',            english:'how much does it cost?',           category:'Unit 2' },
    { serbian:'još nešto?',               english:'anything else?',                   category:'Unit 2' },
    { serbian:'ništa više, hvala',        english:'nothing more, thank you',          category:'Unit 2' },
    { serbian:'dajte mi...',              english:'give me... / I\'ll have...',       category:'Unit 2' },
    { serbian:'želim...',                 english:'I want... / I\'d like...',         category:'Unit 2' },
    { serbian:'molim vas',                english:'please (formal) / excuse me',      category:'Unit 2' },
    { serbian:'izvolite',                 english:'here you go / go ahead',           category:'Unit 2' },
    { serbian:'kafu bez šećera',          english:'coffee without sugar',             category:'Unit 2' },
    { serbian:'šta želite da popijete?',  english:'what would you like to drink?',    category:'Unit 2' },
    { serbian:'ima li...?',               english:'do you have...?',                  category:'Unit 2' },

    // ── UNIT 3: TIPIČAN DAN STIVA BONDA ──────────────────────────────────
    { serbian:'novine',                   english:'newspaper(s)',                     category:'Unit 3' },
    { serbian:'televizor',                english:'television set / TV',              category:'Unit 3' },
    { serbian:'televizija',               english:'television',                       category:'Unit 3' },
    { serbian:'radio',                    english:'radio',                            category:'Unit 3' },
    { serbian:'automobil',                english:'car',                              category:'Unit 3' },
    { serbian:'kompjuter',                english:'computer',                         category:'Unit 3' },
    { serbian:'posao',                    english:'work / job',                       category:'Unit 3' },
    { serbian:'firma',                    english:'company / firm',                   category:'Unit 3' },
    { serbian:'kancelarija',              english:'office',                           category:'Unit 3' },
    { serbian:'sastanak',                 english:'meeting',                          category:'Unit 3' },
    { serbian:'dokument',                 english:'document',                         category:'Unit 3' },
    { serbian:'svaki dan',                english:'every day',                        category:'Unit 3' },
    { serbian:'svakog jutra',             english:'every morning',                    category:'Unit 3' },
    { serbian:'teško',                    english:'difficult / hard',                 category:'Unit 3' },
    { serbian:'lako',                     english:'easy',                             category:'Unit 3' },
    { serbian:'samo',                     english:'only / just',                      category:'Unit 3' },
    { serbian:'sve',                      english:'everything / all',                 category:'Unit 3' },
    { serbian:'čitati',                   english:'to read',                          category:'Unit 3' },
    { serbian:'gledati',                  english:'to watch / to look at',            category:'Unit 3' },
    { serbian:'slušati',                  english:'to listen (to)',                   category:'Unit 3' },
    { serbian:'raditi',                   english:'to work',                          category:'Unit 3' },
    { serbian:'učiti',                    english:'to study / to learn',              category:'Unit 3' },
    { serbian:'govoriti',                 english:'to speak',                         category:'Unit 3' },
    { serbian:'razumeti',                 english:'to understand',                    category:'Unit 3' },
    { serbian:'voleti',                   english:'to like / to love',                category:'Unit 3' },
    { serbian:'ići',                      english:'to go',                            category:'Unit 3' },
    { serbian:'biti',                     english:'to be',                            category:'Unit 3' },
    { serbian:'imati',                    english:'to have',                          category:'Unit 3' },
    { serbian:'telefonirati',             english:'to telephone / to call',           category:'Unit 3' },
    { serbian:'jutro',                    english:'morning',                          category:'Unit 3' },
    { serbian:'veče',                     english:'evening',                          category:'Unit 3' },
    { serbian:'noć',                      english:'night',                            category:'Unit 3' },

    // ── UNIT 4: GDE JE...? ────────────────────────────────────────────────
    { serbian:'muzej',                    english:'museum',                           category:'Unit 4' },
    { serbian:'pošta',                    english:'post office',                      category:'Unit 4' },
    { serbian:'pozorište',                english:'theater',                          category:'Unit 4' },
    { serbian:'crkva',                    english:'church',                           category:'Unit 4' },
    { serbian:'prodavnica',               english:'store / shop',                     category:'Unit 4' },
    { serbian:'bolnica',                  english:'hospital',                         category:'Unit 4' },
    { serbian:'kafić',                    english:'café',                             category:'Unit 4' },
    { serbian:'bioskop',                  english:'cinema / movie theater',           category:'Unit 4' },
    { serbian:'pijaca',                   english:'market / marketplace',             category:'Unit 4' },
    { serbian:'menjačnica',               english:'currency exchange office',         category:'Unit 4' },
    { serbian:'trg',                      english:'square / plaza',                   category:'Unit 4' },
    { serbian:'ulica',                    english:'street',                           category:'Unit 4' },
    { serbian:'ugao',                     english:'corner',                           category:'Unit 4' },
    { serbian:'zgrada',                   english:'building',                         category:'Unit 4' },
    { serbian:'kuća',                     english:'house',                            category:'Unit 4' },
    { serbian:'stan',                     english:'apartment / flat',                 category:'Unit 4' },
    { serbian:'reka',                     english:'river',                            category:'Unit 4' },
    { serbian:'most',                     english:'bridge',                           category:'Unit 4' },
    { serbian:'levo',                     english:'left',                             category:'Unit 4' },
    { serbian:'desno',                    english:'right',                            category:'Unit 4' },
    { serbian:'pravo',                    english:'straight ahead',                   category:'Unit 4' },
    { serbian:'blizu',                    english:'near / close by',                  category:'Unit 4' },
    { serbian:'daleko',                   english:'far',                              category:'Unit 4' },
    { serbian:'na uglu',                  english:'on the corner',                    category:'Unit 4' },
    { serbian:'na kraju',                 english:'at the end',                       category:'Unit 4' },
    { serbian:'prekoputa',                english:'opposite / across from',           category:'Unit 4' },
    { serbian:'kako da dođem do...?',     english:'how do I get to...?',             category:'Unit 4' },
    { serbian:'idite pravo',              english:'go straight',                      category:'Unit 4' },
    { serbian:'skrenite levo',            english:'turn left',                        category:'Unit 4' },
    { serbian:'skrenite desno',           english:'turn right',                       category:'Unit 4' },
    { serbian:'mogu li da idem peške?',   english:'can I walk there?',               category:'Unit 4' },

    // ── UNIT 5: U SOBI ────────────────────────────────────────────────────
    { serbian:'soba',                     english:'room',                             category:'Unit 5' },
    { serbian:'dnevna soba',              english:'living room',                      category:'Unit 5' },
    { serbian:'spavaća soba',             english:'bedroom',                          category:'Unit 5' },
    { serbian:'kuhinja',                  english:'kitchen',                          category:'Unit 5' },
    { serbian:'kupatilo',                 english:'bathroom',                         category:'Unit 5' },
    { serbian:'hodnik',                   english:'hallway / corridor',               category:'Unit 5' },
    { serbian:'sto',                      english:'table',                            category:'Unit 5' },
    { serbian:'stolica',                  english:'chair',                            category:'Unit 5' },
    { serbian:'krevet',                   english:'bed',                              category:'Unit 5' },
    { serbian:'orman',                    english:'wardrobe / closet',                category:'Unit 5' },
    { serbian:'polica',                   english:'shelf',                            category:'Unit 5' },
    { serbian:'komoda',                   english:'dresser / chest of drawers',       category:'Unit 5' },
    { serbian:'fotelja',                  english:'armchair',                         category:'Unit 5' },
    { serbian:'sofa',                     english:'sofa / couch',                     category:'Unit 5' },
    { serbian:'tepih',                    english:'carpet / rug',                     category:'Unit 5' },
    { serbian:'sat',                      english:'clock / watch / hour',             category:'Unit 5' },
    { serbian:'slika',                    english:'picture / painting',               category:'Unit 5' },
    { serbian:'ogledalo',                 english:'mirror',                           category:'Unit 5' },
    { serbian:'zid',                      english:'wall',                             category:'Unit 5' },
    { serbian:'pod',                      english:'floor (surface)',                  category:'Unit 5' },
    { serbian:'plafon',                   english:'ceiling',                          category:'Unit 5' },
    { serbian:'prozor',                   english:'window',                           category:'Unit 5' },
    { serbian:'vrata',                    english:'door(s)',                          category:'Unit 5' },
    { serbian:'zavese',                   english:'curtains',                         category:'Unit 5' },
    { serbian:'lampa',                    english:'lamp',                             category:'Unit 5' },
    { serbian:'sprat',                    english:'floor / storey',                   category:'Unit 5' },
    { serbian:'prizemlje',                english:'ground floor',                     category:'Unit 5' },
    { serbian:'udoban',                   english:'comfortable',                      category:'Unit 5' },
    { serbian:'velik',                    english:'big / large',                      category:'Unit 5' },
    { serbian:'mali',                     english:'small / little',                   category:'Unit 5' },
    { serbian:'svetao',                   english:'bright / light',                   category:'Unit 5' },

    // ── UNIT 6: KUPOVINA HRANE ────────────────────────────────────────────
    { serbian:'pijaca',                   english:'outdoor market',                   category:'Unit 6' },
    { serbian:'mesara',                   english:'butcher\'s shop',                  category:'Unit 6' },
    { serbian:'pekara',                   english:'bakery',                           category:'Unit 6' },
    { serbian:'samoposluga',              english:'supermarket / self-service shop',  category:'Unit 6' },
    { serbian:'sir',                      english:'cheese',                           category:'Unit 6' },
    { serbian:'jogurt',                   english:'yogurt',                           category:'Unit 6' },
    { serbian:'pavlaka',                  english:'sour cream',                       category:'Unit 6' },
    { serbian:'puter',                    english:'butter',                           category:'Unit 6' },
    { serbian:'meso',                     english:'meat',                             category:'Unit 6' },
    { serbian:'piletina',                 english:'chicken',                          category:'Unit 6' },
    { serbian:'šunka',                    english:'ham',                              category:'Unit 6' },
    { serbian:'jaja',                     english:'eggs',                             category:'Unit 6' },
    { serbian:'riba',                     english:'fish',                             category:'Unit 6' },
    { serbian:'hleb',                     english:'bread',                            category:'Unit 6' },
    { serbian:'kifla',                    english:'bread roll / croissant',           category:'Unit 6' },
    { serbian:'jabuka',                   english:'apple',                            category:'Unit 6' },
    { serbian:'jagoda',                   english:'strawberry',                       category:'Unit 6' },
    { serbian:'grožđe',                   english:'grapes',                           category:'Unit 6' },
    { serbian:'pomorandža',               english:'orange',                           category:'Unit 6' },
    { serbian:'kruška',                   english:'pear',                             category:'Unit 6' },
    { serbian:'krompir',                  english:'potato',                           category:'Unit 6' },
    { serbian:'luk',                      english:'onion',                            category:'Unit 6' },
    { serbian:'paradajz',                 english:'tomato',                           category:'Unit 6' },
    { serbian:'šargarepa',                english:'carrot',                           category:'Unit 6' },
    { serbian:'krastavac',                english:'cucumber',                         category:'Unit 6' },
    { serbian:'paprika',                  english:'pepper (vegetable)',               category:'Unit 6' },
    { serbian:'kupus',                    english:'cabbage',                          category:'Unit 6' },
    { serbian:'treba mi...',              english:'I need...',                        category:'Unit 6' },
    { serbian:'dajte mi...',              english:'give me... / I\'ll take...',       category:'Unit 6' },
    { serbian:'kusur',                    english:'change (money returned)',          category:'Unit 6' },
    { serbian:'skupo',                    english:'expensive',                        category:'Unit 6' },
    { serbian:'jeftino',                  english:'cheap / inexpensive',              category:'Unit 6' },
    { serbian:'svež',                     english:'fresh',                            category:'Unit 6' },

    // ── UNIT 7: DOĐITE U GOSTE! ───────────────────────────────────────────
    { serbian:'ponedeljak',               english:'Monday',                           category:'Unit 7' },
    { serbian:'utorak',                   english:'Tuesday',                          category:'Unit 7' },
    { serbian:'sreda',                    english:'Wednesday',                        category:'Unit 7' },
    { serbian:'četvrtak',                 english:'Thursday',                         category:'Unit 7' },
    { serbian:'petak',                    english:'Friday',                           category:'Unit 7' },
    { serbian:'subota',                   english:'Saturday',                         category:'Unit 7' },
    { serbian:'nedelja',                  english:'Sunday / week',                    category:'Unit 7' },
    { serbian:'ujutro',                   english:'in the morning',                   category:'Unit 7' },
    { serbian:'prepodne',                 english:'before noon / in the morning',     category:'Unit 7' },
    { serbian:'podne',                    english:'noon / midday',                    category:'Unit 7' },
    { serbian:'posle podne',              english:'afternoon',                        category:'Unit 7' },
    { serbian:'uveče',                    english:'in the evening',                   category:'Unit 7' },
    { serbian:'juče',                     english:'yesterday',                        category:'Unit 7' },
    { serbian:'danas',                    english:'today',                            category:'Unit 7' },
    { serbian:'sutra',                    english:'tomorrow',                         category:'Unit 7' },
    { serbian:'slobodan',                 english:'free / available',                 category:'Unit 7' },
    { serbian:'zauzet',                   english:'busy / occupied',                  category:'Unit 7' },
    { serbian:'nažalost',                 english:'unfortunately',                    category:'Unit 7' },
    { serbian:'važi',                     english:'agreed / OK / it\'s a deal',       category:'Unit 7' },
    { serbian:'može',                     english:'it\'s possible / OK / sure',       category:'Unit 7' },
    { serbian:'vidimo se',                english:'see you / we\'ll see each other',  category:'Unit 7' },
    { serbian:'dođite u goste',           english:'come visit / come over',           category:'Unit 7' },
    { serbian:'dođite kod nas',           english:'come to our place',                category:'Unit 7' },
    { serbian:'vrlo rado',                english:'with great pleasure / sure!',      category:'Unit 7' },
    { serbian:'žao mi je, ne mogu',       english:'I\'m sorry, I can\'t',            category:'Unit 7' },
    { serbian:'za koliko sati?',          english:'in how many hours?',              category:'Unit 7' },
    { serbian:'u koliko sati?',           english:'at what time?',                   category:'Unit 7' },
    { serbian:'vikend',                   english:'weekend',                          category:'Unit 7' },
    { serbian:'pozivam vas',              english:'I invite you (formal)',            category:'Unit 7' },
    { serbian:'prijatan vikend',          english:'have a nice weekend',              category:'Unit 7' },

    // ── UNIT 8: U RESTORANU ───────────────────────────────────────────────
    { serbian:'doručak',                  english:'breakfast',                        category:'Unit 8' },
    { serbian:'ručak',                    english:'lunch',                            category:'Unit 8' },
    { serbian:'večera',                   english:'dinner',                           category:'Unit 8' },
    { serbian:'jelovnik',                 english:'menu',                             category:'Unit 8' },
    { serbian:'predjelo',                 english:'starter / appetizer',              category:'Unit 8' },
    { serbian:'supa',                     english:'clear soup',                       category:'Unit 8' },
    { serbian:'čorba',                    english:'thick soup (Serbian style)',        category:'Unit 8' },
    { serbian:'salata',                   english:'salad',                            category:'Unit 8' },
    { serbian:'glavno jelo',              english:'main course',                      category:'Unit 8' },
    { serbian:'desert',                   english:'dessert',                          category:'Unit 8' },
    { serbian:'piće',                     english:'drink / beverage',                 category:'Unit 8' },
    { serbian:'govedina',                 english:'beef',                             category:'Unit 8' },
    { serbian:'svinjetina',               english:'pork',                             category:'Unit 8' },
    { serbian:'jagnjetina',               english:'lamb',                             category:'Unit 8' },
    { serbian:'srpska salata',            english:'Serbian salad (tomato & pepper)',  category:'Unit 8' },
    { serbian:'šopska salata',            english:'Shopska salad (with feta)',        category:'Unit 8' },
    { serbian:'kajmak',                   english:'kajmak (Serbian cream cheese)',     category:'Unit 8' },
    { serbian:'pljeskavica',              english:'Serbian burger patty',             category:'Unit 8' },
    { serbian:'doručkovati',              english:'to have breakfast',                category:'Unit 8' },
    { serbian:'ručati',                   english:'to have lunch',                    category:'Unit 8' },
    { serbian:'večerati',                 english:'to have dinner',                   category:'Unit 8' },
    { serbian:'naručiti',                 english:'to order',                         category:'Unit 8' },
    { serbian:'rezervisati sto',          english:'to reserve a table',               category:'Unit 8' },
    { serbian:'sto za dvoje',             english:'table for two',                    category:'Unit 8' },
    { serbian:'molim vas, račun',         english:'the bill please',                  category:'Unit 8' },
    { serbian:'uključen u cenu',          english:'included in the price',            category:'Unit 8' },
    { serbian:'dobar tek!',               english:'enjoy your meal! / bon appétit!',  category:'Unit 8' },
    { serbian:'živeli!',                  english:'cheers!',                          category:'Unit 8' },
    { serbian:'restoran',                 english:'restaurant',                       category:'Unit 8' },
    { serbian:'kafana',                   english:'Serbian tavern / pub',             category:'Unit 8' },

    // ── UNIT 9: TIPIČAN DAN ───────────────────────────────────────────────
    { serbian:'ustajati',                 english:'to get up (impf.)',                category:'Unit 9' },
    { serbian:'ustati',                   english:'to get up (pf.)',                  category:'Unit 9' },
    { serbian:'tuširati se',              english:'to have a shower',                 category:'Unit 9' },
    { serbian:'oblačiti se',              english:'to get dressed',                   category:'Unit 9' },
    { serbian:'spremati',                 english:'to prepare',                       category:'Unit 9' },
    { serbian:'odmаrati se',              english:'to rest / to relax',               category:'Unit 9' },
    { serbian:'spavati',                  english:'to sleep',                         category:'Unit 9' },
    { serbian:'doručkovati',              english:'to have breakfast',                category:'Unit 9' },
    { serbian:'ručati',                   english:'to have lunch',                    category:'Unit 9' },
    { serbian:'večerati',                 english:'to have dinner',                   category:'Unit 9' },
    { serbian:'pauza',                    english:'break / pause',                    category:'Unit 9' },
    { serbian:'rano',                     english:'early',                            category:'Unit 9' },
    { serbian:'kasno',                    english:'late',                             category:'Unit 9' },
    { serbian:'često',                    english:'often',                            category:'Unit 9' },
    { serbian:'obično',                   english:'usually',                          category:'Unit 9' },
    { serbian:'nekad',                    english:'sometimes',                        category:'Unit 9' },
    { serbian:'nikad',                    english:'never',                            category:'Unit 9' },
    { serbian:'pre',                      english:'before',                           category:'Unit 9' },
    { serbian:'posle',                    english:'after',                            category:'Unit 9' },
    { serbian:'od ... do ...',            english:'from ... until ...',               category:'Unit 9' },
    { serbian:'ceo dan',                  english:'all day / the whole day',          category:'Unit 9' },
    { serbian:'svakog jutra',             english:'every morning',                    category:'Unit 9' },
    { serbian:'svako veče',              english:'every evening',                    category:'Unit 9' },
    { serbian:'radni dan',               english:'weekday / working day',            category:'Unit 9' },
    { serbian:'telefonirati',             english:'to make a phone call',             category:'Unit 9' },
    { serbian:'domaći zadatak',           english:'homework',                         category:'Unit 9' },
    { serbian:'voziti se',                english:'to commute / to ride',             category:'Unit 9' },
    { serbian:'ići peške',                english:'to go on foot / to walk',          category:'Unit 9' },
    { serbian:'imati mnogo posla',        english:'to have a lot of work',            category:'Unit 9' },
    { serbian:'oko sedam sati',           english:'around seven o\'clock',            category:'Unit 9' },

    // ── UNIT 10: PORODICA ─────────────────────────────────────────────────
    { serbian:'majka',                    english:'mother',                           category:'Unit 10' },
    { serbian:'otac',                     english:'father',                           category:'Unit 10' },
    { serbian:'sin',                      english:'son',                              category:'Unit 10' },
    { serbian:'ćerka',                    english:'daughter',                         category:'Unit 10' },
    { serbian:'brat',                     english:'brother',                          category:'Unit 10' },
    { serbian:'sestra',                   english:'sister',                           category:'Unit 10' },
    { serbian:'muž',                      english:'husband',                          category:'Unit 10' },
    { serbian:'žena',                     english:'wife / woman',                     category:'Unit 10' },
    { serbian:'suprug',                   english:'husband (formal)',                 category:'Unit 10' },
    { serbian:'supruga',                  english:'wife (formal)',                    category:'Unit 10' },
    { serbian:'roditelji',                english:'parents',                          category:'Unit 10' },
    { serbian:'deca',                     english:'children',                         category:'Unit 10' },
    { serbian:'beba',                     english:'baby',                             category:'Unit 10' },
    { serbian:'deda',                     english:'grandfather',                      category:'Unit 10' },
    { serbian:'baka',                     english:'grandmother',                      category:'Unit 10' },
    { serbian:'ujak',                     english:'uncle (mother\'s brother)',         category:'Unit 10' },
    { serbian:'tetka',                    english:'aunt',                             category:'Unit 10' },
    { serbian:'bratić / sestrična',       english:'cousin (m/f)',                     category:'Unit 10' },
    { serbian:'pravnik',                  english:'lawyer',                           category:'Unit 10' },
    { serbian:'bibliotekar',              english:'librarian',                        category:'Unit 10' },
    { serbian:'lekar',                    english:'doctor / physician',               category:'Unit 10' },
    { serbian:'kuvati',                   english:'to cook',                          category:'Unit 10' },
    { serbian:'putovati',                 english:'to travel',                        category:'Unit 10' },
    { serbian:'igrati',                   english:'to play',                          category:'Unit 10' },
    { serbian:'šetati',                   english:'to walk / to stroll',              category:'Unit 10' },
    { serbian:'bašta',                    english:'garden',                           category:'Unit 10' },
    { serbian:'po profesiji',             english:'by profession',                    category:'Unit 10' },
    { serbian:'udata',                    english:'married (woman)',                  category:'Unit 10' },
    { serbian:'oženjen',                  english:'married (man)',                    category:'Unit 10' },
    { serbian:'u penziji',                english:'retired',                          category:'Unit 10' },
    { serbian:'studirati',                english:'to study (at university)',          category:'Unit 10' },

    // ── UNIT 11: LJADI / STAN ─────────────────────────────────────────────
    { serbian:'pas',                      english:'dog',                              category:'Unit 11' },
    { serbian:'mačka',                    english:'cat',                              category:'Unit 11' },
    { serbian:'prijatelj',                english:'friend (m)',                        category:'Unit 11' },
    { serbian:'prijateljica',             english:'friend (f)',                        category:'Unit 11' },
    { serbian:'drugarica',                english:'(female) friend / companion',       category:'Unit 11' },
    { serbian:'ime',                      english:'name',                             category:'Unit 11' },
    { serbian:'voziti',                   english:'to drive',                         category:'Unit 11' },
    { serbian:'voziti bicikl',            english:'to ride a bike',                   category:'Unit 11' },
    { serbian:'devojčica',                english:'girl',                             category:'Unit 11' },
    { serbian:'dečak',                    english:'boy',                              category:'Unit 11' },
    { serbian:'zajedno',                  english:'together',                         category:'Unit 11' },
    { serbian:'razgovarati',              english:'to talk / to chat',                category:'Unit 11' },
    { serbian:'izlaziti',                 english:'to go out',                        category:'Unit 11' },
    { serbian:'sedeti',                   english:'to sit',                           category:'Unit 11' },
    { serbian:'trpezarija',               english:'dining room',                      category:'Unit 11' },
    { serbian:'predgrađe',                english:'suburb',                           category:'Unit 11' },
    { serbian:'nameštaj',                 english:'furniture',                        category:'Unit 11' },
    { serbian:'namešten',                 english:'furnished',                        category:'Unit 11' },
    { serbian:'miran',                    english:'quiet / peaceful',                 category:'Unit 11' },
    { serbian:'pogled na...',             english:'view of...',                       category:'Unit 11' },
    { serbian:'tražiti',                  english:'to look for / to seek',            category:'Unit 11' },
    { serbian:'pisati',                   english:'to write',                         category:'Unit 11' },
    { serbian:'pismo',                    english:'letter (written)',                 category:'Unit 11' },
    { serbian:'mejl',                     english:'email',                            category:'Unit 11' },
    { serbian:'odmah',                    english:'immediately / right away',         category:'Unit 11' },
    { serbian:'pored reke',               english:'by the river / along the river',   category:'Unit 11' },
    { serbian:'dvosoban stan',            english:'two-room apartment',               category:'Unit 11' },
    { serbian:'trosoban stan',            english:'three-room apartment',             category:'Unit 11' },
    { serbian:'živeti',                   english:'to live',                          category:'Unit 11' },
    { serbian:'košarka',                  english:'basketball',                       category:'Unit 11' },
    { serbian:'fudbal',                   english:'football / soccer',               category:'Unit 11' },
    { serbian:'tenis',                    english:'tennis',                           category:'Unit 11' },

    // ── UNIT 12: NARODI I JEZICI ──────────────────────────────────────────
    { serbian:'Engleska',                 english:'England',                          category:'Unit 12' },
    { serbian:'Srbija',                   english:'Serbia',                           category:'Unit 12' },
    { serbian:'Francuska',                english:'France',                           category:'Unit 12' },
    { serbian:'Nemačka',                  english:'Germany',                          category:'Unit 12' },
    { serbian:'Rusija',                   english:'Russia',                           category:'Unit 12' },
    { serbian:'Amerika',                  english:'America / USA',                    category:'Unit 12' },
    { serbian:'Grčka',                    english:'Greece',                           category:'Unit 12' },
    { serbian:'Italija',                  english:'Italy',                            category:'Unit 12' },
    { serbian:'Španija',                  english:'Spain',                            category:'Unit 12' },
    { serbian:'Holandija',                english:'Netherlands / Holland',            category:'Unit 12' },
    { serbian:'Kina',                     english:'China',                            category:'Unit 12' },
    { serbian:'Japan',                    english:'Japan',                            category:'Unit 12' },
    { serbian:'Srbin / Srpkinja',         english:'Serbian man / Serbian woman',      category:'Unit 12' },
    { serbian:'Englez / Engleskinja',     english:'Englishman / Englishwoman',        category:'Unit 12' },
    { serbian:'Francuz / Francuskinja',   english:'Frenchman / Frenchwoman',          category:'Unit 12' },
    { serbian:'Nemac / Nemica',           english:'German man / German woman',        category:'Unit 12' },
    { serbian:'Italijan / Italijanka',    english:'Italian man / Italian woman',      category:'Unit 12' },
    { serbian:'Španac / Špankinja',       english:'Spanish man / Spanish woman',      category:'Unit 12' },
    { serbian:'srpski',                   english:'Serbian (language)',               category:'Unit 12' },
    { serbian:'francuski',                english:'French (language)',                category:'Unit 12' },
    { serbian:'nemački',                  english:'German (language)',                category:'Unit 12' },
    { serbian:'italijanski',              english:'Italian (language)',               category:'Unit 12' },
    { serbian:'grčki',                    english:'Greek (language)',                 category:'Unit 12' },
    { serbian:'rečnik',                   english:'dictionary',                       category:'Unit 12' },
    { serbian:'kurs',                     english:'course',                           category:'Unit 12' },
    { serbian:'čas',                      english:'class / lesson / hour',            category:'Unit 12' },
    { serbian:'tri puta nedeljno',        english:'three times a week',               category:'Unit 12' },
    { serbian:'odlično',                  english:'excellent',                        category:'Unit 12' },
    { serbian:'slabo',                    english:'poorly / weakly',                  category:'Unit 12' },
    { serbian:'retko',                    english:'rarely',                           category:'Unit 12' },
    { serbian:'knjižara',                 english:'bookstore',                        category:'Unit 12' },
    { serbian:'pričati',                  english:'to talk / to tell',                category:'Unit 12' },
    { serbian:'probati',                  english:'to try',                           category:'Unit 12' },

    // ── UNIT 13: KAKO JE BILO JUČE? ───────────────────────────────────────
    { serbian:'juče',                     english:'yesterday',                        category:'Unit 13' },
    { serbian:'prošle nedelje',           english:'last week',                        category:'Unit 13' },
    { serbian:'prošle godine',            english:'last year',                        category:'Unit 13' },
    { serbian:'pre pet minuta',           english:'five minutes ago',                 category:'Unit 13' },
    { serbian:'pre dva sata',             english:'two hours ago',                    category:'Unit 13' },
    { serbian:'bio / bila sam',           english:'I was (m / f)',                    category:'Unit 13' },
    { serbian:'umoran / umorna',          english:'tired (m / f)',                    category:'Unit 13' },
    { serbian:'bazen',                    english:'swimming pool',                    category:'Unit 13' },
    { serbian:'plivanje',                 english:'swimming',                         category:'Unit 13' },
    { serbian:'plivati',                  english:'to swim',                          category:'Unit 13' },
    { serbian:'baviti se',                english:'to be engaged in / to do (a sport)',category:'Unit 13' },
    { serbian:'prestati',                 english:'to stop / to cease',               category:'Unit 13' },
    { serbian:'parkirati',                english:'to park',                          category:'Unit 13' },
    { serbian:'doći',                     english:'to come / to arrive',              category:'Unit 13' },
    { serbian:'otići',                    english:'to leave / to go',                 category:'Unit 13' },
    { serbian:'poći',                     english:'to set off / to leave',            category:'Unit 13' },
    { serbian:'vratiti se',               english:'to return / to come back',         category:'Unit 13' },
    { serbian:'naručiti',                 english:'to order',                         category:'Unit 13' },
    { serbian:'rešiti',                   english:'to decide / to solve',             category:'Unit 13' },
    { serbian:'dogovor',                  english:'agreement / arrangement',          category:'Unit 13' },
    { serbian:'izveštaj',                 english:'report',                           category:'Unit 13' },
    { serbian:'izlog',                    english:'shop window / display window',     category:'Unit 13' },
    { serbian:'stvar',                    english:'thing / item',                     category:'Unit 13' },
    { serbian:'nekoliko',                 english:'a few / several',                  category:'Unit 13' },
    { serbian:'brzo',                     english:'quickly / fast',                   category:'Unit 13' },
    { serbian:'bolje',                    english:'better',                           category:'Unit 13' },
    { serbian:'kao i obično',             english:'as usual',                         category:'Unit 13' },
    { serbian:'ponoć',                    english:'midnight',                         category:'Unit 13' },
    { serbian:'prošli tjedan',            english:'last week (alternative)',          category:'Unit 13' },
    { serbian:'seminar',                  english:'seminar / workshop',               category:'Unit 13' },
    { serbian:'celе nedelje',             english:'the whole week',                   category:'Unit 13' },

    // ── UNIT 14: KAKVO JE DANAS VREME? ───────────────────────────────────
    { serbian:'vreme',                    english:'weather / time',                   category:'Unit 14' },
    { serbian:'proleće',                  english:'spring',                           category:'Unit 14' },
    { serbian:'leto',                     english:'summer',                           category:'Unit 14' },
    { serbian:'jesen',                    english:'autumn / fall',                    category:'Unit 14' },
    { serbian:'zima',                     english:'winter',                           category:'Unit 14' },
    { serbian:'godišnje doba',            english:'season (of the year)',             category:'Unit 14' },
    { serbian:'pada kiša',                english:'it\'s raining',                    category:'Unit 14' },
    { serbian:'pada sneg',                english:'it\'s snowing',                    category:'Unit 14' },
    { serbian:'sunce sjа',                english:'the sun is shining',               category:'Unit 14' },
    { serbian:'nebo je vedro',            english:'the sky is clear',                 category:'Unit 14' },
    { serbian:'vetar duva',               english:'the wind is blowing',              category:'Unit 14' },
    { serbian:'mraz',                     english:'frost',                            category:'Unit 14' },
    { serbian:'magla',                    english:'fog',                              category:'Unit 14' },
    { serbian:'sunčano',                  english:'sunny',                            category:'Unit 14' },
    { serbian:'oblačno',                  english:'cloudy',                           category:'Unit 14' },
    { serbian:'vruće',                    english:'hot',                              category:'Unit 14' },
    { serbian:'toplo',                    english:'warm',                             category:'Unit 14' },
    { serbian:'prohladno',                english:'chilly / cool',                    category:'Unit 14' },
    { serbian:'hladno',                   english:'cold',                             category:'Unit 14' },
    { serbian:'vetrovito',                english:'windy',                            category:'Unit 14' },
    { serbian:'vlažno',                   english:'humid',                            category:'Unit 14' },
    { serbian:'suvo',                     english:'dry',                              category:'Unit 14' },
    { serbian:'stepen',                   english:'degree (temperature)',             category:'Unit 14' },
    { serbian:'temperatura',              english:'temperature',                      category:'Unit 14' },
    { serbian:'prognoza',                 english:'forecast',                         category:'Unit 14' },
    { serbian:'sever',                    english:'north',                            category:'Unit 14' },
    { serbian:'jug',                      english:'south',                            category:'Unit 14' },
    { serbian:'istok',                    english:'east',                             category:'Unit 14' },
    { serbian:'zapad',                    english:'west',                             category:'Unit 14' },
    { serbian:'planina',                  english:'mountain',                         category:'Unit 14' },
    { serbian:'priroda',                  english:'nature / countryside',             category:'Unit 14' },
    { serbian:'omiljеn',                  english:'favourite / beloved',              category:'Unit 14' },
    { serbian:'napolju',                  english:'outside / outdoors',               category:'Unit 14' },
    { serbian:'gužva',                    english:'crowd / crowded place',            category:'Unit 14' },
    { serbian:'skijati se',               english:'to ski',                           category:'Unit 14' },
    { serbian:'januar',                   english:'January',                          category:'Unit 14' },
    { serbian:'februar',                  english:'February',                         category:'Unit 14' },
    { serbian:'mart',                     english:'March',                            category:'Unit 14' },
    { serbian:'april',                    english:'April',                            category:'Unit 14' },
    { serbian:'maj',                      english:'May',                              category:'Unit 14' },
    { serbian:'jun',                      english:'June',                             category:'Unit 14' },
    { serbian:'jul',                      english:'July',                             category:'Unit 14' },
    { serbian:'avgust',                   english:'August',                           category:'Unit 14' },
    { serbian:'septembar',                english:'September',                        category:'Unit 14' },
    { serbian:'oktobar',                  english:'October',                          category:'Unit 14' },
    { serbian:'novembar',                 english:'November',                         category:'Unit 14' },
    { serbian:'decembar',                 english:'December',                         category:'Unit 14' },
  ];

  function loadCards() {
    const raw = localStorage.getItem(STORAGE_KEY);
    const ver = localStorage.getItem(STORAGE_KEY + '_v');
    if (!raw || ver !== CARDS_VER) {
      // Merge: add any new defaults not already present (matched by serbian+category)
      const existing = raw ? JSON.parse(raw) : [];
      const merged   = [...existing];
      DEFAULT_CARDS.forEach(def => {
        const exists = existing.some(e => e.serbian === def.serbian && e.category === def.category);
        if (!exists) merged.push(def);
      });
      saveCards(merged);
      localStorage.setItem(STORAGE_KEY + '_v', CARDS_VER);
      return merged;
    }
    return JSON.parse(raw);
  }
  function saveCards(c) { localStorage.setItem(STORAGE_KEY, JSON.stringify(c)); }

  // ═══════════════════════════════════════════════════
  //  GRAMMAR NOUN STORAGE
  // ═══════════════════════════════════════════════════
  const GRAMMAR_KEY = 'serbian_grammar_nouns';

  const DEFAULT_GRAMMAR_NOUNS = [
    { english:'brother', gender:'masculine', forms:{ nominativ:'brat',   genitiv:'brata',   dativ:'bratu',   akuzativ:'brata',   vokativ:'brate',   instrumental:'bratom',   lokativ:'bratu'   }},
    { english:'city',    gender:'masculine', forms:{ nominativ:'grad',   genitiv:'grada',   dativ:'gradu',   akuzativ:'grad',    vokativ:'grade',   instrumental:'gradom',   lokativ:'gradu'   }},
    { english:'man',     gender:'masculine', forms:{ nominativ:'čovek',  genitiv:'čoveka',  dativ:'čoveku',  akuzativ:'čoveka',  vokativ:'čoveče',  instrumental:'čovekom',  lokativ:'čoveku'  }},
    { english:'dog',     gender:'masculine', forms:{ nominativ:'pas',    genitiv:'psa',     dativ:'psu',     akuzativ:'psa',     vokativ:'pse',     instrumental:'psom',     lokativ:'psu'     }},
    { english:'son',     gender:'masculine', forms:{ nominativ:'sin',    genitiv:'sina',    dativ:'sinu',    akuzativ:'sina',    vokativ:'sine',    instrumental:'sinom',    lokativ:'sinu'    }},
    { english:'friend',  gender:'masculine', forms:{ nominativ:'drug',   genitiv:'druga',   dativ:'drugu',   akuzativ:'druga',   vokativ:'druže',   instrumental:'drugom',   lokativ:'drugu'   }},
    { english:'window',  gender:'masculine', forms:{ nominativ:'prozor', genitiv:'prozora', dativ:'prozoru', akuzativ:'prozor',  vokativ:'prozore', instrumental:'prozorom', lokativ:'prozoru' }},
    { english:'woman',   gender:'feminine',  forms:{ nominativ:'žena',   genitiv:'žene',    dativ:'ženi',    akuzativ:'ženu',    vokativ:'ženo',    instrumental:'ženom',    lokativ:'ženi'    }},
    { english:'sister',  gender:'feminine',  forms:{ nominativ:'sestra', genitiv:'sestre',  dativ:'sestri',  akuzativ:'sestru',  vokativ:'sestro',  instrumental:'sestrom',  lokativ:'sestri'  }},
    { english:'mother',  gender:'feminine',  forms:{ nominativ:'majka',  genitiv:'majke',   dativ:'majci',   akuzativ:'majku',   vokativ:'majko',   instrumental:'majkom',   lokativ:'majci'   }},
    { english:'book',    gender:'feminine',  forms:{ nominativ:'knjiga', genitiv:'knjige',  dativ:'knjizi',  akuzativ:'knjigu',  vokativ:'knjigo',  instrumental:'knjigom',  lokativ:'knjizi'  }},
    { english:'house',   gender:'feminine',  forms:{ nominativ:'kuća',   genitiv:'kuće',    dativ:'kući',    akuzativ:'kuću',    vokativ:'kućo',    instrumental:'kućom',    lokativ:'kući'    }},
    { english:'water',   gender:'feminine',  forms:{ nominativ:'voda',   genitiv:'vode',    dativ:'vodi',    akuzativ:'vodu',    vokativ:'vodo',    instrumental:'vodom',    lokativ:'vodi'    }},
    { english:'river',   gender:'feminine',  forms:{ nominativ:'reka',   genitiv:'reke',    dativ:'reci',    akuzativ:'reku',    vokativ:'reko',    instrumental:'rekom',    lokativ:'reci'    }},
    { english:'school',  gender:'feminine',  forms:{ nominativ:'škola',  genitiv:'škole',   dativ:'školi',   akuzativ:'školu',   vokativ:'školo',   instrumental:'školom',   lokativ:'školi'   }},
    { english:'village', gender:'neuter',    forms:{ nominativ:'selo',   genitiv:'sela',    dativ:'selu',    akuzativ:'selo',    vokativ:'selo',    instrumental:'selom',    lokativ:'selu'    }},
    { english:'sea',     gender:'neuter',    forms:{ nominativ:'more',   genitiv:'mora',    dativ:'moru',    akuzativ:'more',    vokativ:'more',    instrumental:'morem',    lokativ:'moru'    }},
    { english:'child',   gender:'neuter',    forms:{ nominativ:'dete',   genitiv:'deteta',  dativ:'detetu',  akuzativ:'dete',    vokativ:'dete',    instrumental:'detetom',  lokativ:'detetu'  }},
    { english:'name',    gender:'neuter',    forms:{ nominativ:'ime',    genitiv:'imena',   dativ:'imenu',   akuzativ:'ime',     vokativ:'ime',     instrumental:'imenom',   lokativ:'imenu'   }},
    { english:'sun',     gender:'neuter',    forms:{ nominativ:'sunce',  genitiv:'sunca',   dativ:'suncu',   akuzativ:'sunce',   vokativ:'sunce',   instrumental:'suncem',   lokativ:'suncu'   }},
  ];

  function loadGrammarNouns() {
    const raw = localStorage.getItem(GRAMMAR_KEY);
    if (!raw) { saveGrammarNouns(DEFAULT_GRAMMAR_NOUNS); return [...DEFAULT_GRAMMAR_NOUNS]; }
    return JSON.parse(raw);
  }
  function saveGrammarNouns(n) { localStorage.setItem(GRAMMAR_KEY, JSON.stringify(n)); }

  // ═══════════════════════════════════════════════════
  //  USER VERB STORAGE
  // ═══════════════════════════════════════════════════
  const VERB_KEY = 'serbian_user_verbs';
  function loadUserVerbs() {
    const raw = localStorage.getItem(VERB_KEY);
    return raw ? JSON.parse(raw) : [];
  }
  function saveUserVerbs(v) { localStorage.setItem(VERB_KEY, JSON.stringify(v)); }

  const ADJ_KEY = 'serbian_user_adjectives';
  function loadUserAdjectives() {
    const raw = localStorage.getItem(ADJ_KEY);
    return raw ? JSON.parse(raw) : [];
  }
  function saveUserAdjectives(a) { localStorage.setItem(ADJ_KEY, JSON.stringify(a)); }

  const MISSED_KEY = 'serbian_missed_cards';
  function loadMissedCards() {
    try { return new Set(JSON.parse(localStorage.getItem(MISSED_KEY)) || []); }
    catch(e) { return new Set(); }
  }
  function saveMissedCards() {
    localStorage.setItem(MISSED_KEY, JSON.stringify([...missedCards]));
  }

  // ═══════════════════════════════════════════════════
  //  STATE
  // ═══════════════════════════════════════════════════
  let groups       = loadGroups();
  let cards        = loadCards();
  let grammarNouns = loadGrammarNouns();

  // Study state
  let deck              = [];
  let index             = 0;
  let direction         = 'sr';
  let activeStudyGroups = new Set();
  let missedCards       = loadMissedCards();
  let missedOnlyMode    = false;

  // Grammar state
  let gIndex       = 0;
  let activeCases  = new Set(CASES.map(c => c.key));
  let gScore         = { correct: 0, total: 0 };
  let gScoredNoun    = false;
  let gCasesAnswered = new Set();

  // Verb state
  let userVerbs      = loadUserVerbs();
  let allVerbs       = [];
  let vIndex         = 0;
  let activeTense    = 'present';
  let activeSubjects = new Set(['ja','ti','on','mi','vi','oni']);
  let vScore         = { correct: 0, total: 0 };
  let vScoredVerb    = false;
  let addVerbAspect  = 'imp';

  // Adjective state
  let userAdjectives = loadUserAdjectives();
  let allAdjectives  = [];
  let adjIndex       = 0;
  let adjGender      = 'masculine';
  let adjActiveCases = new Set(CASES.map(c => c.key));
  let adjScore         = { correct: 0, total: 0 };
  let adjScoredAdj     = false;
  let adjCasesAnswered = new Set();

  // Context Chooser state
  let ctxDeck          = [];
  let ctxIndex         = 0;
  let ctxScore         = { correct: 0, total: 0 };
  let ctxScoredQ       = false;
  let ctxAnswered      = false;
  let ctxActiveFilters = new Set(['po', 'o', 'za', 'iz', 'na', 'pro', 'u', 'irregular']);

  const CTX_PREFIX_MAP = {
    'popiti':'po', 'pojesti':'po', 'pogledati':'po', 'pozvati':'po', 'poslušati':'po',
    'pročitati':'pro', 'prohodati':'pro',
    'napisati':'na', 'naučiti':'na', 'napraviti':'na',
    'očistiti':'o', 'otvoriti':'o', 'ogledati':'o',
    'izgraditi':'iz', 'izgovoriti':'iz',
    'zapevati':'za', 'zaplakati':'za', 'završiti':'za', 'zatvoriti':'za', 'zaboraviti':'za',
    'uraditi':'u', 'uleteti':'u', 'ustati':'u', 'uhvatiti':'u',
  };

  const PREFIX_INFO = {
    'po': {
      title: 'Simple completion',
      desc: 'The most common perfective prefix in Serbian. Usually marks straightforward completion — doing something once or to a satisfying degree. It rarely changes the core meaning; it mainly signals "done."',
      examples: [
        { imp:'piti',    pfv:'popiti',    en:'drink → drink up' },
        { imp:'jesti',   pfv:'pojesti',   en:'eat → eat up' },
        { imp:'gledati', pfv:'pogledati', en:'watch → take a look' },
        { imp:'zvati',   pfv:'pozvati',   en:'call → invite' },
      ]
    },
    'o': {
      title: 'Around / once through',
      desc: 'Marks doing something "around" or "once through" — surveying, examining, or covering something comprehensively in a single pass. Often implies thoroughness rather than mere completion.',
      examples: [
        { imp:'čistiti',  pfv:'očistiti', en:'clean → clean thoroughly' },
        { imp:'gledati',  pfv:'ogledati', en:'watch → look over / survey' },
        { imp:'otvarati', pfv:'otvoriti', en:'open (habit) → open (once)' },
      ]
    },
    'za': {
      title: 'Onset or enclosure',
      desc: 'Two main uses: (1) marking the onset of an action — the moment something starts (zapevati = start singing, zaplakati = burst into tears); (2) marking closing, securing, or forgetting (zatvoriti, zaboraviti). Context determines which applies.',
      examples: [
        { imp:'pevati',   pfv:'zapevati',   en:'sing → burst into song' },
        { imp:'plakati',  pfv:'zaplakati',  en:'cry → burst into tears' },
        { imp:'zatvarati',pfv:'zatvoriti',  en:'close (habit) → shut (once)' },
        { imp:'završavati',pfv:'završiti',  en:'finish (habit) → finish (once)' },
      ]
    },
    'iz': {
      title: 'Completely / outward',
      desc: 'Marks doing something completely or outward — carrying an action through to the end, or expressing motion or expression outward. Often implies building up, extracting, or articulating fully.',
      examples: [
        { imp:'graditi',  pfv:'izgraditi',   en:'build → build up / complete' },
        { imp:'govoriti', pfv:'izgovoriti',  en:'speak → pronounce / utter' },
      ]
    },
    'na': {
      title: 'Accumulation / enough',
      desc: 'Marks accumulation — doing something to a sufficient or satisfying degree, filling up, or achieving a completed result. Often implies effort that builds up to something finished.',
      examples: [
        { imp:'pisati',  pfv:'napisati',  en:'write → write / finish writing' },
        { imp:'učiti',   pfv:'naučiti',   en:'study → learn / master' },
        { imp:'praviti', pfv:'napraviti', en:'make → make / complete' },
      ]
    },
    'pro': {
      title: 'Through / new state',
      desc: 'Marks passing through time or space, spending time doing something, or crossing into a new state. Can also mark achieving something for the very first time — as when a toddler takes their first steps.',
      examples: [
        { imp:'čitati', pfv:'pročitati', en:'read → read through / finish' },
        { imp:'hodati', pfv:'prohodati', en:'walk → start walking (first steps)' },
      ]
    },
    'u': {
      title: 'Into / entering a state',
      desc: 'Marks entering a state, doing something into something, or transitioning into a new condition. Often implies motion inward or the successful result of an action.',
      examples: [
        { imp:'raditi',  pfv:'uraditi',  en:'work → complete a task' },
        { imp:'leteti',  pfv:'uleteti',  en:'fly → fly into' },
        { imp:'ustajati',pfv:'ustati',   en:'get up (habit) → get up (once)' },
        { imp:'hvatati', pfv:'uhvatiti', en:'try to catch → catch / grab' },
      ]
    },
    'irregular': {
      title: 'Suppletive & uncommon prefixes',
      desc: 'These pairs don\'t follow a standard prefix pattern. Suppletive pairs have imperfective and perfective forms from completely different roots. Others use less common prefixes (s-, pri-, ot-). These require memorization — there\'s no shortcut.',
      examples: [
        { imp:'govoriti',   pfv:'reći',      en:'speak → say (completely different roots)' },
        { imp:'dolaziti',   pfv:'doći',      en:'come (habit) → arrive (once)' },
        { imp:'davati',     pfv:'dati',      en:'give (habit) → give (once)' },
        { imp:'oblačiti se',pfv:'obući se',  en:'get dressed (habit) → get dressed (once)' },
        { imp:'skakati',    pfv:'skočiti',   en:'jump (habit) → jump (once)' },
      ]
    },
  };

  function showPrefixInfo(prefix) {
    const info = PREFIX_INFO[prefix];
    if (!info) return;
    document.getElementById('pm-abbr').textContent  = prefix === 'irregular' ? 'irregular' : prefix + '-';
    document.getElementById('pm-title').textContent = info.title;
    document.getElementById('pm-desc').textContent  = info.desc;
    document.getElementById('pm-examples').innerHTML = info.examples.map(e =>
      `<div class="prefix-example-pair">
        <span class="pex-imp">${e.imp}</span>
        <span class="pex-arrow">→</span>
        <span class="pex-pfv">${e.pfv}</span>
        <span class="pex-en">— ${e.en}</span>
      </div>`
    ).join('');
    document.getElementById('prefix-modal-overlay').classList.add('open');
  }

  function closePrefixModal() {
    document.getElementById('prefix-modal-overlay').classList.remove('open');
  }

  function getCtxPrefix(drill) {
    return CTX_PREFIX_MAP[drill.pfv] || 'irregular';
  }

  function buildCtxDeck() {
    const filtered = CONTEXT_DRILLS.filter(d => ctxActiveFilters.has(getCtxPrefix(d)));
    for (let i = filtered.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [filtered[i], filtered[j]] = [filtered[j], filtered[i]];
    }
    ctxDeck  = filtered;
    ctxIndex = 0;
  }

  function toggleCtxPrefix(prefix, btn) {
    if (ctxActiveFilters.has(prefix) && ctxActiveFilters.size === 1) return;
    if (ctxActiveFilters.has(prefix)) {
      ctxActiveFilters.delete(prefix);
      btn.classList.remove('active');
    } else {
      ctxActiveFilters.add(prefix);
      btn.classList.add('active');
    }
    ctxScore = { correct: 0, total: 0 };
    buildCtxDeck();
    renderCtxCard();
  }

  // ═══════════════════════════════════════════════════
  //  SLAGALICA — state
  // ═══════════════════════════════════════════════════
  const SLAG_DIRECTIONS = [
    { key: 'sr',  label: 'Srp → Eng' },
    { key: 'en',  label: 'Eng → Srp' },
    { key: 'mix', label: 'Mixed'      },
  ];

  let slagBest           = loadSlagBest();
  let slagHistory        = loadSlagHistory();
  let slagChain          = 0;
  let slagDeck           = [];
  let slagUsed           = new Set();
  let slagCurrentCard    = null;
  let slagDirection      = 'sr';
  let slagActiveGroups   = new Set();
  let slagGroupsInited   = false;
  let slagAnswered       = false;
  let slagMissedCards    = [];   // wrong cards accumulated this session
  let slagMissedGameMode = false; // true when replaying only missed cards

  function loadSlagBest() {
    return parseInt(localStorage.getItem('slagalica-best-chain') || '0', 10);
  }
  function saveSlagBest() {
    localStorage.setItem('slagalica-best-chain', String(slagBest));
  }
  function loadSlagHistory() {
    try { return JSON.parse(localStorage.getItem('slagalica-history')) || []; }
    catch(e) { return []; }
  }
  function saveSlagHistory() {
    localStorage.setItem('slagalica-history', JSON.stringify(slagHistory));
  }

  // ─── Helpers ─────────────────────────────────────
  function slagFilteredCards() {
    if (slagActiveGroups.size === 0) return [];
    return cards.filter(c => slagActiveGroups.has(c.category || ''));
  }

  function slagShuffle(arr) {
    const a = [...arr];
    for (let i = a.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
  }

  function slagPickDistractors(correctCard, pool, dir) {
    const correctText = (dir === 'sr' ? correctCard.english : correctCard.serbian) || '';
    const getText = c => (dir === 'sr' ? c.english : c.serbian) || '';
    const seen = new Set([correctText.toLowerCase()]);
    const distractors = [];

    // Phase 1: prefer same-category cards for harder distractors
    const sameGroup = slagShuffle(
      pool.filter(c => c !== correctCard && (c.category || '') === (correctCard.category || ''))
    );
    for (const c of sameGroup) {
      const txt = getText(c);
      if (txt && !seen.has(txt.toLowerCase())) {
        seen.add(txt.toLowerCase());
        distractors.push(txt);
        if (distractors.length === 3) return distractors;
      }
    }

    // Phase 2: fill remaining slots from other groups
    const others = slagShuffle(
      pool.filter(c => c !== correctCard && (c.category || '') !== (correctCard.category || ''))
    );
    for (const c of others) {
      const txt = getText(c);
      if (txt && !seen.has(txt.toLowerCase())) {
        seen.add(txt.toLowerCase());
        distractors.push(txt);
        if (distractors.length === 3) break;
      }
    }
    return distractors;
  }

  function slagRenderDots(containerId) {
    const el = document.getElementById(containerId);
    if (!el) return;
    el.innerHTML = '';
    const last5 = slagHistory.slice(-5);
    while (last5.length < 5) last5.unshift(null);
    last5.forEach(val => {
      const dot = document.createElement('span');
      if (val === null) {
        dot.className = 'slag-dot';
      } else {
        dot.className = 'slag-dot ' + (val > 0 ? 'win' : 'loss');
        dot.title = `Chain: ${val}`;
      }
      el.appendChild(dot);
    });
  }

  // ─── Lobby ───────────────────────────────────────
  function renderSlagView() {
    if (!slagGroupsInited) {
      slagGroupsInited = true;
    }
    slagToLobby();
  }

  function slagToLobby() {
    document.getElementById('slag-lobby').style.display = 'flex';
    document.getElementById('slag-game').style.display  = 'none';
    document.getElementById('slag-over').style.display  = 'none';
    slagRenderLobby();
  }

  function slagRenderLobby() {
    document.getElementById('slag-best-display').textContent = slagBest;
    slagRenderDots('slag-dots');

    // Direction buttons
    const dirCont = document.getElementById('slag-dir-btns');
    if (dirCont.children.length !== SLAG_DIRECTIONS.length) {
      dirCont.innerHTML = '';
      SLAG_DIRECTIONS.forEach(d => {
        const btn = document.createElement('button');
        btn.className  = 'tense-btn' + (d.key === slagDirection ? ' active' : '');
        btn.textContent = d.label;
        btn.dataset.key = d.key;
        btn.addEventListener('click', () => {
          slagDirection = d.key;
          dirCont.querySelectorAll('.tense-btn').forEach(b =>
            b.classList.toggle('active', b.dataset.key === slagDirection));
        });
        dirCont.appendChild(btn);
      });
    } else {
      dirCont.querySelectorAll('.tense-btn').forEach(b =>
        b.classList.toggle('active', b.dataset.key === slagDirection));
    }

    slagRenderGroupFilter();
    slagCheckDeckSize();
  }

  function slagRenderGroupFilter() {
    const container = document.getElementById('slag-group-toggles');
    container.innerHTML = '';
    const presentGroups = [...new Set(cards.map(c => c.category || ''))];
    const bar = document.getElementById('slag-group-bar');
    if (presentGroups.length === 0) { bar.style.display = 'none'; return; }
    bar.style.display = '';

    presentGroups.forEach(g => {
      const label  = g || '(Uncategorized)';
      const color  = getGroupColor(g);
      const active = slagActiveGroups.has(g);
      const pill   = document.createElement('button');
      pill.className = 'group-pill' + (active ? ' active' : '');
      pill.style.setProperty('--gc', color);
      pill.textContent = label;
      pill.addEventListener('click', () => {
        if (slagActiveGroups.has(g)) {
          slagActiveGroups.delete(g);
          pill.classList.remove('active');
        } else {
          slagActiveGroups.add(g);
          pill.classList.add('active');
        }
        slagCheckDeckSize();
      });
      container.appendChild(pill);
    });
  }

  function slagSelectAllGroups() {
    cards.forEach(c => slagActiveGroups.add(c.category || ''));
    slagRenderGroupFilter();
    slagCheckDeckSize();
  }
  function slagClearGroups() {
    slagActiveGroups.clear();
    slagRenderGroupFilter();
    slagCheckDeckSize();
  }

  function slagCheckDeckSize() {
    const pool   = slagFilteredCards();
    const tooFew = pool.length < 8;
    document.getElementById('slag-too-few').style.display = tooFew ? 'block' : 'none';
    document.getElementById('slag-start-btn').disabled    = tooFew;
  }

  // ─── Game ────────────────────────────────────────
  function startSlagGame() {
    const pool = slagFilteredCards();
    if (pool.length < 8) return;
    slagChain          = 0;
    slagUsed           = new Set();
    slagDeck           = slagShuffle(pool);
    slagMissedGameMode = false;
    slagAnswered       = false;
    document.getElementById('slag-lobby').style.display = 'none';
    document.getElementById('slag-over').style.display  = 'none';
    document.getElementById('slag-game').style.display  = 'flex';
    document.getElementById('slag-game-best').textContent = slagBest;
    showSlagQuestion();
  }

  function startSlagMissedGame() {
    if (slagMissedCards.length < 1) return;
    slagChain          = 0;
    slagUsed           = new Set();
    slagDeck           = slagShuffle([...slagMissedCards]);
    slagMissedGameMode = true;
    slagAnswered       = false;
    document.getElementById('slag-lobby').style.display = 'none';
    document.getElementById('slag-over').style.display  = 'none';
    document.getElementById('slag-game').style.display  = 'flex';
    document.getElementById('slag-game-best').textContent = slagBest;
    showSlagQuestion();
  }

  function showSlagQuestion() {
    slagAnswered = false;

    // Pick next unused card; reshuffle if exhausted
    let card = null;
    for (const c of slagDeck) {
      if (!slagUsed.has(c)) { card = c; break; }
    }
    if (!card) {
      const refill = slagMissedGameMode ? [...slagMissedCards] : slagFilteredCards();
      slagDeck = slagShuffle(refill);
      slagUsed.clear();
      card = slagDeck[0];
    }
    slagUsed.add(card);
    slagCurrentCard = card;

    // Resolve direction for this question
    const dir = slagDirection === 'mix'
      ? (Math.random() < 0.5 ? 'sr' : 'en')
      : slagDirection;

    // Counters
    document.getElementById('slag-chain-num').textContent  = slagChain;
    document.getElementById('slag-game-best').textContent  = slagBest;

    // Direction badge
    document.getElementById('slag-dir-badge').textContent =
      dir === 'sr' ? 'Serbian → English' : 'English → Serbian';

    // Restart card animation
    const qCard = document.getElementById('slag-q-card');
    qCard.style.animation = 'none';
    void qCard.offsetHeight;
    qCard.style.animation = '';

    // Question text
    document.getElementById('slag-q-label').textContent =
      dir === 'sr' ? 'Translate to English' : 'Translate to Serbian';
    if (dir === 'sr') {
      document.getElementById('slag-q-word').textContent     = card.serbian;
      document.getElementById('slag-q-cyrillic').textContent = latinToCyrillic(card.serbian);
    } else {
      document.getElementById('slag-q-word').textContent     = card.english;
      document.getElementById('slag-q-cyrillic').textContent = '';
    }
    document.getElementById('slag-q-cat').textContent = '';

    // Build 4 options
    const correctText = (dir === 'sr' ? card.english : card.serbian) || '?';
    const pool        = slagFilteredCards();
    const distractors = slagPickDistractors(card, pool, dir);
    while (distractors.length < 3) distractors.push('—');
    const allOptions = slagShuffle([correctText, ...distractors]);

    const optCont = document.getElementById('slag-options');
    optCont.innerHTML = '';
    allOptions.forEach(opt => {
      const btn = document.createElement('button');
      btn.className   = 'slag-option';
      btn.textContent = opt;
      btn.addEventListener('click', () =>
        slagAnswer(btn, opt, correctText, card, dir));
      optCont.appendChild(btn);
    });
  }

  function slagAnswer(btn, chosen, correctText, card, dir) {
    if (slagAnswered) return;
    slagAnswered = true;

    const isCorrect = chosen.toLowerCase() === correctText.toLowerCase();

    // Reveal all correct/wrong states
    document.querySelectorAll('.slag-option').forEach(b => {
      b.disabled = true;
      if (b.textContent.toLowerCase() === correctText.toLowerCase())
        b.classList.add('correct');
    });
    if (!isCorrect) btn.classList.add('wrong');

    if (isCorrect) {
      slagChain++;
      setTimeout(showSlagQuestion, 600);
    } else {
      setTimeout(() => endSlagGame(card, dir, correctText), 900);
    }
  }

  function endSlagGame(wrongCard, dir, correctAnswer) {
    const finalScore = slagChain;
    const isRecord   = finalScore > 0 && finalScore > slagBest;
    if (isRecord) { slagBest = finalScore; saveSlagBest(); }

    slagHistory.push(finalScore);
    if (slagHistory.length > 20) slagHistory = slagHistory.slice(-20);
    saveSlagHistory();

    // Accumulate missed card for this session
    if (wrongCard && !slagMissedCards.includes(wrongCard)) {
      slagMissedCards.push(wrongCard);
    }
    // Show / update "Replay Missed" and "Clear Missed" buttons
    const replayBtn = document.getElementById('slag-replay-missed-btn');
    const clearBtn  = document.getElementById('slag-clear-missed-btn');
    if (replayBtn) {
      replayBtn.style.display = slagMissedCards.length > 0 ? '' : 'none';
      replayBtn.textContent   = `⚑ Replay Missed (${slagMissedCards.length})`;
    }
    if (clearBtn) {
      clearBtn.style.display  = slagMissedCards.length > 0 ? '' : 'none';
    }

    document.getElementById('slag-game').style.display = 'none';
    document.getElementById('slag-over').style.display = 'flex';

    document.getElementById('slag-final-score').textContent = finalScore;

    const recEl = document.getElementById('slag-record-msg');
    if (finalScore === 0) {
      recEl.textContent = '';
    } else if (isRecord) {
      recEl.textContent = '🏆 New record!';
    } else {
      recEl.textContent = `Best: ${slagBest}`;
    }

    // Wrong word box
    if (wrongCard) {
      const prompt = dir === 'sr' ? wrongCard.serbian : wrongCard.english;
      const cyril  = dir === 'sr'
        ? ` (${latinToCyrillic(wrongCard.serbian)})` : '';
      document.getElementById('slag-wrong-q').innerHTML =
        `You saw: <strong>${prompt}${cyril}</strong>`;
      document.getElementById('slag-wrong-ans').innerHTML =
        `Correct answer: <strong>${correctAnswer}</strong>`;
      document.getElementById('slag-wrong-box').style.display = '';
    } else {
      document.getElementById('slag-wrong-box').style.display = 'none';
    }

    slagRenderDots('slag-over-dots');

    // Refresh the lobby best for when they go back
    if (document.getElementById('slag-best-display'))
      document.getElementById('slag-best-display').textContent = slagBest;
  }

  function slagQuit() { slagToLobby(); }

  // ═══════════════════════════════════════════════════
  //  VIEW SWITCHER
  // ═══════════════════════════════════════════════════
  function showView(view) {
    document.getElementById('study-view').style.display      = view === 'study'      ? 'flex' : 'none';
    document.getElementById('grammar-view').style.display    = view === 'grammar'    ? 'flex' : 'none';
    document.getElementById('verbs-view').style.display      = view === 'verbs'      ? 'flex' : 'none';
    document.getElementById('adj-view').style.display        = view === 'adj'        ? 'flex' : 'none';
    document.getElementById('drill-view').style.display      = view === 'drill'      ? 'flex' : 'none';
    document.getElementById('aspect-view').style.display     = view === 'aspect'     ? 'flex' : 'none';
    document.getElementById('slagalica-view').style.display  = view === 'slagalica'  ? 'flex' : 'none';
    document.getElementById('manage-view').style.display     = view === 'manage'     ? 'flex' : 'none';
    ['study','grammar','verbs','adj','drill','aspect','slagalica','manage'].forEach(v =>
      document.getElementById(`nav-${v}`).classList.toggle('active', v === view)
    );
    if (view === 'study')      renderStudy();
    if (view === 'grammar')    renderGrammarView();
    if (view === 'verbs')      renderVerbView();
    if (view === 'adj')        renderAdjView();
    if (view === 'drill')      renderDrillView();
    if (view === 'aspect')     renderContextView();
    if (view === 'slagalica')  renderSlagView();
    if (view === 'manage')     renderManage();
  }

  // ═══════════════════════════════════════════════════
  //  FILL-IN DRILL
  // ═══════════════════════════════════════════════════
  let drillDeck          = [];
  let drillIndex         = 0;
  let drillScore         = { correct: 0, total: 0 };
  let drillScoredQ       = false;
  let drillAnswered      = false;
  let drillActiveTenses  = new Set(['present', 'past', 'future']);

  function getDrillTense(drill) {
    const h = drill.hint.toLowerCase();
    if (h.includes('future')) return 'future';
    if (h.includes('past'))   return 'past';
    return 'present';
  }

  function toggleDrillTense(tense, btn) {
    if (drillActiveTenses.has(tense) && drillActiveTenses.size === 1) return;
    if (drillActiveTenses.has(tense)) {
      drillActiveTenses.delete(tense);
      btn.classList.remove('active');
    } else {
      drillActiveTenses.add(tense);
      btn.classList.add('active');
    }
    drillScore = { correct: 0, total: 0 };
    buildDrillDeck();
    renderDrillCard();
  }

  function renderDrillView() {
    if (drillDeck.length === 0) buildDrillDeck();
    renderDrillCard();
  }

  function buildDrillDeck() {
    drillDeck = SENTENCE_DRILLS.reduce((acc, d, i) => {
      if (drillActiveTenses.has(getDrillTense(d))) acc.push(i);
      return acc;
    }, []);
    for (let i = drillDeck.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [drillDeck[i], drillDeck[j]] = [drillDeck[j], drillDeck[i]];
    }
    drillIndex = 0;
  }

  function renderDrillCard() {
    const drill = SENTENCE_DRILLS[drillDeck[drillIndex]];
    const sentenceHtml = drill.sr.replace('___', '<span class="drill-blank">___</span>');
    document.getElementById('drill-sentence-el').innerHTML = sentenceHtml;
    document.getElementById('drill-english-el').textContent = drill.en;
    document.getElementById('drill-hint-label').textContent = 'Complete the sentence';
    document.getElementById('drill-progress').textContent =
      `${drillIndex + 1} of ${drillDeck.length}`;
    document.getElementById('drill-prev-btn').disabled = drillIndex === 0;
    document.getElementById('drill-next-btn').disabled = drillIndex === drillDeck.length - 1;
    const fb = document.getElementById('drill-feedback');
    fb.style.display = 'none';
    fb.className = 'drill-feedback';
    drillScoredQ  = false;
    drillAnswered = false;
    buildDrillOptions(drill);
    updateDrillScore();
  }

  function buildDrillOptions(drill) {
    const container = document.getElementById('drill-options');
    container.innerHTML = '';
    const opts = [...drill.options];
    for (let i = opts.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [opts[i], opts[j]] = [opts[j], opts[i]];
    }
    opts.forEach(opt => {
      const btn = document.createElement('button');
      btn.className   = 'drill-option';
      btn.textContent = opt;
      btn.addEventListener('click', () => drillAnswer(opt, drill));
      container.appendChild(btn);
    });
  }

  function drillAnswer(chosen, drill) {
    if (drillAnswered) return;
    drillAnswered = true;
    const isCorrect = chosen === drill.answer;

    document.querySelectorAll('.drill-option').forEach(b => {
      b.disabled = true;
      if (b.textContent === drill.answer) b.classList.add('correct');
    });
    if (!isCorrect) {
      document.querySelectorAll('.drill-option').forEach(b => {
        if (b.textContent === chosen) b.classList.add('wrong');
      });
    }

    // Fill the blank with the correct answer
    const fillClass = isCorrect ? 'correct' : 'wrong';
    document.getElementById('drill-sentence-el').innerHTML =
      drill.sr.replace('___', `<span class="drill-blank-fill ${fillClass}">${drill.answer}</span>`);

    // Reveal verb hint in the card label
    document.getElementById('drill-hint-label').textContent = drill.hint;

    // Feedback box
    const fb = document.getElementById('drill-feedback');
    fb.className = `drill-feedback ${isCorrect ? 'correct' : 'wrong'}`;
    fb.innerHTML = isCorrect
      ? `<strong style="color:#55efc4">✓ Correct!</strong><span class="df-hint">${drill.hint}</span>`
      : `<strong style="color:#e94560">✗ You chose: ${chosen}</strong> — correct: <strong style="color:#55efc4">${drill.answer}</strong><span class="df-hint">${drill.hint}</span>`;
    fb.style.display = '';

    if (!drillScoredQ) {
      if (isCorrect) drillScore.correct++;
      drillScore.total++;
      drillScoredQ = true;
    }
    updateDrillScore();
  }

  function updateDrillScore() {
    document.getElementById('drill-score-val').textContent =
      `${drillScore.correct} / ${drillScore.total}`;
  }

  function drillNext() {
    if (drillIndex < drillDeck.length - 1) { drillIndex++; renderDrillCard(); }
  }
  function drillPrev() {
    if (drillIndex > 0) { drillIndex--; renderDrillCard(); }
  }
  function shuffleDrill() {
    for (let i = drillDeck.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [drillDeck[i], drillDeck[j]] = [drillDeck[j], drillDeck[i]];
    }
    drillIndex = 0;
    drillScore = { correct: 0, total: 0 };
    renderDrillCard();
  }

  // ═══════════════════════════════════════════════════
  //  STUDY
  // ═══════════════════════════════════════════════════
  function buildDeck() {
    if (missedOnlyMode) {
      deck = [...missedCards].filter(i => i < cards.length);
    } else {
      deck = cards.reduce((acc, card, i) => {
        const g = card.category || '';
        if (activeStudyGroups.has(g)) acc.push(i);
        return acc;
      }, []);
    }
    index = 0;
  }

  function renderStudy() {
    renderStudyGroupFilter();
    if (missedOnlyMode) {
      document.getElementById('group-filter-bar').style.display = 'none';
    }
    buildDeck();
    updateMissedCount();

    const has = deck.length > 0;
    document.getElementById('scene').style.display         = has ? 'block' : 'none';
    document.getElementById('progress').style.display      = has ? 'block' : 'none';
    document.querySelector('.study-controls').style.display = has ? 'flex'  : 'none';
    const emptyEl = document.getElementById('empty-study');
    emptyEl.style.display = has ? 'none' : 'block';
    if (!has) emptyEl.innerHTML = missedOnlyMode
      ? 'No missed cards yet. Mark cards with the <strong>⚑ Mark</strong> button.'
      : 'No cards match the selected groups.<br>Select more groups above or add cards in <strong>Manage Cards</strong>.';
    if (has) showCard();
  }

  function renderStudyGroupFilter() {
    const container = document.getElementById('study-group-toggles');
    container.innerHTML = '';

    const hasUncategorized = cards.some(c => !c.category);
    const allPills = [...groups, ...(hasUncategorized ? [''] : [])];

    if (allPills.length === 0) {
      document.getElementById('group-filter-bar').style.display = 'none';
      return;
    }
    document.getElementById('group-filter-bar').style.display = 'flex';

    allPills.forEach((g, i) => {
      const color = getGroupColor(g);
      const btn = document.createElement('button');
      btn.className = 'group-pill' + (activeStudyGroups.has(g) ? ' active' : '');
      btn.textContent = g || 'Uncategorized';
      btn.style.setProperty('--gc', color);
      btn.onclick = () => {
        if (activeStudyGroups.has(g)) {
          activeStudyGroups.delete(g);
          btn.classList.remove('active');
        } else {
          activeStudyGroups.add(g);
          btn.classList.add('active');
        }
        buildDeck();
        const has = deck.length > 0;
        document.getElementById('scene').style.display         = has ? 'block' : 'none';
        document.getElementById('progress').style.display      = has ? 'block' : 'none';
        document.querySelector('.study-controls').style.display = has ? 'flex'  : 'none';
        document.getElementById('empty-study').style.display   = has ? 'none'  : 'block';
        if (has) showCard();
      };
      container.appendChild(btn);
    });
  }

  function selectAllStudyGroups() {
    const hasUncategorized = cards.some(c => !c.category);
    activeStudyGroups = new Set([...groups, ...(hasUncategorized ? [''] : [])]);
    renderStudy();
  }

  function clearAllStudyGroups() {
    activeStudyGroups = new Set();
    renderStudy();
  }

  function showCard() {
    const card = cards[deck[index]];
    const flipped = direction === 'en';
    document.getElementById('front-label').textContent    = flipped ? 'English' : 'Serbian';
    document.getElementById('back-label').textContent     = flipped ? 'Serbian' : 'English';
    document.getElementById('front-word').textContent     = flipped ? card.english : card.serbian;
    document.getElementById('back-word').textContent      = flipped ? card.serbian : card.english;
    document.getElementById('front-cyrillic').textContent = flipped ? '' : latinToCyrillic(card.serbian);
    document.getElementById('back-cyrillic').textContent  = flipped ? latinToCyrillic(card.serbian) : '';
    document.getElementById('back-category').textContent = card.category || '';
    const noteEl = document.getElementById('back-note');
    if (card.note) { noteEl.textContent = card.note; noteEl.style.display = 'block'; }
    else           { noteEl.textContent = '';         noteEl.style.display = 'none';  }
    document.getElementById('scene').classList.remove('flipped');
    document.getElementById('progress').textContent = `Card ${index + 1} of ${deck.length}`;
    document.getElementById('prev-btn').disabled = index === 0;
    document.getElementById('next-btn').disabled = index === deck.length - 1;
    const cardIdx = deck[index];
    const markBtn = document.getElementById('mark-missed-btn');
    markBtn.classList.toggle('active', missedCards.has(cardIdx));
  }

  function flipCard()  { document.getElementById('scene').classList.toggle('flipped'); }
  function nextCard()  { if (index < deck.length - 1) { index++; showCard(); } }
  function prevCard()  { if (index > 0) { index--; showCard(); } }

  // Mobile swipe support for flashcards
  (function() {
    const scene = document.getElementById('scene');
    let touchStartX = 0;
    let touchStartY = 0;

    scene.addEventListener('touchstart', function(e) {
      touchStartX = e.changedTouches[0].clientX;
      touchStartY = e.changedTouches[0].clientY;
    }, { passive: true });

    scene.addEventListener('touchend', function(e) {
      const dx = e.changedTouches[0].clientX - touchStartX;
      const dy = e.changedTouches[0].clientY - touchStartY;
      // Only treat as a horizontal swipe if horizontal movement dominates
      if (Math.abs(dx) > 50 && Math.abs(dx) > Math.abs(dy)) {
        e.preventDefault(); // suppress the click so the card doesn't flip
        if (dx < 0) nextCard();
        else prevCard();
      }
    });
  })();

  function shuffle() {
    for (let i = deck.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [deck[i], deck[j]] = [deck[j], deck[i]];
    }
    index = 0; showCard();
  }

  function setDirection(dir) {
    direction = dir;
    document.getElementById('dir-sr').classList.toggle('active', dir === 'sr');
    document.getElementById('dir-en').classList.toggle('active', dir === 'en');
    showCard();
  }

  function toggleMissed() {
    if (!deck.length) return;
    const cardIdx = deck[index];
    if (missedCards.has(cardIdx)) {
      missedCards.delete(cardIdx);
    } else {
      missedCards.add(cardIdx);
    }
    saveMissedCards();
    updateMissedCount();
    const markBtn = document.getElementById('mark-missed-btn');
    markBtn.classList.toggle('active', missedCards.has(cardIdx));
  }

  function toggleMissedMode() {
    missedOnlyMode = !missedOnlyMode;
    document.getElementById('dir-missed').classList.toggle('active', missedOnlyMode);
    if (missedOnlyMode) {
      document.getElementById('group-filter-bar').style.display = 'none';
    } else {
      const hasUncategorized = cards.some(c => !c.category);
      const allPills = [...groups, ...(hasUncategorized ? [''] : [])];
      if (allPills.length > 0) {
        document.getElementById('group-filter-bar').style.display = 'flex';
      }
    }
    buildDeck();
    const has = deck.length > 0;
    document.getElementById('scene').style.display         = has ? 'block' : 'none';
    document.getElementById('progress').style.display      = has ? 'block' : 'none';
    document.querySelector('.study-controls').style.display = has ? 'flex'  : 'none';
    const emptyEl = document.getElementById('empty-study');
    emptyEl.style.display = has ? 'none' : 'block';
    if (!has) emptyEl.innerHTML = missedOnlyMode
      ? 'No missed cards yet. Mark cards with the <strong>⚑ Mark</strong> button.'
      : 'No cards match the selected groups.<br>Select more groups above or add cards in <strong>Manage Cards</strong>.';
    if (has) showCard();
  }

  function updateMissedCount() {
    document.getElementById('missed-count').textContent = missedCards.size;
    document.getElementById('dir-clear-missed').style.display = missedCards.size > 0 ? 'inline-block' : 'none';
  }

  function clearMissedCards() {
    missedCards.clear();
    saveMissedCards();
    // If currently in missed-only mode, exit it first
    if (missedOnlyMode) toggleMissedMode();
    updateMissedCount();
    // Update the mark button state for the current card
    const markBtn = document.getElementById('mark-missed-btn');
    if (deck.length) markBtn.classList.remove('active');
  }

  function clearSlagMissed() {
    slagMissedCards = [];
    document.getElementById('slag-replay-missed-btn').style.display = 'none';
    document.getElementById('slag-clear-missed-btn').style.display  = 'none';
  }

  // ═══════════════════════════════════════════════════
  //  GRAMMAR
  // ═══════════════════════════════════════════════════
  function renderGrammarView() {
    buildCaseToggles();
    renderGrammarNoun();
  }

  function buildCaseToggles() {
    const container = document.getElementById('case-toggles');
    if (container.children.length === CASES.length) return;
    container.innerHTML = '';
    CASES.forEach(c => {
      const btn = document.createElement('button');
      btn.className = 'case-toggle active';
      btn.textContent = c.abbr;
      btn.dataset.key = c.key;
      btn.dataset.tip = `${c.label} — ${c.hint}`;
      btn.title = `${c.label} (${c.hint})`;
      btn.addEventListener('click', () => toggleCase(c.key, btn));
      container.appendChild(btn);
    });
  }

  function toggleCase(key, btn) {
    if (activeCases.has(key)) {
      if (activeCases.size === 1) return;
      activeCases.delete(key);
      btn.classList.remove('active');
    } else {
      activeCases.add(key);
      btn.classList.add('active');
    }
    renderCaseInputs();
  }

  function renderGrammarNoun() {
    const has = grammarNouns.length > 0;
    document.getElementById('g-noun-card').style.display      = has ? 'flex'  : 'none';
    document.getElementById('case-inputs').style.display      = has ? 'flex'  : 'none';
    document.querySelector('.grammar-controls').style.display  = has ? 'flex'  : 'none';
    document.getElementById('empty-grammar').style.display    = has ? 'none'  : 'block';
    if (!has) return;

    const noun = grammarNouns[gIndex];
    document.getElementById('g-display-nom').textContent      = noun.forms.nominativ;
    document.getElementById('g-display-cyrillic').textContent = latinToCyrillic(noun.forms.nominativ);
    document.getElementById('g-display-en').textContent       = noun.english;
    document.getElementById('g-progress').textContent    = `Noun ${gIndex + 1} of ${grammarNouns.length}`;
    document.getElementById('g-prev-btn').disabled = gIndex === 0;
    document.getElementById('g-next-btn').disabled = gIndex === grammarNouns.length - 1;

    const genderEl = document.getElementById('g-display-gender');
    genderEl.textContent = noun.gender;
    genderEl.className   = 'gender-badge ' + { masculine:'gender-m', feminine:'gender-f', neuter:'gender-n' }[noun.gender];

    gCasesAnswered = new Set();
    renderCaseInputs();
    updateGScore();
  }

  function shuffleArr(arr) {
    const a = [...arr];
    for (let i = a.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
  }

  function getNounDistractors(correct, caseKey, nounIdx) {
    const pool = new Set();
    // Only use other case forms of the same noun
    CASES.forEach(c => {
      if (c.key !== caseKey) pool.add(grammarNouns[nounIdx].forms[c.key]);
    });
    pool.delete(correct);
    return shuffleArr([...pool].filter(Boolean)).slice(0, 3);
  }

  function getAdjDistractors(correct, caseKey, genderKey, adjIdx) {
    const pool = new Set();
    // Only use other forms of the same adjective
    const adj = allAdjectives[adjIdx];
    if (adj && adj.forms) {
      // Other cases, same gender
      CASES.forEach(c => {
        if (c.key !== caseKey && adj.forms[genderKey]) pool.add(adj.forms[genderKey][c.key]);
      });
      // Same case, other genders
      ['masculine', 'feminine', 'neuter'].forEach(g => {
        if (g !== genderKey && adj.forms[g]) pool.add(adj.forms[g][caseKey]);
      });
    }
    pool.delete(correct);
    return shuffleArr([...pool].filter(Boolean)).slice(0, 3);
  }

  function renderCaseInputs() {
    const container = document.getElementById('case-inputs');
    container.innerHTML = '';
    const noun = grammarNouns[gIndex];
    CASES.forEach(c => {
      const row = document.createElement('div');
      row.className = 'case-row' + (activeCases.has(c.key) ? '' : ' hidden');
      row.id = `g-row-${c.key}`;

      const correct = noun ? noun.forms[c.key] : '';
      const distractors = getNounDistractors(correct, c.key, gIndex);
      const options = shuffleArr([correct, ...distractors]);
      const ex = noun ? c.example(correct, noun.english) : null;
      const exSr = ex ? ex.sr.replace(correct, '…') : null;

      const header = document.createElement('div');
      header.className = 'mc-case-header';
      header.innerHTML = `
        <span class="case-abbr">${c.abbr}</span>
        <div class="case-name-col">
          <span class="case-name-main">${c.label}</span>
          <span class="case-name-hint">${c.hint}</span>
        </div>
        <button class="case-info-btn" onclick="showCaseModal('${c.key}')" title="About the ${c.label}">?</button>
      `;
      row.appendChild(header);

      const mcDiv = document.createElement('div');
      mcDiv.className = 'mc-options';
      mcDiv.id = `g-mc-${c.key}`;
      options.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'mc-btn';
        btn.textContent = opt;
        btn.addEventListener('click', () => nounMCClick(btn, mcDiv, c.key, correct));
        mcDiv.appendChild(btn);
      });
      row.appendChild(mcDiv);

      if (ex) {
        const exDiv = document.createElement('div');
        exDiv.className = 'case-example';
        exDiv.innerHTML = `
          <span class="ex-arrow">→</span>
          <span class="ex-sr">${exSr}</span>
          <span class="ex-sep">—</span>
          <span class="ex-en">${ex.en}</span>
        `;
        row.appendChild(exDiv);
      }

      container.appendChild(row);
    });
  }

  function nounMCClick(clickedBtn, mcDiv, caseKey, correct) {
    mcDiv.querySelectorAll('.mc-btn').forEach(b => b.disabled = true);
    const ok = normalizeSerbian(clickedBtn.textContent) === normalizeSerbian(correct);
    if (ok) {
      clickedBtn.classList.add('mc-correct');
    } else {
      clickedBtn.classList.add('mc-wrong');
      mcDiv.querySelectorAll('.mc-btn').forEach(b => {
        if (normalizeSerbian(b.textContent) === normalizeSerbian(correct)) b.classList.add('mc-reveal');
      });
    }
    if (!gCasesAnswered.has(caseKey)) {
      gCasesAnswered.add(caseKey);
      gScore.correct += ok ? 1 : 0;
      gScore.total   += 1;
      updateGScore();
    }
  }

  function normalizeSerbian(str) {
    return str.toLowerCase()
      .replace(/č/g, 'c').replace(/ć/g, 'c')
      .replace(/š/g, 's').replace(/ž/g, 'z')
      .replace(/đ/g, 'd').replace(/dž/g, 'dz');
  }

  // Serbian Latin → Cyrillic (1-to-1 mapping; digraphs handled first)
  function latinToCyrillic(str) {
    if (!str) return '';
    const pairs = [
      // Digraphs — must come before their component letters
      ['LJ','Љ'], ['Lj','Љ'], ['lj','љ'],
      ['NJ','Њ'], ['Nj','Њ'], ['nj','њ'],
      ['DŽ','Џ'], ['Dž','Џ'], ['dž','џ'],
      // Single characters
      ['A','А'], ['a','а'], ['B','Б'], ['b','б'],
      ['C','Ц'], ['c','ц'], ['Č','Ч'], ['č','ч'],
      ['Ć','Ћ'], ['ć','ћ'], ['D','Д'], ['d','д'],
      ['Đ','Ђ'], ['đ','ђ'], ['E','Е'], ['e','е'],
      ['F','Ф'], ['f','ф'], ['G','Г'], ['g','г'],
      ['H','Х'], ['h','х'], ['I','И'], ['i','и'],
      ['J','Ј'], ['j','ј'], ['K','К'], ['k','к'],
      ['L','Л'], ['l','л'], ['M','М'], ['m','м'],
      ['N','Н'], ['n','н'], ['O','О'], ['o','о'],
      ['P','П'], ['p','п'], ['R','Р'], ['r','р'],
      ['S','С'], ['s','с'], ['Š','Ш'], ['š','ш'],
      ['T','Т'], ['t','т'], ['U','У'], ['u','у'],
      ['V','В'], ['v','в'], ['Z','З'], ['z','з'],
      ['Ž','Ж'], ['ž','ж'],
    ];
    let result = str;
    for (const [from, to] of pairs) result = result.split(from).join(to);
    return result;
  }

  function checkGrammar() {
    if (!grammarNouns.length) return;
    const noun = grammarNouns[gIndex];
    CASES.forEach(c => {
      if (!activeCases.has(c.key)) return;
      if (gCasesAnswered.has(c.key)) return;
      const mcDiv = document.getElementById(`g-mc-${c.key}`);
      if (!mcDiv) return;
      const correct = noun.forms[c.key];
      mcDiv.querySelectorAll('.mc-btn').forEach(b => {
        b.disabled = true;
        if (normalizeSerbian(b.textContent) === normalizeSerbian(correct)) b.classList.add('mc-reveal');
      });
      gCasesAnswered.add(c.key);
    });
  }

  function updateGScore() {
    document.getElementById('g-score-val').textContent = `${gScore.correct} / ${gScore.total}`;
  }

  function showCaseModal(caseKey) {
    const caseInfo = CASES.find(c => c.key === caseKey);
    if (!caseInfo) return;
    const noun = grammarNouns[gIndex];
    const ex   = noun ? caseInfo.example(noun.forms[caseKey], noun.english) : null;

    document.getElementById('mc-abbr').textContent = caseInfo.abbr;
    document.getElementById('mc-name').textContent = caseInfo.label;
    document.getElementById('mc-hint').textContent = caseInfo.hint;
    document.getElementById('mc-desc').textContent = caseInfo.description;

    const prepGrid    = document.getElementById('mc-preps');
    const prepNote    = document.getElementById('mc-prep-note');
    const prepSection = document.getElementById('mc-prep-section');

    prepGrid.innerHTML = caseInfo.prepositions.map(p =>
      `<div class="prep-tag">
        <span class="pt-prep">${p.prep}</span>
        <span class="pt-meaning">${p.meaning}</span>
      </div>`
    ).join('');
    prepSection.style.display = (caseInfo.prepositions.length > 0 || caseInfo.prepNote) ? 'flex' : 'none';
    prepNote.textContent  = caseInfo.prepNote;
    prepNote.style.display = caseInfo.prepNote ? 'block' : 'none';

    const exSection = document.getElementById('mc-ex-section');
    if (ex) {
      document.getElementById('mc-ex-sr').textContent = ex.sr;
      document.getElementById('mc-ex-en').textContent = ex.en;
      exSection.style.display = 'flex';
    } else {
      exSection.style.display = 'none';
    }

    document.getElementById('case-modal-overlay').classList.add('open');
  }

  function closeCaseModal() {
    document.getElementById('case-modal-overlay').classList.remove('open');
  }

  function gNext() { if (gIndex < grammarNouns.length - 1) { gIndex++; renderGrammarNoun(); } }
  function gPrev() { if (gIndex > 0) { gIndex--; renderGrammarNoun(); } }

  function shuffleGrammar() {
    for (let i = grammarNouns.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [grammarNouns[i], grammarNouns[j]] = [grammarNouns[j], grammarNouns[i]];
    }
    gIndex = 0;
    renderGrammarNoun();
  }

  // ═══════════════════════════════════════════════════
  //  VERBS
  // ═══════════════════════════════════════════════════
  function buildAllVerbs() {
    allVerbs = [...VERBS, ...userVerbs];
  }

  function renderVerbView() {
    buildAllVerbs();
    buildTenseButtons();
    buildSubjectToggles();
    renderVerbCard();
  }

  function buildTenseButtons() {
    const container = document.getElementById('tense-btns');
    if (container.children.length === TENSES.length) {
      // Update active state only
      container.querySelectorAll('.tense-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.key === activeTense);
      });
      return;
    }
    container.innerHTML = '';
    TENSES.forEach(t => {
      const btn = document.createElement('button');
      btn.className = 'tense-btn' + (t.key === activeTense ? ' active' : '');
      btn.textContent = `${t.label} — ${t.note}`;
      btn.dataset.key = t.key;
      btn.addEventListener('click', () => {
        activeTense = t.key;
        container.querySelectorAll('.tense-btn').forEach(b => b.classList.toggle('active', b.dataset.key === activeTense));
        vScoredVerb = false;
        renderVerbInputs();
      });
      container.appendChild(btn);
    });
  }

  function buildSubjectToggles() {
    const container = document.getElementById('subject-toggles');
    if (container.children.length === SUBJECTS.length) return;
    container.innerHTML = '';
    SUBJECTS.forEach(s => {
      const btn = document.createElement('button');
      btn.className = 'case-toggle' + (activeSubjects.has(s.key) ? ' active' : '');
      btn.textContent = s.key;
      btn.dataset.key = s.key;
      btn.dataset.tip = `${s.label} — ${s.pronoun}`;
      btn.title = `${s.label} (${s.pronoun})`;
      btn.addEventListener('click', () => {
        if (activeSubjects.has(s.key)) {
          if (activeSubjects.size === 1) return;
          activeSubjects.delete(s.key);
          btn.classList.remove('active');
        } else {
          activeSubjects.add(s.key);
          btn.classList.add('active');
        }
        renderVerbInputs();
      });
      container.appendChild(btn);
    });
  }

  function renderVerbCard() {
    const has = allVerbs.length > 0;
    document.getElementById('v-verb-card').style.display       = has ? 'flex' : 'none';
    document.getElementById('verb-inputs').style.display       = has ? 'flex' : 'none';
    document.querySelector('#verbs-view .grammar-controls').style.display = has ? 'flex' : 'none';
    document.getElementById('empty-verbs').style.display       = has ? 'none' : 'block';
    if (!has) return;

    if (vIndex >= allVerbs.length) vIndex = 0;
    const verb = allVerbs[vIndex];
    document.getElementById('v-display-inf').textContent      = verb.infinitive;
    document.getElementById('v-display-cyrillic').textContent = latinToCyrillic(verb.infinitive);
    document.getElementById('v-display-en').textContent       = verb.english;
    document.getElementById('v-progress').textContent    = `Verb ${vIndex + 1} of ${allVerbs.length}`;
    document.getElementById('v-prev-btn').disabled = vIndex === 0;
    document.getElementById('v-next-btn').disabled = vIndex === allVerbs.length - 1;

    const ab = document.getElementById('v-display-aspect');
    const aspectLabels = { imp: 'imperfective', pfv: 'perfective', bi: 'biaspectual' };
    ab.textContent = aspectLabels[verb.aspect] || '';
    ab.className   = `aspect-badge aspect-${verb.aspect || ''}`;

    vScoredVerb = false;
    renderVerbInputs();
    updateVScore();
  }

  function renderVerbInputs() {
    const container = document.getElementById('verb-inputs');
    container.innerHTML = '';
    if (!allVerbs.length) return;
    const verb = allVerbs[vIndex];

    SUBJECTS.forEach(s => {
      const row = document.createElement('div');
      row.className = 'case-row' + (activeSubjects.has(s.key) ? '' : ' hidden');
      row.id = `v-row-${s.key}`;
      row.innerHTML = `
        <div class="subj-row-main">
          <div class="subj-label-col">
            <span class="subj-label-main">${s.label}</span>
            <span class="subj-label-hint">${s.pronoun}</span>
          </div>
          <input class="case-inp" id="v-inp-${s.key}" type="text"
            placeholder="${activeTense} form…"
            autocomplete="off" autocorrect="off" spellcheck="false" />
          <div class="case-feedback" id="v-fb-${s.key}"></div>
        </div>
      `;
      container.appendChild(row);
      document.getElementById(`v-inp-${s.key}`).addEventListener('keydown', e => {
        if (e.key === 'Enter') checkVerbs();
      });
    });
  }

  function checkVerbs() {
    if (!allVerbs.length) return;
    const verb = allVerbs[vIndex];
    let correct = 0, total = 0;
    SUBJECTS.forEach(s => {
      if (!activeSubjects.has(s.key)) return;
      const inp = document.getElementById(`v-inp-${s.key}`);
      const fb  = document.getElementById(`v-fb-${s.key}`);
      if (!inp) return;
      const expected = (verb.conjugations[activeTense] || {})[s.key] || '';
      const ok = normalizeSerbian(inp.value.trim()) === normalizeSerbian(expected);
      inp.classList.toggle('g-correct',   ok);
      inp.classList.toggle('g-incorrect', !ok);
      fb.innerHTML = ok
        ? `<span class="fb-correct">✓</span>`
        : `<span class="fb-incorrect">✗</span><span class="fb-answer">${expected}<br><span style="color:#74b9ff;font-style:normal">${latinToCyrillic(expected)}</span></span>`;
      total++;
      if (ok) correct++;
    });
    if (!vScoredVerb) {
      vScore.correct += correct;
      vScore.total   += total;
      vScoredVerb = true;
    }
    updateVScore();
  }

  function updateVScore() {
    document.getElementById('v-score-val').textContent = `${vScore.correct} / ${vScore.total}`;
  }

  function vNext() { if (vIndex < allVerbs.length - 1) { vIndex++; renderVerbCard(); } }
  function vPrev() { if (vIndex > 0) { vIndex--; renderVerbCard(); } }

  function shuffleVerbs() {
    buildAllVerbs();
    for (let i = allVerbs.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [allVerbs[i], allVerbs[j]] = [allVerbs[j], allVerbs[i]];
    }
    vIndex = 0;
    renderVerbCard();
  }

  function setVerbAspect(a) {
    addVerbAspect = a;
    ['imp','pfv','bi'].forEach(k => {
      document.getElementById(`vn-asp-${k}`).classList.toggle('active', k === a);
    });
  }

  // ─── Manage: user verb CRUD ─────────────────────────────────────────────
  function addUserVerb() {
    const infinitive = document.getElementById('vn-infinitive').value.trim();
    const english    = document.getElementById('vn-english').value.trim();
    if (!infinitive || !english) { alert('Please fill in the infinitive and English meaning.'); return; }

    const keys = ['ja','ti','on','mi','vi','oni'];
    const tenses = ['pres','past','fut'];
    const tenseMap = { pres: 'present', past: 'past', fut: 'future' };
    const conjugations = { present: {}, past: {}, future: {} };
    const missing = [];

    tenses.forEach(t => {
      keys.forEach(k => {
        const val = document.getElementById(`vn-${t}-${k}`).value.trim();
        if (!val) missing.push(`${tenseMap[t]}/${k}`);
        conjugations[tenseMap[t]][k] = val;
      });
    });

    if (missing.length) { alert(`Please fill in: ${missing.slice(0, 5).join(', ')}${missing.length > 5 ? '…' : ''}`); return; }

    userVerbs.push({ infinitive, english, aspect: addVerbAspect, conjugations });
    saveUserVerbs(userVerbs);
    buildAllVerbs();

    // Clear form
    document.getElementById('vn-infinitive').value = '';
    document.getElementById('vn-english').value = '';
    [...tenses].forEach(t => keys.forEach(k => document.getElementById(`vn-${t}-${k}`).value = ''));
    document.getElementById('vn-infinitive').focus();
    renderVerbList();
  }

  function deleteUserVerb(i) {
    if (!confirm(`Delete "${userVerbs[i].infinitive}"?`)) return;
    userVerbs.splice(i, 1);
    saveUserVerbs(userVerbs);
    buildAllVerbs();
    if (vIndex >= allVerbs.length) vIndex = Math.max(0, allVerbs.length - 1);
    renderVerbList();
  }

  function renderVerbList() {
    const list = document.getElementById('vn-list');
    document.getElementById('vn-count').textContent = `(${userVerbs.length})`;
    list.innerHTML = '';
    if (userVerbs.length === 0) {
      list.innerHTML = '<p style="color:#aaa">No user verbs yet. Add one above!</p>';
      return;
    }
    userVerbs.forEach((v, i) => {
      const row = document.createElement('div');
      row.className = 'noun-row';
      row.innerHTML = `
        <div class="noun-row-top">
          <span class="nom">${v.infinitive}</span>
          <span class="eng">${v.english}</span>
          <button class="del-btn" onclick="deleteUserVerb(${i})">Delete</button>
        </div>
        <div class="noun-row-forms" style="grid-template-columns:repeat(6,1fr)">
          ${SUBJECTS.map(s => `
            <div class="noun-form-cell">
              <span class="noun-form-case">${s.key}</span>
              <span class="noun-form-val">${(v.conjugations.present || {})[s.key] || '—'}</span>
            </div>`).join('')}
        </div>
      `;
      list.appendChild(row);
    });
  }

  // ═══════════════════════════════════════════════════
  //  ADJECTIVES
  // ═══════════════════════════════════════════════════
  function buildAllAdjectives() {
    allAdjectives = [...ADJECTIVES, ...userAdjectives];
  }

  function renderAdjView() {
    buildAllAdjectives();
    buildAdjCaseToggles();
    renderAdjCard();
  }

  function buildAdjCaseToggles() {
    const container = document.getElementById('adj-case-toggles');
    if (container.children.length === CASES.length) return;
    container.innerHTML = '';
    CASES.forEach(c => {
      const btn = document.createElement('button');
      btn.className = 'case-toggle' + (adjActiveCases.has(c.key) ? ' active' : '');
      btn.textContent = c.abbr;
      btn.dataset.key = c.key;
      btn.title = `${c.label} (${c.hint})`;
      btn.addEventListener('click', () => {
        if (adjActiveCases.has(c.key)) {
          if (adjActiveCases.size === 1) return;
          adjActiveCases.delete(c.key);
          btn.classList.remove('active');
        } else {
          adjActiveCases.add(c.key);
          btn.classList.add('active');
        }
        renderAdjInputs();
      });
      container.appendChild(btn);
    });
  }

  function renderAdjCard() {
    const has = allAdjectives.length > 0;
    document.getElementById('adj-card').style.display        = has ? 'flex' : 'none';
    document.getElementById('adj-inputs').style.display      = has ? 'flex' : 'none';
    document.querySelector('#adj-view .grammar-controls').style.display = has ? 'flex' : 'none';
    document.getElementById('empty-adj').style.display       = has ? 'none' : 'block';
    if (!has) return;

    if (adjIndex >= allAdjectives.length) adjIndex = 0;
    const adj = allAdjectives[adjIndex];
    document.getElementById('adj-display-base').textContent     = adj.base;
    document.getElementById('adj-display-cyrillic').textContent = latinToCyrillic(adj.base);
    document.getElementById('adj-display-en').textContent       = adj.english;
    document.getElementById('adj-progress').textContent = `Adj ${adjIndex + 1} of ${allAdjectives.length}`;
    document.getElementById('adj-prev-btn').disabled = adjIndex === 0;
    document.getElementById('adj-next-btn').disabled = adjIndex === allAdjectives.length - 1;

    adjCasesAnswered = new Set();
    renderAdjInputs();
    updateAdjScore();
  }

  const ADJ_EX_NOUNS = {
    masculine: { nominativ:'čovek', genitiv:'čoveka', dativ:'čoveku',  akuzativ:'čoveka', vokativ:'čoveče', instrumental:'čovekom',  lokativ:'čoveku'  },
    feminine:  { nominativ:'žena',  genitiv:'žene',   dativ:'ženi',    akuzativ:'ženu',   vokativ:'ženo',   instrumental:'ženom',    lokativ:'ženi'    },
    neuter:    { nominativ:'dete',  genitiv:'deteta', dativ:'detetu',  akuzativ:'dete',   vokativ:'dete',   instrumental:'detetom',  lokativ:'detetu'  },
  };
  const ADJ_EX_NOUNS_EN = { masculine: 'man', feminine: 'woman', neuter: 'child' };

  function renderAdjInputs() {
    const container = document.getElementById('adj-inputs');
    container.innerHTML = '';
    if (!allAdjectives.length) return;

    const genders = [
      { key: 'masculine', label: 'Masc', cls: 'hdr-m' },
      { key: 'feminine',  label: 'Fem',  cls: 'hdr-f' },
      { key: 'neuter',    label: 'Neut', cls: 'hdr-n' },
    ];

    const adj = allAdjectives[adjIndex];
    CASES.forEach(c => {
      const row = document.createElement('div');
      row.className = 'case-row' + (adjActiveCases.has(c.key) ? '' : ' hidden');
      row.id = `adj-row-${c.key}`;

      const rowMain = document.createElement('div');
      rowMain.className = 'adj-row-main';

      const caseInfo = document.createElement('div');
      caseInfo.className = 'adj-case-info';
      caseInfo.innerHTML = `
        <button class="adj-case-abbr-btn" onclick="showCaseModal('${c.key}')">${c.abbr}</button>
        <span class="adj-case-name">${c.label}</span>
        <span class="adj-case-hint-txt">${c.hint}</span>
      `;
      rowMain.appendChild(caseInfo);

      genders.forEach(g => {
        const correct = ((adj.forms || {})[g.key] || {})[c.key] || '';
        const distractors = getAdjDistractors(correct, c.key, g.key, adjIndex);
        const options = shuffleArr([correct, ...distractors]);
        const nounForm = ADJ_EX_NOUNS[g.key][c.key];
        const ex = c.example(`${correct} ${nounForm}`, `${adj.english} ${ADJ_EX_NOUNS_EN[g.key]}`);

        const col = document.createElement('div');
        col.className = 'adj-gender-col';

        const hdr = document.createElement('span');
        hdr.className = `adj-col-hdr ${g.cls}`;
        hdr.textContent = g.label;
        col.appendChild(hdr);

        const mcDiv = document.createElement('div');
        mcDiv.className = 'mc-options';
        mcDiv.id = `adj-mc-${c.key}-${g.key}`;
        options.forEach(opt => {
          const btn = document.createElement('button');
          btn.className = 'mc-btn';
          btn.textContent = opt;
          btn.addEventListener('click', () => adjMCClick(btn, mcDiv, c.key, g.key, correct));
          mcDiv.appendChild(btn);
        });
        col.appendChild(mcDiv);

        const exDiv = document.createElement('div');
        exDiv.className = 'adj-example';
        const exSrAdj = ex.sr.replace(correct, '...');
        exDiv.innerHTML = `<span class="ex-sr-adj">${exSrAdj}</span><br><span class="ex-en-adj">${ex.en}</span>`;
        col.appendChild(exDiv);

        rowMain.appendChild(col);
      });

      row.appendChild(rowMain);
      container.appendChild(row);
    });
  }

  function adjMCClick(clickedBtn, mcDiv, caseKey, genderKey, correct) {
    mcDiv.querySelectorAll('.mc-btn').forEach(b => b.disabled = true);
    const ok = normalizeSerbian(clickedBtn.textContent) === normalizeSerbian(correct);
    if (ok) {
      clickedBtn.classList.add('mc-correct');
    } else {
      clickedBtn.classList.add('mc-wrong');
      mcDiv.querySelectorAll('.mc-btn').forEach(b => {
        if (normalizeSerbian(b.textContent) === normalizeSerbian(correct)) b.classList.add('mc-reveal');
      });
    }
    const key = `${caseKey}-${genderKey}`;
    if (!adjCasesAnswered.has(key)) {
      adjCasesAnswered.add(key);
      adjScore.correct += ok ? 1 : 0;
      adjScore.total   += 1;
      updateAdjScore();
    }
  }

  function checkAdj() {
    if (!allAdjectives.length) return;
    const adj = allAdjectives[adjIndex];
    const genders = ['masculine', 'feminine', 'neuter'];
    CASES.forEach(c => {
      if (!adjActiveCases.has(c.key)) return;
      genders.forEach(g => {
        const key = `${c.key}-${g}`;
        if (adjCasesAnswered.has(key)) return;
        const mcDiv = document.getElementById(`adj-mc-${c.key}-${g}`);
        if (!mcDiv) return;
        const correct = ((adj.forms || {})[g] || {})[c.key] || '';
        mcDiv.querySelectorAll('.mc-btn').forEach(b => {
          b.disabled = true;
          if (normalizeSerbian(b.textContent) === normalizeSerbian(correct)) b.classList.add('mc-reveal');
        });
        adjCasesAnswered.add(key);
      });
    });
  }

  function updateAdjScore() {
    document.getElementById('adj-score-val').textContent = `${adjScore.correct} / ${adjScore.total}`;
  }

  function adjNext() { if (adjIndex < allAdjectives.length - 1) { adjIndex++; renderAdjCard(); } }
  function adjPrev() { if (adjIndex > 0) { adjIndex--; renderAdjCard(); } }

  function shuffleAdj() {
    buildAllAdjectives();
    for (let i = allAdjectives.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [allAdjectives[i], allAdjectives[j]] = [allAdjectives[j], allAdjectives[i]];
    }
    adjIndex = 0;
    renderAdjCard();
  }

  // ─── Manage: user adjective CRUD ────────────────────────────────────────
  function addUserAdj() {
    const base    = document.getElementById('an-base').value.trim();
    const english = document.getElementById('an-english').value.trim();
    if (!base || !english) { alert('Please fill in the base form and English meaning.'); return; }

    const genders = ['m','f','n'];
    const genderMap = { m: 'masculine', f: 'feminine', n: 'neuter' };
    const caseKeys  = CASES.map(c => c.key);
    const forms = { masculine: {}, feminine: {}, neuter: {} };
    const missing = [];

    genders.forEach(g => {
      caseKeys.forEach(k => {
        const val = document.getElementById(`an-${g}-${k}`).value.trim();
        if (!val) missing.push(`${genderMap[g]}/${k}`);
        forms[genderMap[g]][k] = val;
      });
    });

    if (missing.length) { alert(`Please fill in: ${missing.slice(0, 5).join(', ')}${missing.length > 5 ? '…' : ''}`); return; }

    userAdjectives.push({ base, english, forms });
    saveUserAdjectives(userAdjectives);
    buildAllAdjectives();

    // Clear form
    document.getElementById('an-base').value    = '';
    document.getElementById('an-english').value = '';
    genders.forEach(g => caseKeys.forEach(k => document.getElementById(`an-${g}-${k}`).value = ''));
    document.getElementById('an-base').focus();
    renderAdjList();
  }

  function deleteUserAdj(i) {
    if (!confirm(`Delete "${userAdjectives[i].base}"?`)) return;
    userAdjectives.splice(i, 1);
    saveUserAdjectives(userAdjectives);
    buildAllAdjectives();
    if (adjIndex >= allAdjectives.length) adjIndex = Math.max(0, allAdjectives.length - 1);
    renderAdjList();
  }

  function renderAdjList() {
    const list = document.getElementById('an-list');
    document.getElementById('an-count').textContent = `(${userAdjectives.length})`;
    list.innerHTML = '';
    if (userAdjectives.length === 0) {
      list.innerHTML = '<p style="color:#aaa">No user adjectives yet. Add one above!</p>';
      return;
    }
    userAdjectives.forEach((a, i) => {
      const row = document.createElement('div');
      row.className = 'noun-row';
      row.innerHTML = `
        <div class="noun-row-top">
          <span class="nom">${a.base}</span>
          <span class="eng">${a.english}</span>
          <button class="del-btn" onclick="deleteUserAdj(${i})">Delete</button>
        </div>
        <div class="noun-row-forms" style="grid-template-columns:repeat(3,1fr)">
          ${GENDERS.map(g => `
            <div class="noun-form-cell">
              <span class="noun-form-case">${g.abbr}</span>
              <span class="noun-form-val">${((a.forms || {})[g.key] || {}).nominativ || '—'}</span>
            </div>`).join('')}
        </div>
      `;
      list.appendChild(row);
    });
  }

  // ═══════════════════════════════════════════════════
  //  CONTEXT CHOOSER — functions
  // ═══════════════════════════════════════════════════
  function renderContextView() {
    if (ctxDeck.length === 0) buildCtxDeck();
    ctxAnswered = false;
    renderCtxCard();
  }

  function renderCtxCard() {
    if (ctxIndex >= ctxDeck.length) ctxIndex = 0;
    const drill = ctxDeck[ctxIndex];

    document.getElementById('ctx-progress').textContent =
      `${ctxIndex + 1} of ${ctxDeck.length}`;
    document.getElementById('ctx-prev-btn').disabled = ctxIndex === 0;
    document.getElementById('ctx-next-btn').disabled = ctxIndex === ctxDeck.length - 1;

    // English sentence (plain)
    document.getElementById('ctx-en-sentence').textContent = drill.english;

    // Serbian sentence with styled blank
    document.getElementById('ctx-sr-sentence').innerHTML =
      drill.serbian.replace('___', '<span class="ctx-blank">___</span>');

    // Buttons
    document.getElementById('ctx-imp-verb').textContent = drill.answer === 'imp' ? drill.fill : drill.distractor;
    document.getElementById('ctx-pfv-verb').textContent = drill.answer === 'pfv' ? drill.fill : drill.distractor;
    const impBtn = document.getElementById('ctx-btn-imp');
    const pfvBtn = document.getElementById('ctx-btn-pfv');
    impBtn.disabled = false;
    pfvBtn.disabled = false;
    impBtn.className = 'ctx-choice ctx-choice-imp';
    pfvBtn.className = 'ctx-choice ctx-choice-pfv';

    // Hide feedback
    document.getElementById('ctx-feedback').style.display = 'none';
    document.getElementById('ctx-feedback').className = 'ctx-feedback';

    ctxAnswered = false;
    ctxScoredQ  = false;
    updateCtxScore();
  }

  function ctxAnswer(chosen) {
    if (ctxAnswered) return;
    ctxAnswered = true;
    const drill    = ctxDeck[ctxIndex];
    const correct  = chosen === drill.answer;
    const impBtn   = document.getElementById('ctx-btn-imp');
    const pfvBtn   = document.getElementById('ctx-btn-pfv');

    impBtn.disabled = true;
    pfvBtn.disabled = true;

    // Highlight chosen and show correct
    const chosenBtn  = chosen === 'imp' ? impBtn : pfvBtn;
    const correctBtn = drill.answer === 'imp' ? impBtn : pfvBtn;

    if (correct) {
      chosenBtn.classList.add('ctx-correct');
    } else {
      chosenBtn.classList.add('ctx-wrong');
      correctBtn.classList.add('ctx-show-correct');
    }

    // Fill in the blank in the Serbian sentence
    const srEl = document.getElementById('ctx-sr-sentence');
    srEl.innerHTML = drill.serbian.replace(
      '___',
      `<span class="${correct ? 'ctx-blank-filled-correct' : 'ctx-blank-filled-wrong'}">${drill.fill}</span>`
    );

    // Show feedback
    const fb = document.getElementById('ctx-feedback');
    fb.style.display = 'flex';
    fb.className = `ctx-feedback ${correct ? 'ctx-feedback-correct' : 'ctx-feedback-wrong'}`;
    document.getElementById('ctx-feedback-rule').textContent =
      (correct ? '✓ ' : '✗ ') + drill.rule;
    document.getElementById('ctx-feedback-note').textContent = drill.note;

    // Score (once per card)
    if (!ctxScoredQ) {
      ctxScoredQ = true;
      ctxScore.total++;
      if (correct) ctxScore.correct++;
      updateCtxScore();
    }
  }

  function updateCtxScore() {
    document.getElementById('ctx-score-val').textContent =
      `${ctxScore.correct} / ${ctxScore.total}`;
  }

  function ctxNext() {
    if (ctxIndex < ctxDeck.length - 1) {
      ctxIndex++;
      renderCtxCard();
    }
  }
  function ctxPrev() {
    if (ctxIndex > 0) {
      ctxIndex--;
      renderCtxCard();
    }
  }

  function shuffleCtx() {
    buildCtxDeck();
    renderCtxCard();
  }

  // ═══════════════════════════════════════════════════
  //  MANAGE — shared
  // ═══════════════════════════════════════════════════
  function showManageTab(tab) {
    document.getElementById('manage-cards').style.display   = tab === 'cards'   ? 'flex' : 'none';
    document.getElementById('manage-grammar').style.display = tab === 'grammar' ? 'flex' : 'none';
    document.getElementById('manage-verbs').style.display   = tab === 'verbs'   ? 'flex' : 'none';
    document.getElementById('manage-adj').style.display     = tab === 'adj'     ? 'flex' : 'none';
    document.getElementById('mtab-cards').classList.toggle('active',   tab === 'cards');
    document.getElementById('mtab-grammar').classList.toggle('active', tab === 'grammar');
    document.getElementById('mtab-verbs').classList.toggle('active',   tab === 'verbs');
    document.getElementById('mtab-adj').classList.toggle('active',     tab === 'adj');
  }

  function renderManage() {
    renderGroupManager();
    refreshGroupDropdowns();
    renderCardList();
    renderGrammarNounList();
    renderVerbList();
    renderAdjList();
  }

  // ═══════════════════════════════════════════════════
  //  MANAGE — groups
  // ═══════════════════════════════════════════════════
  function renderGroupManager() {
    document.getElementById('groups-count').textContent = `(${groups.length})`;
    const list = document.getElementById('group-list-manage');
    list.innerHTML = '';

    if (groups.length === 0) {
      list.innerHTML = '<p style="color:#aaa; font-size:0.9rem">No groups yet. Create one above.</p>';
      return;
    }

    groups.forEach((g, i) => {
      const count = cards.filter(c => c.category === g).length;
      const color = getGroupColor(g);
      const row = document.createElement('div');
      row.className = 'group-manage-row';
      row.innerHTML = `
        <span class="group-color-dot" style="background:${color}"></span>
        <span class="group-manage-name">${g}</span>
        <span class="group-manage-count">${count} card${count !== 1 ? 's' : ''}</span>
        <button class="del-btn" onclick="deleteGroup(${i})">Delete</button>
      `;
      list.appendChild(row);
    });
  }

  function addGroup() {
    const name = document.getElementById('inp-group-name').value.trim();
    if (!name) { alert('Please enter a group name.'); return; }
    if (groups.includes(name)) { alert(`"${name}" already exists.`); return; }
    groups.push(name);
    saveGroups(groups);
    activeStudyGroups.add(name);
    document.getElementById('inp-group-name').value = '';
    renderGroupManager();
    refreshGroupDropdowns();
  }

  function deleteGroup(i) {
    const name  = groups[i];
    const count = cards.filter(c => c.category === name).length;
    const msg   = count > 0
      ? `Delete group "${name}"? The ${count} card${count !== 1 ? 's' : ''} in it will become uncategorized.`
      : `Delete group "${name}"?`;
    if (!confirm(msg)) return;

    // Unassign cards
    cards.forEach(c => { if (c.category === name) c.category = ''; });
    saveCards(cards);

    groups.splice(i, 1);
    saveGroups(groups);
    activeStudyGroups.delete(name);

    renderGroupManager();
    refreshGroupDropdowns();
    renderCardList();
  }

  // ═══════════════════════════════════════════════════
  //  MANAGE — flashcards
  // ═══════════════════════════════════════════════════
  function refreshGroupDropdowns() {
    // "Add card" group select
    const addSel = document.getElementById('inp-group');
    const prevAdd = addSel.value;
    addSel.innerHTML = '<option value="">— Uncategorized —</option>' +
      groups.map(g => `<option value="${g}">${g}</option>`).join('');
    if (prevAdd && groups.includes(prevAdd)) addSel.value = prevAdd;

    // Filter group select
    const filterSel = document.getElementById('filter-group');
    const prevFilter = filterSel.value;
    filterSel.innerHTML = '<option value="">All groups</option>' +
      groups.map(g => `<option value="${g}">${g}</option>`).join('');
    const hasUncategorized = cards.some(c => !c.category);
    if (hasUncategorized) filterSel.innerHTML += '<option value="">Uncategorized</option>';
    filterSel.value = prevFilter;
  }

  function renderCardList() {
    const filterVal = document.getElementById('filter-group').value;
    // Re-build filter dropdown safely
    const filterSel = document.getElementById('filter-group');
    const currentFilter = filterSel.value;

    const filtered = filterVal === '' && filterSel.selectedIndex > 0
      ? cards.filter(c => !c.category)               // "Uncategorized" option selected
      : filterVal
        ? cards.filter(c => c.category === filterVal) // specific group
        : cards;                                       // all

    document.getElementById('card-count').textContent = `(${filtered.length} of ${cards.length})`;

    const list = document.getElementById('card-list');
    list.innerHTML = '';

    if (filtered.length === 0) {
      list.innerHTML = '<p style="color:#aaa; font-size:0.9rem">No cards in this group.</p>';
      return;
    }

    filtered.forEach(card => {
      const globalIdx = cards.indexOf(card);
      const color = getGroupColor(card.category);
      const row = document.createElement('div');
      row.className = 'card-row';

      const groupOptions = '<option value="">— Uncategorized —</option>' +
        groups.map(g => `<option value="${g}" ${card.category === g ? 'selected' : ''}>${g}</option>`).join('');

      row.innerHTML = `
        <span class="c-serbian">${card.serbian}</span>
        <span class="c-english">${card.english}</span>
        <select class="inline-group-select" onchange="moveCard(${globalIdx}, this.value)">
          ${groupOptions}
        </select>
        <button class="del-btn" onclick="deleteCard(${globalIdx})">Delete</button>
      `;
      // Color the select border to match group
      const sel = row.querySelector('select');
      sel.style.borderColor = color;
      list.appendChild(row);
    });
  }

  function addCard() {
    const serbian = document.getElementById('inp-serbian').value.trim();
    const english = document.getElementById('inp-english').value.trim();
    const group   = document.getElementById('inp-group').value;
    if (!serbian || !english) { alert('Please fill in both the Serbian word and English translation.'); return; }
    cards.push({ serbian, english, category: group });
    saveCards(cards);
    deck = [];
    document.getElementById('inp-serbian').value = '';
    document.getElementById('inp-english').value = '';
    document.getElementById('inp-serbian').focus();
    renderCardList();
    renderGroupManager();
  }

  function deleteCard(i) {
    if (!confirm(`Delete "${cards[i].serbian}"?`)) return;
    cards.splice(i, 1);
    saveCards(cards);
    deck = [];
    renderCardList();
    renderGroupManager();
  }

  function moveCard(i, newGroup) {
    cards[i].category = newGroup;
    saveCards(cards);
    deck = [];
    renderGroupManager();
    // Re-render list to keep filter consistent (don't call full renderCardList to avoid resetting scroll)
    const filterSel = document.getElementById('filter-group');
    if (filterSel.value && filterSel.value !== newGroup) renderCardList();
    else renderGroupManager();
  }

  // ═══════════════════════════════════════════════════
  //  MANAGE — grammar nouns
  // ═══════════════════════════════════════════════════
  function renderGrammarNounList() {
    const list = document.getElementById('gn-list');
    document.getElementById('gn-count').textContent = `(${grammarNouns.length})`;
    list.innerHTML = '';

    if (grammarNouns.length === 0) {
      list.innerHTML = '<p style="color:#aaa">No grammar nouns yet. Add one above!</p>';
      return;
    }

    grammarNouns.forEach((noun, i) => {
      const gc = { masculine:'gender-m', feminine:'gender-f', neuter:'gender-n' }[noun.gender];
      const row = document.createElement('div');
      row.className = 'noun-row';
      row.innerHTML = `
        <div class="noun-row-top">
          <span class="nom">${noun.forms.nominativ}</span>
          <span class="eng">${noun.english}</span>
          <span class="gender-badge ${gc}">${noun.gender}</span>
          <button class="del-btn" onclick="deleteGrammarNoun(${i})">Delete</button>
        </div>
        <div class="noun-row-forms">
          ${CASES.map(c => `
            <div class="noun-form-cell">
              <span class="noun-form-case">${c.abbr}</span>
              <span class="noun-form-val">${noun.forms[c.key]}</span>
            </div>`).join('')}
        </div>
      `;
      list.appendChild(row);
    });
  }

  function addGrammarNoun() {
    const english = document.getElementById('gn-english').value.trim();
    const gender  = document.getElementById('gn-gender').value;
    const forms   = {};
    const missing = [];
    CASES.forEach(c => {
      const val = document.getElementById(`gn-${c.key}`).value.trim();
      if (!val) missing.push(c.label);
      forms[c.key] = val;
    });
    if (!english)       { alert('Please enter the English meaning.'); return; }
    if (missing.length) { alert(`Please fill in: ${missing.join(', ')}`); return; }
    grammarNouns.push({ english, gender, forms });
    saveGrammarNouns(grammarNouns);
    document.getElementById('gn-english').value = '';
    CASES.forEach(c => document.getElementById(`gn-${c.key}`).value = '');
    document.getElementById('gn-english').focus();
    renderGrammarNounList();
  }

  function deleteGrammarNoun(i) {
    if (!confirm(`Delete "${grammarNouns[i].forms.nominativ}"?`)) return;
    grammarNouns.splice(i, 1);
    saveGrammarNouns(grammarNouns);
    if (gIndex >= grammarNouns.length) gIndex = Math.max(0, grammarNouns.length - 1);
    renderGrammarNounList();
  }

  // ═══════════════════════════════════════════════════
  //  KEYBOARD SHORTCUTS
  // ═══════════════════════════════════════════════════
  ['inp-serbian','inp-english'].forEach(id => {
    document.getElementById(id).addEventListener('keydown', e => {
      if (e.key === 'Enter') addCard();
    });
  });
  document.getElementById('inp-group-name').addEventListener('keydown', e => {
    if (e.key === 'Enter') addGroup();
  });

  document.addEventListener('keydown', e => {
    if (e.key === 'Escape') { closeCaseModal(); return; }
    const studyVisible   = document.getElementById('study-view').style.display   !== 'none';
    const grammarVisible = document.getElementById('grammar-view').style.display !== 'none';
    const verbsVisible   = document.getElementById('verbs-view').style.display   !== 'none';
    const adjVisible     = document.getElementById('adj-view').style.display     !== 'none';
    const drillVisible   = document.getElementById('drill-view').style.display   !== 'none';
    const aspectVisible  = document.getElementById('aspect-view').style.display  !== 'none';
    if (studyVisible) {
      if (e.key === 'ArrowRight') nextCard();
      if (e.key === 'ArrowLeft')  prevCard();
      if (e.key === ' ') { e.preventDefault(); flipCard(); }
    }
    if (grammarVisible && document.activeElement.tagName !== 'INPUT') {
      if (e.key === 'ArrowRight') gNext();
      if (e.key === 'ArrowLeft')  gPrev();
    }
    if (verbsVisible && document.activeElement.tagName !== 'INPUT') {
      if (e.key === 'ArrowRight') vNext();
      if (e.key === 'ArrowLeft')  vPrev();
    }
    if (adjVisible && document.activeElement.tagName !== 'INPUT') {
      if (e.key === 'ArrowRight') adjNext();
      if (e.key === 'ArrowLeft')  adjPrev();
    }
    if (drillVisible) {
      if (e.key === 'ArrowRight') drillNext();
      if (e.key === 'ArrowLeft')  drillPrev();
    }
    if (aspectVisible) {
      if (e.key === 'ArrowRight') ctxNext();
      if (e.key === 'ArrowLeft')  ctxPrev();
    }
  });

  // ═══════════════════════════════════════════════════
  //  INIT
  // ═══════════════════════════════════════════════════
  buildAllVerbs();
  buildAllAdjectives();
  buildDeck();
  renderStudy();
</script>

<!-- ═══════════════ PREFIX INFO MODAL ══════════════ -->
<div id="prefix-modal-overlay" onclick="closePrefixModal()">
  <div id="prefix-modal" onclick="event.stopPropagation()">
    <div class="modal-header">
      <div class="modal-header-left">
        <span class="modal-case-abbr" id="pm-abbr">po-</span>
        <span class="modal-case-name" id="pm-title"></span>
      </div>
      <button class="modal-close" onclick="closePrefixModal()">×</button>
    </div>
    <div class="modal-body">
      <div class="modal-section">
        <p class="modal-section-label">How it works</p>
        <p id="pm-desc"></p>
      </div>
      <div class="modal-section">
        <p class="modal-section-label">Examples from this section</p>
        <div id="pm-examples"></div>
      </div>
    </div>
  </div>
</div>

<!-- ═══════════════ CASE INFO MODAL ═══════════════ -->
<div id="case-modal-overlay" onclick="closeCaseModal()">
  <div id="case-modal" onclick="event.stopPropagation()">
    <div class="modal-header">
      <div class="modal-header-left">
        <span class="modal-case-abbr" id="mc-abbr">N</span>
        <span class="modal-case-name" id="mc-name">Nominativ</span>
        <span class="modal-case-hint" id="mc-hint">ko? šta?</span>
      </div>
      <button class="modal-close" onclick="closeCaseModal()">×</button>
    </div>
    <div class="modal-body">
      <div class="modal-section">
        <p class="modal-section-label">Usage</p>
        <p id="mc-desc"></p>
      </div>
      <div class="modal-section" id="mc-prep-section">
        <p class="modal-section-label">Prepositions</p>
        <div class="prep-grid" id="mc-preps"></div>
        <p class="prep-note" id="mc-prep-note"></p>
      </div>
      <div class="modal-section" id="mc-ex-section">
        <p class="modal-section-label">With this word</p>
        <div class="modal-example-box">
          <span class="modal-ex-sr" id="mc-ex-sr"></span>
          <span class="modal-ex-en" id="mc-ex-en"></span>
        </div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
